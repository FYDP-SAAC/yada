{"version":3,"sources":["images/logo.png","images/graphic.png","images/darkLogo.png","util/FetchWithTimeout.js","reducers/BackendModeSignedInStatus.js","components/LandingPage.js","util/FileIdAndTypeUtils.js","util/ConvertStrValueOrDefault.js","reducers/CurrentOpenFileState.js","reducers/SetTagsInView.js","reducers/Toast.js","store.js","editor_extension/plugins/SelectNode.js","editor_extension/plugins/TagFiltering.js","editor_extension/plugins/CancelLineBreaks.js","editor_extension/BlockTagging.js","components/TagMenu.js","components/Editor.js","backend/LocalFileStorageSystemClient.js","backend/HostedFileStorageSystemClient.js","backend/FileStorageSystemClient.js","components/SourceEditorWithTagFiltersInput.js","components/Navigator.js","lib/TagFiltersGrammar.js","components/Navbar.js","components/CardView/Card.js","components/CardView/StudyView.js","components/ViewComponents/DragDropColumn.js","components/ViewComponents/TagEditor.js","components/CardView/CardDeck.js","components/TextView/TextView.js","components/ViewEditor.js","components/EditorManager.js","components/MobilePage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","fetchWithTimeout","uri","options","a","time","controller","AbortController","setTimeout","abort","fetch","signal","then","response","ok","console","log","SERVER_BASE_URL","BACKEND_MODE_SIGNED_IN_STATUS","USER_SIGNED_IN","USER_SIGNED_OUT","LOCAL_STORAGE","getUserSignedInStatus","token","Cookies","get","headers","Headers","setBackendModeSignedInStatusAction","status","type","CLIENT_ID","LandingPage","handleLoginSuccess","profileObj","name","email","tokenObj","id_token","expiry","expiresAt","axios","post","method","body","JSON","stringify","withCredentials","set","expires","Date","props","dispatchSetBackendModeSignedInStatusAction","render","style","display","flexFlow","height","overflow","className","flexGrow","AppBar","position","class","Toolbar","src","require","width","marginRight","alt","backgroundColor","flex","Grid","container","alignItems","Hidden","smDown","item","md","sm","spacing","xs","marginLeft","Typography","variant","fontFamily","color","text","speed","align","clientId","buttonText","onSuccess","onFailure","cookiePolicy","responseType","float","mdUp","React","Component","connect","state","backendModeSignedInStatus","dispatch","mode","FILE_TYPE","SOURCE","TEXT_VIEW","CARD_VIEW","EMPTY","NO_OPEN_FILE_ID","sourceId","viewId","viewType","validateFileIdObj","fileId","hasOwnProperty","validateHasFileIdObj","validateHasFileNameObj","fileName","checkNoOpenFileId","checkSourceFileId","checkViewFileId","getFileIdKeyStr","convertStrValueOrDefault","valueStr","defaultValue","failureMessage","convertFromString","parse","value","e","convertStrValueOrDefaultIfFalsy","storedInitialFileId","localStorage","getItem","storedInitialFileName","initialFileId","initialFileName","sourceName","viewName","setCurrentOpenFileIdAction","setCurrentOpenFileNameAction","setSelectNodeAction","selectNode","setTagsInViewAction","tagsInView","setToastAction","toast","TOAST_SEVERITY","DEFAULT_STATE","message","severity","open","configureStore","reducer","combineReducers","currentOpenFileId","action","currentOpenFileName","saveDirtyFlag","setItem","removeItem","SelectNodePluginKey","PluginKey","Plugin","key","init","apply","tr","_value","oldState","head","selection","newState","doc","nodesBetween","node","pos","attrs","eq","store","decorations","selectDecorations","getState","push","Decoration","nodeSize","DecorationSet","create","TagFilteringPluginKey","evaluateTagFilters","tagFilters","parentTags","match","taggable","nodeTags","matchTagFilters","tags","Array","isArray","length","match1","isTextblock","cumulativeChildSize","i","childCount","child","childMatch","v","val","getMeta","undefined","filterDecorations","CancelLineBreaksPluginKey","filterTransaction","steps","every","step","toJSON","stepType","slice","content","some","isLeaf","checkInsertLineBreakReplaceStep","from","to","fromNode","nodeAt","toNode","checkRemoveLineBreakReplaceStep","CancelLineBreaksPlugin","SelectNodePlugin","TagFilteringPlugin","Extension","TAG_VALUE_REGEX","INVALID_TAG_VALUE_REGEX","TagListItem","Chip","label","tagValue","onDelete","event","handleEditMenuClick","deleteIcon","justifyContent","TagMenu","selectNodeAttrs","modifying","editMenuAnchorElement","renamePopoverElement","currentTag","handleAddTag","tag","document","getElementById","trim","test","dispatchSetToastAction","newSelectNodeAttrs","uuidv4","BlockTaggingEditorExtension","editor","view","setNodeMarkup","setState","dispatchSetSaveDirtyFlagAction","handleDeleteTag","handleEditMenuClose","handleModifyTagValue","newTagValue","componentDidUpdate","prevProps","defer","currentTarget","handleRenameMenuClick","handleRenamePopoverClose","id","OutlinedInput","title","placeholder","disabled","onKeyPress","target","preventDefault","onKeyDown","focus","endAdornment","InputAdornment","IconButton","aria-label","onClick","edge","margin","Object","keys","List","component","aria-labelledby","subheader","ListSubheader","map","ListItem","dense","Menu","anchorEl","keepMounted","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","MenuItem","ListItemIcon","fontSize","ListItemText","primary","Popover","Input","autoFocus","onBlur","blur","disableUnderline","fullWidth","Editor","noOpenFileIdCheck","hidden","extensions","fileIdKeyStr","fileContent","jsonStrValue","setSelection","TextSelection","onChange","doSetLocalStorageSourceViews","sourceViews","doGetLocalStorageSourceViews","doSetLocalStorageSourceIdNames","sourceIdNames","calculateLocalStorageNextNewId","existingIdsDict","candidate","toString","calculateLocalStorageNextNewFileIds","filesList","source","nextNewViewIdsForSourceIds","fromEntries","entries","views","doGetFilesList","doSaveViewSpec","tagsList","createNew","viewSpecLocalStorageKey","doGetView","doGetSourceTaggedBlocks","sourceContentDocStr","sourceContentDoc","sourceTaggedBlocks","nodes","shift","tagId","doSaveSourceContent","saveValue","sourceContentLocalStorageKey","doGetSourceContent","doSetSourceSavedTagFilters","sourceSavedTagFilters","sourceSavedTagFiltersLocalStorageKey","doGetSourceSavedTagFilters","doDeleteView","doDeleteSource","localStorageSourceViewIds","doRenameView","doRenameSource","EMPTY_SOURCE_CONTENT","json","viewID","Error","viewResponse","tagResponse","view_json","tags_json","filters","getFileStorageSystemClient","LocalFileStorageSystemClient","HostedFileStorageSystemClient","clientInterface","reduce","partial","fileStorageSystemClient","SourceEditorWithTagFiltersInput","keydownHandler","window","navigator","platform","metaKey","ctrlKey","keyCode","FileStorageSystemClient","success","changeFile","focusAtStart","handleSetCurrentOpenFileId","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","confirm","batch","convertFilesListStateToFileIdNamesList","filesListState","countNumFiles","count","RENAME_INPUT_TYPES","getRenameInputIdFunctions","NO_RENAMING_STATE","inputType","searching","renaming","nextNewFileIds","selectedFileId","selectedViewId","selectedFileOpen","renameSelected","newViewAnchorElement","FileListItem","selected","padding","InputBase","Divider","orientation","border","childViewsExist","Navigator","resetState","getSourceName","getViewName","getFileName","getRenameInputValueFunctions","handleSwitchBackendModeSignedInStatus","handleCancelRenaming","input","setSelectionRange","handleClearSearchingInput","handleChangeSearchingInput","handleDoFileNamesSearch","filter","includes","handleCreateNewFile","fileType","sourceFileType","localStorageNextNewFileId","newFilePromise","newFile","updatedSourceId","newFilesList","parseInt","handleDeleteFile","sourceFileIdCheck","deleteFilePromise","newSourceViews","newNextNewViewIdsForSourceIds","handleRenameFile","newName","renameFilePromise","prevState","filesListValue","handleFileListClick","handleViewListClick","handleDeleteMenuClick","handleViewMenuOpen","handleViewMenuClose","numFiles","filteredFilesList","numFilteredFiles","Button","endIcon","disableElevation","startAdornment","debounce","button","disableGutters","divider","Collapse","in","timeout","unmountOnExit","disablePadding","remove","x","Grammar","Lexer","ParserRules","symbols","postprocess","literal","d","join","concat","ParserStart","inputText","outputParsedExpr","parser","nearley","Parser","fromCompiled","feed","results","ex","modifyingTagFilters","currentTagFiltersStr","currentParsedTagFiltersStr","Navbar","handleSave","catch","handleCancelModifyingTagFilters","handleStartModifyingTagFilters","handleUnpersistCurrentTagFilters","newSourceSavedTagFilters","handlePersistNewSavedTagFilters","handleApplyTagFilters","tagFiltersStr","parseTagFilters","parsedTagFiltersStr","oldParsedTagFiltersStr","setMeta","Selection","atStart","scrollIntoView","dom","forEach","element","currentTagFiltersSaved","Breadcrumbs","borderRadius","Link","substring","startIcon","paddingTop","paddingBottom","marginTop","Autocomplete","freeSolo","renderInput","params","TextField","reason","paddingRight","aria-haspopup","Card","front","back","isFlipped","flipDirection","createBootstrapCard","handleClick","bind","this","readOnly","StudyView","currentNumber","startIndex","cards","shuffleCards","shuffledCards","j","Math","floor","random","temp","navButtonsAlwaysVisible","indicators","animation","autoPlay","interval","index","next","prev","card","flexDirection","flexWrap","clickable","Tag","Container","styled","div","isDragging","THEME","palette","secondary","dark","light","TagId","h5","Content","draggableId","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","tagInfo","preview","InnerTagList","nextProps","nextState","nextContext","tagData","tagList","tagIds","columnId","TAG_HOLDERS","IN_VIEW","main","DragDropColumn","isDraggingOver","grey","Title","h3","DroppableRegion","TagList","droppableId","column","droppableProps","tagListRef","createRef","list","current","scrollHeight","scrollTop","AVAILABLE","TagEditor","onDragEnd","result","destination","columns","newTagIds","splice","newColumn","start","finish","startTagIds","newStart","finishTagIds","newFinish","setTagsInView","tags_in_view","Row","columnOrder","tagDataInColumn","Col","lg","Set","availableTags","allTagsData","t","has","getPreview","contentNode","recurseResponse","tags_available","assign","CardDeck","constructDoc","constructCard","cardContent","studySwitch","xl","FormControlLabel","control","Switch","checked","data","TextView","constructTextView","ViewEditor","EditorManager","MobilePage","createMuiTheme","App","mounted","innerWidth","handleCloseToast","handleWindowSizeChange","theme","Fragment","Snackbar","autoHideDuration","elevation","location","hostname","StrictMode","rel","href","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.75d0c523.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e9d28ab1.png\";","module.exports = __webpack_public_path__ + \"static/media/graphic.af8be1b2.png\";","module.exports = __webpack_public_path__ + \"static/media/darkLogo.eccc7628.png\";","export const fetchWithTimeout = async (uri, options, time = 7500) => {\n  const controller = new AbortController();\n  setTimeout(() => { controller.abort(); }, time);\n  return await fetch(uri, { ...options, signal: controller.signal }).then((response) => {\n    if (!response.ok) { console.log(response); }\n    return response\n  });\n};\n","import Cookies from 'js-cookie';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\n\nexport const SERVER_BASE_URL = process.env.NODE_ENV === 'development'\n  ? \"http://localhost:5000/\" : \"https://yaas-gca4j5hw3q-uc.a.run.app/\";\n\nexport const BACKEND_MODE_SIGNED_IN_STATUS = {\n  USER_SIGNED_IN: 'USER_SIGNED_IN',\n  USER_SIGNED_OUT: 'USER_SIGNED_OUT',\n  LOCAL_STORAGE: 'LOCAL_STORAGE',\n}\n\nexport const ACCESS_TOKEN_COOKIE_KEY = 'access_token';\n\nexport const getUserSignedInStatus = async () => {\n  const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n  if (token) {\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `auth`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (ok) { return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN; }\n    } catch (e) { console.log(e); }\n  }\n  return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT;\n};\n\nexport const INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY = 'initialLocalStorageBackendMode';\n\nconst SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE = 'backendModeSignedInStatus/set';\nexport const setBackendModeSignedInStatusAction =\n  status => ({ type: SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE, status });\nexport const backendModeSignedInStatusReducer = (\n  state = localStorage.getItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY)\n    ? BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE : BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT,\n  action,\n) => {\n  if (\n    action.type !== SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE || !action.hasOwnProperty('status') ||\n    !BACKEND_MODE_SIGNED_IN_STATUS.hasOwnProperty(action.status)\n  ) { return state; }\n  if (action.status === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n    localStorage.setItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY, true);\n  } else { localStorage.removeItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY); }\n  return action.status;\n};\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {GoogleLogin} from 'react-google-login';\nimport axios from 'axios';\nimport Cookies from 'js-cookie'\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  SERVER_BASE_URL,\n  ACCESS_TOKEN_COOKIE_KEY,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport ReactTypingEffect from 'react-typing-effect';\nimport {Hidden} from \"@material-ui/core\";\n\nconst CLIENT_ID = '709358329925-gic89ini15sgaenfrta1gshej1ik72jg.apps.googleusercontent.com';\n\nclass LandingPage extends React.Component {\n\n  handleLoginSuccess = async ({ profileObj: { name, email }, tokenObj: { id_token: token, expiresAt: expiry } }) => {\n    let response = null;\n    try {\n      response = await axios.post(\n        SERVER_BASE_URL + 'register_user',\n        {\n          method: 'POST',\n          body: JSON.stringify({ name, email, token }),\n          headers: { 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` },\n        },\n        { withCredentials: true },\n      );\n    } catch(e) { console.log(e); }\n    if (response && response.status === 201) {\n      Cookies.set(ACCESS_TOKEN_COOKIE_KEY, token, { expires: new Date(expiry) });\n      this.props.dispatchSetBackendModeSignedInStatusAction(BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN);\n    }\n  };\n\n  render = () =>\n    <div style={{display:\"flex\", flexFlow: \"column\", height: \"100vh\", overflow: \"hidden\"}}>\n      <div className={\"landing-root\"} style={{flexGrow: \"0 1 auto\"}}>\n      <AppBar position=\"static\" class=\"custom-navbar\">\n        <Toolbar>\n          <img className={\"menuButton\"} src={require('../images/logo.png')} style={{width: \"50px\", marginRight: \"1%\"}} alt={\"MENU\"}/>\n        </Toolbar>\n      </AppBar>\n\n    </div>\n    <div style={{backgroundColor: \"#F5F0E1\", flex: \"1 1 auto\", display:\"flex\"}}>\n    <Grid container alignItems=\"center\">\n        <Hidden smDown><Grid item md={1}/></Hidden>\n        <Grid item sm={12} md={5} alignItems=\"center\">\n          <Grid container spacing={3} alignItems=\"center\">\n            <Grid item xs={3}>\n              <img src={require('../images/darkLogo.png')} style={{width: \"90%\", marginLeft: \"20%\"}} alt={\"YADA\"}/>\n            </Grid>\n            <Grid item xs={9}>\n              <Typography variant=\"h1\" className={\"title\"} style={{fontFamily:\"Bungee\", color:\"#1E3D59\"}}>\n              YADA\n              <ReactTypingEffect\n                text = \"\"\n                style={{fontFamily:\"Signika\"}}\n                speed = {10000}\n              />\n              </Typography>\n              <Typography variant=\"h3\" className={\"title\"} style={{fontFamily:\"Signika\", color:\"#1E3D59\"}}>\n               Yet Another Docs App\n              </Typography>\n             </Grid>\n          </Grid>\n          <br />\n          <div align=\"center\">\n              <GoogleLogin\n                  clientId={CLIENT_ID}\n                  buttonText=\"Sign in with Google\"\n                  onSuccess={response => { this.handleLoginSuccess(response); }}\n                  onFailure={response => { console.log(response); }}\n                  cookiePolicy=\"single_host_origin\"\n                  responseType=\"code,token\"\n                  style={{float: \"left\"}}\n                />\n          </div>\n        </Grid>\n        <Hidden mdUp><Grid item sm={3}/></Hidden>\n        <Hidden smDown><Grid item md={1}/></Hidden>\n        <Grid item sm={6} md={4}>\n           <img src={require('../images/graphic.png')} style={{width: \"100%\"}} alt={\"Document Graphic\"}/>\n        </Grid>\n        <Hidden smDown><Grid item md={1}/></Hidden>\n        <Hidden mdUp><Grid item sm={3}/></Hidden>\n    </Grid>\n    </div>\n  </div>\n}\n\nexport default connect(\n  state => ({ backendModeSignedInStatus: state.backendModeSignedInStatus }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n  }),\n)(LandingPage);\n","export const FILE_TYPE = {\n  SOURCE: 'SOURCE',\n  TEXT_VIEW: 'TEXT_VIEW',\n  CARD_VIEW: 'CARD_VIEW',\n  EMPTY: 'NON_EXISTENT',\n};\n\nexport const NO_OPEN_FILE_ID = { sourceId: 0, viewId: 0, viewType: FILE_TYPE.EMPTY };\n\nexport const validateFileIdObj = fileId => fileId.hasOwnProperty('sourceId') && fileId.hasOwnProperty('viewId');\nexport const validateHasFileIdObj = state => state.hasOwnProperty('fileId') && validateFileIdObj(state.fileId);\nexport const validateFileNameObj = fileName => fileName.hasOwnProperty('sourceName') && fileName.hasOwnProperty('viewName');\nexport const validateHasFileNameObj = state => state.hasOwnProperty('fileName') && validateFileNameObj(state.fileName);\n\nexport const checkNoOpenFileId = fileId => validateFileIdObj(fileId) && !fileId.sourceId && !fileId.viewId;\nexport const checkSourceFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && !fileId.viewId;\nexport const checkViewFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && fileId.viewId;\n\nexport const getFileIdKeyStr = fileId => validateFileIdObj(fileId)\n  ? (fileId.sourceId + (fileId.viewId ? '#' + fileId.viewId : '')) : '';\n","export const convertStrValueOrDefault =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    let value = defaultValue;\n    if (valueStr) {\n      try { value = convertFromString(valueStr); }\n      catch (e) {\n        if (failureMessage) { console.log(failureMessage); }\n        console.log(e);\n      }\n    }\n    return value;\n  };\n\nexport const convertStrValueOrDefaultIfFalsy =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    if (!valueStr) { return defaultValue; }\n    let value = null;\n    try { value = convertFromString(valueStr); }\n    catch (e) {\n      if (failureMessage) { console.log(failureMessage); }\n      console.log(e);\n    }\n    return value;\n  };\n","import {convertStrValueOrDefault} from '../util/ConvertStrValueOrDefault';\nimport {NO_OPEN_FILE_ID, validateHasFileIdObj, validateHasFileNameObj} from '../util/FileIdAndTypeUtils';\n\nexport const INITIAL_FILE_ID_LOCAL_STORAGE_KEY = 'initialFileId';\nexport const INITIAL_FILE_NAME_LOCAL_STORAGE_KEY = 'initialFileName';\n\nconst storedInitialFileId = convertStrValueOrDefault(\n  localStorage.getItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY),\n  {},\n  'invalid initialFileId',\n);\n\nconst storedInitialFileName = convertStrValueOrDefault(\n  localStorage.getItem(INITIAL_FILE_NAME_LOCAL_STORAGE_KEY),\n  {},\n  'invalid initialFileName',\n);\n\nconst initialFileId = {\n  sourceId: storedInitialFileId.hasOwnProperty('sourceId')\n    ? storedInitialFileId.sourceId : NO_OPEN_FILE_ID.sourceId,\n  viewId: storedInitialFileId.hasOwnProperty('viewId') ? storedInitialFileId.viewId : NO_OPEN_FILE_ID.viewId,\n  viewType: storedInitialFileId.hasOwnProperty('viewType') ? storedInitialFileId.viewType : NO_OPEN_FILE_ID.viewType,\n}\n\nconst initialFileName = {\n  sourceName: storedInitialFileName.hasOwnProperty('sourceName')\n    ? storedInitialFileName.sourceName : '',\n  viewName: storedInitialFileName.hasOwnProperty('viewName') ? storedInitialFileName.viewName : '',\n}\n\nconst SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE = 'currentOpenFileId/set';\nexport const setCurrentOpenFileIdAction = fileId => ({ type: SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE, fileId });\nexport const currentOpenFileIdReducer = (state = initialFileId, action) =>\n  action.type !== SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE || !validateHasFileIdObj(action)\n    ? state : action.fileId;\n\nconst SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE = 'currentOpenFileName/set';\nexport const setCurrentOpenFileNameAction = fileName => ({ type: SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE, fileName });\nexport const currentOpenFileNameReducer = (state = initialFileName, action) =>\n  action.type !== SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE || !validateHasFileNameObj(action)\n    ? state : action.fileName;\n\nexport const SET_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/set';\nexport const CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/clear';\nexport const saveDirtyFlagReducer = (state = false, action) =>\n  action.type !== SET_SAVE_DIRTY_FLAG_ACTION_TYPE && action.type !== CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE\n    ? state : action.type === SET_SAVE_DIRTY_FLAG_ACTION_TYPE;\n\nconst SET_SELECT_NODE_ACTION_TYPE = 'selectNode/set';\nexport const setSelectNodeAction = selectNode => ({ type: SET_SELECT_NODE_ACTION_TYPE, selectNode });\nexport const selectNodeReducer = (state = null, action) =>\n  action.type === SET_SELECT_NODE_ACTION_TYPE && action.hasOwnProperty('selectNode') &&\n  (!action.selectNode || action.selectNode.hasOwnProperty('pos'))\n    ? action.selectNode : (action.type === SET_SELECT_NODE_ACTION_TYPE ? null : state);\n","export const SET_TAGS_IN_VIEW_ACTION_TYPE = 'tagsInView/set';\nexport const setTagsInViewAction = tagsInView => ({ type: SET_TAGS_IN_VIEW_ACTION_TYPE, tagsInView });\nexport const setTagsInViewReducer = (state = null, action) =>\n\taction.type !== SET_TAGS_IN_VIEW_ACTION_TYPE || !action.hasOwnProperty('tagsInView')\n\t\t? state : action.tagsInView;\n","export const SET_TOAST_ACTION_TYPE = 'toast/set';\nexport const setToastAction = toast => ({ type: SET_TOAST_ACTION_TYPE, toast });\n\nexport const TOAST_DURATION_MS = 5000;\nexport const TOAST_CLEAR = 'clear';\nexport const TOAST_SEVERITY = {\n\tERROR: 'error',\n\tWARNING: 'warning',\n\tINFO: 'info',\n\tSUCCESS: 'success',\n}\nconst DEFAULT_STATE = {\n\tmessage: \"\",\n\tseverity: TOAST_SEVERITY.INFO,\n\topen: false\n}\n\nexport const setToastReducer = (state = DEFAULT_STATE, action) =>\n\taction.type !== SET_TOAST_ACTION_TYPE || !action.hasOwnProperty('toast')\n\t\t? state : (action === TOAST_CLEAR ? DEFAULT_STATE : action.toast);\n","import {configureStore} from '@reduxjs/toolkit';\nimport {combineReducers} from 'redux';\nimport {currentOpenFileIdReducer, saveDirtyFlagReducer, selectNodeReducer, currentOpenFileNameReducer} from './reducers/CurrentOpenFileState';\nimport {backendModeSignedInStatusReducer} from './reducers/BackendModeSignedInStatus';\nimport {setTagsInViewReducer} from \"./reducers/SetTagsInView\";\nimport {setToastReducer} from \"./reducers/Toast\";\n\nexport default configureStore({\n  reducer: combineReducers({\n    currentOpenFileId: currentOpenFileIdReducer,\n    currentOpenFileName: currentOpenFileNameReducer,\n    saveDirtyFlag: saveDirtyFlagReducer,\n    selectNode: selectNodeReducer,\n    backendModeSignedInStatus: backendModeSignedInStatusReducer,\n    tagsInView: setTagsInViewReducer,\n    toast: setToastReducer,\n  }),\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {setSelectNodeAction} from '../../reducers/CurrentOpenFileState';\nimport store from '../../store';\n\nconst SELECT_NODE_PLUGIN_NAME = 'select-node';\nexport const SelectNodePluginKey = new PluginKey(SELECT_NODE_PLUGIN_NAME);\n\nexport default new Plugin({\n  key: SelectNodePluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, _value, oldState) => {\n      let head = tr.selection.head;\n      let newState = null;\n      tr.doc.nodesBetween(head, head, (node, pos) => {\n        if (node.hasOwnProperty('attrs') && node.attrs['tags']) { newState = { node, pos }; }\n      });\n      if (\n        (!oldState && newState) || (oldState && !newState) ||\n        (oldState && newState && (newState.pos !== oldState.pos || !newState.node.eq(oldState.node)))\n      ) { store.dispatch(setSelectNodeAction(newState ? { pos: newState.pos } : null)); }\n      return newState;\n    },\n  },\n  props: {\n    decorations: state => {\n      const selectDecorations = [];\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (selectNode) {\n        selectDecorations.push(Decoration.node(\n          selectNode.pos,\n          selectNode.pos + selectNode.node.nodeSize,\n          { style: 'background: #FAFAFA; outline: 1px solid #DCDCDC;' },\n        ));\n      }\n      return DecorationSet.create(state.doc, selectDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {SelectNodePluginKey} from './SelectNode';\n\nconst TAG_FILTERING_PLUGIN_NAME = 'tag-filtering';\nexport const TagFilteringPluginKey = new PluginKey(TAG_FILTERING_PLUGIN_NAME);\n\nconst matchTagFilters = (tags, tagFilters) => {\n  if (!tagFilters) { return true; }\n  if (!Array.isArray(tagFilters)) { return tags.hasOwnProperty(tagFilters); }\n  // invariant: tagFilters isArray\n  // only not expressions have array length 2\n  if (tagFilters.length === 2) { return !matchTagFilters(tags, tagFilters[1]); }\n  const match1 = matchTagFilters(tags, tagFilters[0]);\n  if (tagFilters.length === 1) { return match1; }\n  // invariant: length 3, [1] is op, [2] is tag or sub expression\n  const andOp = tagFilters[1] === '&';\n  // short circuit evaluation\n  if (andOp !== match1) { return match1; }\n  // invariant:\n  // if andOp then !match1, so result should be match2,\n  // if !andOp then match1, so result should be match2\n  return matchTagFilters(tags, tagFilters[2]);\n};\n\nconst evaluateTagFilters = (decorations, tagFilters, selectNode, node, parentTags, pos) => {\n  let match = false;\n  const taggable = node.hasOwnProperty('attrs') && node.attrs['tags'];\n  const nodeTags = { ...parentTags, ...(taggable ? node.attrs['tags'] : null) };\n  if (taggable) { match = matchTagFilters(nodeTags, tagFilters); }\n  if (!node.isTextblock) {\n    let cumulativeChildSize = 1;\n    for (let i = 0; i < node.childCount; ++i) {\n      const child = node.child(i);\n      const childPos = pos + cumulativeChildSize;\n      const childMatch = evaluateTagFilters(decorations, tagFilters, selectNode, child, nodeTags, childPos);\n      match = match || childMatch;\n      cumulativeChildSize += child.nodeSize;\n    }\n  }\n  if (pos !== 0 && !match) {\n    decorations.push(Decoration.node(pos - 1, pos - 1 + node.nodeSize, { style: 'display: none;' }));\n  }\n  return match;\n};\n\nexport default new Plugin({\n  key: TagFilteringPluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, v) => {\n      const val = tr.getMeta(TagFilteringPluginKey);\n      return val === undefined ? v : val;\n    },\n  },\n  props: {\n    decorations: state => {\n      const filterDecorations = [];\n      const tagFilters = TagFilteringPluginKey.getState(state);\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (tagFilters) { evaluateTagFilters(filterDecorations, tagFilters, selectNode, state.doc, {}, 0); }\n      return DecorationSet.create(state.doc, filterDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {checkSourceFileId} from '../../util/FileIdAndTypeUtils';\nimport {TagFilteringPluginKey} from './TagFiltering';\nimport store from '../../store';\n\nconst CANCEL_LINE_BREAKS_PLUGIN_NAME = 'cancel-line-breaks';\nexport const CancelLineBreaksPluginKey = new PluginKey(CANCEL_LINE_BREAKS_PLUGIN_NAME);\n\nconst checkInsertLineBreakReplaceStep = step => step.slice.content.content.some(node => !node.isLeaf);\n\nconst checkRemoveLineBreakReplaceStep = (step, doc) => {\n  if (step.from === step.to) { return false; }\n  const fromNode = doc.nodeAt(step.from);\n  const toNode = doc.nodeAt(step.to);\n  if (toNode) { return !fromNode || (fromNode && !fromNode.eq(toNode)); }\n  return !fromNode || !doc.nodeAt(step.to - 1).eq(fromNode);\n};\n\nexport default new Plugin({\n  key: CancelLineBreaksPluginKey,\n  filterTransaction: (tr, state) =>\n    (checkSourceFileId(store.getState().currentOpenFileId) && !TagFilteringPluginKey.getState(state)) ||\n    tr.steps.every(\n      step => step.toJSON().stepType !== 'replace' ||\n        (!checkInsertLineBreakReplaceStep(step) && !checkRemoveLineBreakReplaceStep(step, state.doc))\n    ),\n});\n","import {Extension} from 'rich-markdown-editor';\nimport CancelLineBreaksPlugin from './plugins/CancelLineBreaks';\nimport SelectNodePlugin from './plugins/SelectNode';\nimport TagFilteringPlugin from './plugins/TagFiltering';\n\nclass BlockTagging extends Extension {\n  get name() { return 'yada-blockTagging'; }\n  get plugins() { return [CancelLineBreaksPlugin, SelectNodePlugin, TagFilteringPlugin]; }\n}\n\nexport default new BlockTagging();\n","import './TagMenu.css';\nimport {defer} from 'lodash';\nimport {v4 as uuidv4} from 'uuid';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from '../reducers/CurrentOpenFileState';\n\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport IconButton from '@material-ui/core/IconButton';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport EditIcon from '@material-ui/icons/Edit';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport Popover from '@material-ui/core/Popover';\nimport CheckIcon from '@material-ui/icons/Check';\nimport Input from '@material-ui/core/Input';\nimport Chip from '@material-ui/core/Chip';\n\nconst RENAME_TAG_FIELD = 'rename_field';\n\nconst ADD_TAG_INPUT_ID = 'add_tag_input';\n\nconst TAG_VALUE_REGEX = /[^{}]/;\nconst INVALID_TAG_VALUE_REGEX = /[{}]/;\n\nclass TagListItem extends React.Component {\n  render = () => \n    <div style={{width:\"100%\", display: \"flex\", alignItems: \"center\"}}>\n      <Chip\n        label={this.props.tagValue}\n        color=\"primary\"\n        onDelete={(event) => this.props.handleEditMenuClick(event, this.props.tagValue)}\n        deleteIcon={<MoreVertIcon color=\"secondary\"/>}\n        style={{width: \"100%\", justifyContent: \"space-between\"}}\n        variant=\"outlined\"\n      />\n    </div>\n};\n\nclass TagMenu extends React.Component {\n\n  state = { selectNodeAttrs: {}, modifying: '', editMenuAnchorElement: null, renamePopoverElement: null, currentTag: '' }\n\n  handleAddTag = () => {\n    const tag = document.getElementById(ADD_TAG_INPUT_ID).value.trim();\n    if (!tag || INVALID_TAG_VALUE_REGEX.test(tag) || !this.props.selectNode) { return false; }\n    if (this.state.selectNodeAttrs.hasOwnProperty('tags') && this.state.selectNodeAttrs.tags.hasOwnProperty(tag)) {\n      this.props.dispatchSetToastAction({\n        message: `Tag value \"${tag}\" already exists`,\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[tag] = uuidv4();\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    document.getElementById(ADD_TAG_INPUT_ID).value = '';\n    return true;\n  };\n\n  handleDeleteTag = () => {\n    this.handleEditMenuClose();\n    if (\n      !this.props.selectNode || !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(this.state.currentTag)\n    ) { return false; }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    delete newSelectNodeAttrs.tags[this.state.currentTag];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs, currentTag : '' });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleModifyTagValue = () => {\n    const newTagValue = document.getElementById(RENAME_TAG_FIELD).value.trim();\n    if (\n      !newTagValue || INVALID_TAG_VALUE_REGEX.test(newTagValue) || !this.props.selectNode ||\n      !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(this.state.currentTag)\n    ) { return false; }\n    if (newTagValue === this.state.currentTag) { return true; }\n    if (this.state.selectNodeAttrs.tags.hasOwnProperty(newTagValue)) {\n      this.props.dispatchSetToastAction({\n        message: `Tag value ${newTagValue} already exists`,\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[newTagValue] = newSelectNodeAttrs.tags[this.state.currentTag];\n    delete newSelectNodeAttrs.tags[this.state.currentTag];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n  \n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId ||\n      (!prevProps.selectNode && this.props.selectNode) || (prevProps.selectNode && !this.props.selectNode) ||\n      (prevProps.selectNode && this.props.selectNode && prevProps.selectNode.pos !== this.props.selectNode.pos)\n    ) {\n      document.getElementById(ADD_TAG_INPUT_ID).value = '';\n      defer(() => {\n        if (this.props.selectNode) {\n          const node = BlockTaggingEditorExtension.editor.view.state.doc.nodeAt(this.props.selectNode.pos);\n          this.setState({ selectNodeAttrs: {...(node && node.hasOwnProperty('attrs') ? node.attrs : null)} });\n        } else { this.setState({ selectNodeAttrs: {} }); }\n      });\n    }\n  };\n\n  handleEditMenuClick = (event, tag) => {\n    this.setState({\n      editMenuAnchorElement: event.currentTarget,\n      currentTag: tag\n    })\n  }\n\n  handleEditMenuClose = () => {\n    this.setState({\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleRenameMenuClick = (event) => {\n    this.setState({\n      renamePopoverElement: this.state.editMenuAnchorElement,\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleRenamePopoverClose = () => {\n    this.setState({\n      renamePopoverElement: null\n    })\n  }\n\n  render = () => \n    <div className=\"MarginPane\">\n      <div id=\"tag_menu_wrapper\">\n        <div className=\"InputRow\" id=\"add_tag_input_row\">\n          <OutlinedInput\n            id={ADD_TAG_INPUT_ID}\n            title=\"New Tag\"\n            placeholder=\"New Tag\"\n            color=\"primary\"\n            disabled={!this.props.selectNode}\n            onKeyPress={event=> {\n              if (event.key === 'Enter' && this.handleAddTag()) { event.target.value = ''; }\n              if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n            }}\n            onKeyDown={event=> {\n              if (event.key === 'Escape') {\n                event.target.value = '';\n                BlockTaggingEditorExtension.editor.view.focus();\n              }\n            }}\n            endAdornment={\n              <InputAdornment position=\"end\">\n                <IconButton\n                  aria-label=\"Add\"\n                  title=\"add\"\n                  disabled={!this.props.selectNode}\n                  onClick={this.handleAddTag}\n                  edge=\"end\"\n                >\n                  <AddCircleIcon color=\"primary\" />\n                </IconButton>\n              </InputAdornment>\n            }\n            margin=\"dense\"\n          />\n        </div>\n        <div id=\"tag_menu_list_container\">\n          {\n            this.props.selectNode && this.state.selectNodeAttrs.hasOwnProperty('tags') &&\n            Object.keys(this.state.selectNodeAttrs.tags).length > 0\n              ? <List\n                  component=\"nav\"\n                  aria-labelledby=\"nested-list-subheader\"\n                  subheader={\n                    <ListSubheader component=\"div\" id=\"nested-list-subheader\">\n                      Tags\n                    </ListSubheader>\n                  }\n                  style={{\"maxWidth\" : 360, \"width\" : '100%'}}\n                >\n                  {\n                    Object.keys(this.state.selectNodeAttrs.tags).map((tag) =>\n                      <ListItem\n                       dense={true}\n                      >\n                        <TagListItem \n                          tagValue = {tag}\n                          handleEditMenuClick={this.handleEditMenuClick}\n                        />\n                      </ListItem>\n                    )\n                  }\n                </List>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_tags_placeholder\">\n                  {'No ' + (!this.props.selectNode ? 'Selected Block' : 'Block Tags')}\n                </div>\n          }\n          <Menu\n            id=\"edit_menu\"\n            anchorEl={this.state.editMenuAnchorElement}\n            keepMounted\n            open={Boolean(this.state.editMenuAnchorElement)}\n            onClose={() => this.handleEditMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n          >\n              <MenuItem onClick={() => this.handleRenameMenuClick()}>\n                <ListItemIcon>\n                  <EditIcon fontSize=\"small\" color=\"primary\"  />\n                </ListItemIcon>\n                <ListItemText primary=\"Rename\" color=\"primary\"/>\n              </MenuItem>\n              <MenuItem onClick={() => this.handleDeleteTag()}>\n                <ListItemIcon>\n                  <DeleteIcon fontSize=\"small\" color=\"primary\"/>\n                </ListItemIcon>\n                <ListItemText primary=\"Delete\" color=\"primary\"/>\n              </MenuItem>\n          </Menu>\n          <Popover\n            open={Boolean(this.state.renamePopoverElement)}\n            anchorEl={this.state.renamePopoverElement}\n            anchorOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            transformOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            id=\"rename_popover\"\n          >\n            <Input\n              id={RENAME_TAG_FIELD}\n              autoFocus={true}\n              defaultValue={this.state.currentTag}\n              onBlur={event => {this.handleModifyTagValue();                      \n                                this.handleRenamePopoverClose();\n              }}\n              onKeyDown={event => {\n                if (event.key === 'Escape') { event.target.value = this.state.currentTag; }\n              }}\n              onKeyPress={event => {\n                if (event.key === 'Enter') { event.target.blur(); }\n                if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n              }}\n              endAdornment={\n                <InputAdornment position=\"end\">\n                  <IconButton \n                    onClick= {() => {\n                      this.handleModifyTagValue();\n                      this.handleRenamePopoverClose();\n                    }}\n                  >\n                      <CheckIcon/>\n                  </IconButton>\n                </InputAdornment>\n              }\n              disableUnderline={true}\n              fullWidth={true}\n              style={{height:\"50px\", \"paddingLeft\": \"10px\"}}\n            />\n          </Popover>\n        </div>\n      </div>\n    </div>;\n};\n\nexport default connect(\n  state => ({\n    selectNode: state.selectNode,\n    saveDirtyFlag: state.saveDirtyFlag,\n    currentOpenFileId: state.currentOpenFileId,\n  }),\n  dispatch => ({\n    dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(TagMenu);\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {checkNoOpenFileId} from '../util/FileIdAndTypeUtils';\nimport {\n  SET_SAVE_DIRTY_FLAG_ACTION_TYPE,\n} from '../reducers/CurrentOpenFileState';\nimport {TextSelection} from 'prosemirror-state';\nimport TagMenu from './TagMenu';\nimport RichMarkdownEditor from 'rich-markdown-editor';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\n\nclass Editor extends React.Component {\n  render = () => {\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    return (\n      <div className=\"MainPane\">\n        <div className=\"editor_container\">\n          <div className=\"editor\" hidden={noOpenFileIdCheck}>\n            <RichMarkdownEditor\n              extensions={[BlockTaggingEditorExtension]}\n              key={this.props.fileIdKeyStr}\n              defaultValue={this.props.fileContent}\n              jsonStrValue={!(!this.props.fileContent)}\n              onKeyDown={event => {\n                if (event.key === 'Escape') {\n                  BlockTaggingEditorExtension.editor.view.dispatch(\n                    BlockTaggingEditorExtension.editor.view.state.tr\n                      .setSelection(TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0))\n                  );\n                  event.target.blur();\n                }\n              }}\n              onChange={() => { if (!this.props.saveDirtyFlag) { this.props.dispatchSetSaveDirtyFlagAction(); } }}\n            />\n          </div>\n          <div\n            className=\"placeholder_editor\"\n            hidden={!noOpenFileIdCheck}>\n            <h5>Click or create a new document from the left pane</h5>\n          </div>\n        </div>\n        <TagMenu />\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({ currentOpenFileId: state.currentOpenFileId, currentOpenFileName: state.currentOpenFileName, saveDirtyFlag: state.saveDirtyFlag }),\n  dispatch => ({ dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }) }),\n)(Editor);\n","import {convertStrValueOrDefault, convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\n\nconst SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX = 'sourceViews_';\n\n// API-ish\nexport const doSetLocalStorageSourceViews = (sourceId, sourceViews) =>\n  localStorage.setItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId, JSON.stringify(sourceViews));\n\nconst doGetLocalStorageSourceViews = sourceId => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n  {},\n  'invalid sourceViews',\n);\n\nconst SOURCE_ID_NAMES_LOCAL_STORAGE_KEY = 'sourceIdNames';\n\n// API-ish\nexport const doSetLocalStorageSourceIdNames = sourceIdNames =>\n  localStorage.setItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY, JSON.stringify(sourceIdNames));\n\nconst doGetLocalStorageSourceIdNames = () => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY),\n  {},\n  'invalid sourceIdNames',\n);\n\nexport const calculateLocalStorageNextNewId = (existingIdsDict, candidate) => {\n  while (!candidate || existingIdsDict.hasOwnProperty(candidate.toString())) { candidate += 1; }\n  return candidate.toString();\n};\n\nexport const calculateLocalStorageNextNewFileIds = filesList => ({\n  source: calculateLocalStorageNextNewId(filesList, 0),\n  nextNewViewIdsForSourceIds: Object.fromEntries(Object.entries(filesList).map(\n    ([sourceId, { views }]) => [sourceId, calculateLocalStorageNextNewId(views, 0)]\n  )),\n});\n\nconst DEFAULT_VIEW_NAME = 'Unnamed View';\nconst DEFAULT_SOURCE_NAME = 'Unnamed Source';\n\nconst SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX = 'sourceSavedTagFilters_';\n\nconst VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX = 'viewSpec_';\n\nconst SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX = 'sourceContent_';\n\nexport default {\n  doGetFilesList: async () => {\n    const sourceIdNames = doGetLocalStorageSourceIdNames();\n    if (!sourceIdNames) { return null; }\n    const filesList = {};\n    for (const [sourceId, sourceName] of Object.entries(sourceIdNames)) {\n      const sourceViews = doGetLocalStorageSourceViews(sourceId);\n      if (!sourceViews) { return null; }\n      filesList[sourceId] = { name: sourceName, views: sourceViews };\n    }\n    return filesList;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const viewSpecLocalStorageKey = VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId);\n    if (tagsList.length > 0) { localStorage.setItem(viewSpecLocalStorageKey, JSON.stringify(tagsList)); }\n    else { localStorage.removeItem(viewSpecLocalStorageKey); }\n    return { id: viewId, sourceId, ...(createNew ? { name: DEFAULT_VIEW_NAME, type } : null) };\n  },\n  doGetView: async (fileId) => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(fileId.sourceId, fileId.viewId)),\n    [],\n    'invalid viewSpec',\n  ),\n  doGetSourceTaggedBlocks: async sourceId => {\n    const sourceContentDocStr = localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    if (!sourceContentDocStr) { return {}; }\n    const sourceContentDoc = convertStrValueOrDefault(sourceContentDocStr, null, 'invalid sourceContent');\n    if (!sourceContentDoc) { return null; }\n    const sourceTaggedBlocks = {};\n    if (sourceContentDoc) {\n      const nodes = [sourceContentDoc];\n      while (nodes.length > 0) {\n        const node = nodes.shift();\n        if (node.hasOwnProperty('attrs') && node.attrs.hasOwnProperty('tags')) {\n          for (const [tag, tagId] of Object.entries(node.attrs.tags)) { sourceTaggedBlocks[tagId] = { tag, node }; }\n        } else if (node.hasOwnProperty('content')) { nodes.push(...node.content); }\n      }\n    }\n    return sourceTaggedBlocks;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      '',\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (saveValue === null) { return null; }\n    const sourceContentLocalStorageKey = SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (saveValue) { localStorage.setItem(sourceContentLocalStorageKey, saveValue); }\n    else { localStorage.removeItem(sourceContentLocalStorageKey); }\n    return { id: sourceId, ...(createNew ? { name: DEFAULT_SOURCE_NAME } : null) };\n  },\n  doGetSourceContent: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    '',\n    'invalid sourceContent',\n    valueStr => {\n      JSON.parse(valueStr);\n      return valueStr;\n    },\n  ),\n  // TODO add/remove single instead of set list\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const sourceSavedTagFiltersLocalStorageKey = SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (Object.keys(sourceSavedTagFilters).length > 0) {\n      localStorage.setItem(sourceSavedTagFiltersLocalStorageKey, JSON.stringify(sourceSavedTagFilters));\n    } else { localStorage.removeItem(sourceSavedTagFiltersLocalStorageKey); }\n    return true;\n  },\n  doGetSourceSavedTagFilters: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    {},\n    'invalid sourceSavedTagFilters',\n  ),\n  doDeleteView: async (sourceId, viewId) => {\n    localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    return true;\n  },\n  doDeleteSource: async (sourceId, localStorageSourceViewIds) => {\n    localStorage.removeItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    localStorage.removeItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    for (const viewId of localStorageSourceViewIds) {\n      localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    }\n    localStorage.removeItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    return true;\n  },\n  doRenameView: async () => true,\n  doRenameSource: async () => true,\n};\n","import Cookies from 'js-cookie';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\nimport {convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {ACCESS_TOKEN_COOKIE_KEY, SERVER_BASE_URL} from '../reducers/BackendModeSignedInStatus';\n\nconst EMPTY_SOURCE_CONTENT = { type: 'doc', content: [{ type: 'paragraph', attrs: { tags: {} } }] };\n\nexport default {\n  doGetFilesList: async () => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `documents`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewType=${type}` + (!createNew ? `&viewID=${viewId}` : ''),\n        {\n          method: 'PUT',\n          body: JSON.stringify({ tags: tagsList }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n    );\n    if (response.ok) {\n      const { viewID } = await response.json();\n      return { id: viewID, sourceId: sourceId, ...(createNew ? { name:\"Untitled\", type } : null) };\n    }\n    throw new Error(\"Failed to save view\");\n  },\n  doGetView: async (fileId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const viewResponse = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${fileId.sourceId}&viewID=${fileId.viewId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      const tagResponse = await fetchWithTimeout(\n          SERVER_BASE_URL + `tags?docID=${fileId.sourceId}`,\n          { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (!viewResponse.ok || !tagResponse.ok) { return null; }\n      const view_json = await viewResponse.json();\n      const tags_json = await tagResponse.json();\n      return {\"view\": view_json, \"tags\": tags_json, \"type\": fileId.viewType};\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceTaggedBlocks: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `tags?docID=${sourceId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      JSON.stringify(EMPTY_SOURCE_CONTENT),\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (!saveValue) { return null; }\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + 'document' + (!createNew ? `?docID=${sourceId}` : ''),\n        {\n          method: 'PUT',\n          body: saveValue,\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        const { id, name } = await response.json();\n        return { id: id, ...(createNew ? { name } : null) };\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceContent: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.text(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    const filters = Object.keys(sourceSavedTagFilters);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=`,\n        {\n          method: 'POST',\n          body: JSON.stringify({ body: {\"docID\": sourceId, \"filters\": filters} }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        return true;\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceSavedTagFilters: async sourceId => { // TODO\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doDeleteSource: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doDeleteView: async (sourceId, viewId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameSource: async (sourceId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameView: async (sourceId, viewId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n};\n","import {BACKEND_MODE_SIGNED_IN_STATUS} from '../reducers/BackendModeSignedInStatus';\nimport LocalFileStorageSystemClient from './LocalFileStorageSystemClient';\nimport HostedFileStorageSystemClient from './HostedFileStorageSystemClient';\nimport store from '../store';\n\nconst getFileStorageSystemClient = () =>\n  store.getState().backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n    ? LocalFileStorageSystemClient : HostedFileStorageSystemClient;\n\nconst clientInterface = {\n  doGetFilesList: () => { throw new Error('not implemented'); },\n  doSaveViewSpec: () => { throw new Error('not implemented'); },\n  doGetView: () => { throw new Error('not implemented'); },\n  doGetSourceTaggedBlocks: () => { throw new Error('not implemented'); },\n  doSaveSourceContent: () => { throw new Error('not implemented'); },\n  doGetSourceContent: () => { throw new Error('not implemented'); },\n  doSetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doGetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doDeleteView: () => { throw new Error('not implemented'); },\n  doDeleteSource: () => { throw new Error('not implemented'); },\n  doRenameView: () => { throw new Error('not implemented'); },\n  doRenameSource: () => { throw new Error('not implemented'); },\n};\n\nexport default Object.keys(clientInterface).reduce(\n  (partial, key) => {\n    partial[key] = async (...args) => {\n      const fileStorageSystemClient = getFileStorageSystemClient();\n      return fileStorageSystemClient.hasOwnProperty(key)\n        ? (\n            store.getState().backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n              ? await fileStorageSystemClient[key](...args) : null\n          )\n        : clientInterface[key]();\n    };\n    return partial;\n  },\n  {},\n);\n","import './Editor.css';\nimport {defer} from 'lodash';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {NO_OPEN_FILE_ID, checkNoOpenFileId, checkSourceFileId, getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\nimport Editor from './Editor';\nimport {handleSetCurrentOpenFileId} from './Navigator';\n\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\nimport {BACKEND_MODE_SIGNED_IN_STATUS} from \"../reducers/BackendModeSignedInStatus\";\nimport store from \"../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../reducers/CurrentOpenFileState\";\n\nexport const INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY = 'initialTagFilters';\n\nconst DEFAULT_STATE = {\n  fileIdKeyStr: getFileIdKeyStr(NO_OPEN_FILE_ID),\n  fileContent: '',\n};\n\nclass SourceEditorWithTagFiltersInput extends React.Component {\n\n  state = DEFAULT_STATE;\n  \n  keydownHandler = event => {\n    if ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey) && event.keyCode === 83) {\n      event.preventDefault();\n      if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT) {\n        if (checkSourceFileId(this.props.currentOpenFileId)) {\n          FileStorageSystemClient.doSaveSourceContent(\n              BlockTaggingEditorExtension.editor.value(true),\n              this.props.currentOpenFileId.sourceId,\n          ).then(success => {\n            if (success) {\n              this.props.dispatchSetToastAction({\n                message: \"Saved source file\",\n                severity: TOAST_SEVERITY.SUCCESS,\n                open: true\n              });\n              store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n            }\n            else {\n              this.props.dispatchSetToastAction({\n                message: \"Failed to save source file\",\n                severity: TOAST_SEVERITY.ERROR,\n                open: true\n              });\n            }\n          });\n        }\n      }\n    }\n  }\n  \n  changeFile = async () => {\n    if (!checkNoOpenFileId(this.props.currentOpenFileId)) {\n      defer(() => {\n        BlockTaggingEditorExtension.editor.focusAtStart();\n      });\n    }\n    const fileIdKeyStr = getFileIdKeyStr(this.props.currentOpenFileId);\n    if (checkSourceFileId(this.props.currentOpenFileId)) {\n      FileStorageSystemClient.doGetSourceContent(this.props.currentOpenFileId.sourceId).then(value => {\n        if (value === null) {\n          this.props.dispatchSetToastAction({\n            message: \"Failed to retrieve source content\",\n            severity: TOAST_SEVERITY.ERROR,\n            open: true\n          });\n          handleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n        } else {\n          this.setState({fileIdKeyStr, fileContent: value ?? ''});\n        }\n      });\n    } else {\n      this.setState({fileIdKeyStr, fileContent: ''});\n    }\n  };\n\n  componentDidMount = () => {\n    document.addEventListener('keydown',this.keydownHandler);\n    this.changeFile();\n  };\n  \n  componentWillUnmount = () => { document.removeEventListener('keydown', this.keydownHandler); };\n  \n  \n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n    ) {\n      this.changeFile();\n    }\n  };\n\n  render = () => {\n    return (\n      <Editor fileIdKeyStr={this.state.fileIdKeyStr} fileContent={this.state.fileContent} />\n    );\n  };\n}\n\nexport default connect(\n    state => ({\n      currentOpenFileId: state.currentOpenFileId,\n      currentOpenFileName: state.currentOpenFileName\n    }),\n    dispatch => ({\n      dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n    }),\n)(SourceEditorWithTagFiltersInput);\n","import './Navigator.css';\nimport {debounce, defer} from 'lodash';\nimport Cookies from 'js-cookie';\nimport React from 'react';\nimport {batch, connect} from 'react-redux';\nimport {\n  FILE_TYPE,\n  NO_OPEN_FILE_ID,\n  validateFileIdObj,\n  checkNoOpenFileId,\n  checkSourceFileId,\n  checkViewFileId,\n  getFileIdKeyStr,\n} from '../util/FileIdAndTypeUtils';\nimport {INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY} from './SourceEditorWithTagFiltersInput';\nimport {\n  CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE,\n  INITIAL_FILE_ID_LOCAL_STORAGE_KEY,\n  INITIAL_FILE_NAME_LOCAL_STORAGE_KEY,\n  setCurrentOpenFileIdAction,\n  setCurrentOpenFileNameAction,\n  setSelectNodeAction,\n} from '../reducers/CurrentOpenFileState';\nimport {\n  ACCESS_TOKEN_COOKIE_KEY,\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport {\n  doSetLocalStorageSourceIdNames,\n  doSetLocalStorageSourceViews,\n  calculateLocalStorageNextNewId,\n  calculateLocalStorageNextNewFileIds,\n} from '../backend/LocalFileStorageSystemClient';\nimport Button from '@material-ui/core/Button';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Divider from '@material-ui/core/Divider';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Collapse from '@material-ui/core/Collapse';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport EditIcon from '@material-ui/icons/Edit';\nimport Popover from '@material-ui/core/Popover';\nimport store from '../store';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport CheckIcon from '@material-ui/icons/Check';\nimport AddIcon from '@material-ui/icons/Add';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport AmpStoriesIcon from '@material-ui/icons/AmpStories';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\n\nexport const handleSetCurrentOpenFileId = (fileId, fileName={\"sourceName\": '', \"viewName\": ''}) => {\n  if (!validateFileIdObj(fileId)) { return false; }\n  const currentOpenFileId = store.getState().currentOpenFileId;\n  if (fileId.sourceId === currentOpenFileId.sourceId && fileId.viewId === currentOpenFileId.viewId) { return true; }\n  if (!store.getState().saveDirtyFlag || window.confirm('confirm discard unsaved changes')) {\n    batch(() => {\n      store.dispatch(setCurrentOpenFileIdAction(fileId));\n      store.dispatch(setCurrentOpenFileNameAction(fileName));\n      store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n      store.dispatch(setSelectNodeAction(null));\n    });\n    localStorage.setItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY, JSON.stringify(fileId));\n    localStorage.setItem(INITIAL_FILE_NAME_LOCAL_STORAGE_KEY, JSON.stringify(fileName));\n    localStorage.removeItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY);\n    return true;\n  }\n  return false;\n};\n\nconst convertFilesListStateToFileIdNamesList = filesListState => Object.fromEntries(\n  Object.entries(filesListState).map(([id, { name }]) => [id, name])\n);\n\nconst countNumFiles = filesList => Object.entries(filesList)\n  .reduce((count, [_sourceId, { views }]) => count + 1 + Object.keys(views).length, 0);\n\nconst FILE_LIST_ID = 'file_list';\n\nconst SEARCH_FILE_NAMES_INPUT_ID = 'search_file_names_input';\n\nconst CURRENT_SOURCE_NAME_INPUT_ID = 'current_source_name_input';\nconst CURRENT_VIEW_NAME_INPUT_ID = 'current_view_name_input';\n\nconst RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX = 'rename_source_list_item_input_';\nconst RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX = 'rename_view_list_item_input_';\n\nconst RENAME_INPUT_TYPES = {\n  CURRENT_SOURCE: 'CURRENT_SOURCE',\n  CURRENT_VIEW: 'CURRENT_VIEW',\n  SOURCE_LIST_ITEM: 'SOURCE_LIST_ITEM',\n  VIEW_LIST_ITEM: 'VIEW_LIST_ITEM',\n};\n\nconst getRenameInputIdFunctions = {\n  [RENAME_INPUT_TYPES.CURRENT_SOURCE]: () => CURRENT_SOURCE_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.CURRENT_VIEW]: () => CURRENT_VIEW_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: fileId => RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX + fileId.sourceId,\n  [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: fileId => RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX + getFileIdKeyStr(fileId),\n};\n\nconst NO_RENAMING_STATE = { inputType: null, fileId: NO_OPEN_FILE_ID };\n\nconst DEFAULT_STATE = {\n  searching: '',\n  renaming: NO_RENAMING_STATE,\n  filesList: {},\n  nextNewFileIds: null,\n  selectedFileId: null,\n  selectedViewId: null,\n  selectedFileOpen: false,\n  editMenuAnchorElement: null,\n  renameSelected: false,\n  newViewAnchorElement: null\n};\n\nclass FileListItem extends React.Component {\n  render = () => {\n    if(this.props.fileId.viewId !== 0){\n      const viewType = this.props.viewType;\n      return (\n        <div className={\"fileList-viewRoot\"} style={(this.props.selected) ? \n                                                  {backgroundColor: 'rgba(30, 61, 89, 0.3)', width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} : \n                                                  {width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} }>\n          <IconButton>\n            {\n              (viewType === FILE_TYPE.CARD_VIEW) ? \n              <AmpStoriesIcon color=\"primary\"/>:\n              (viewType === FILE_TYPE.TEXT_VIEW) ?\n             <TextFieldsIcon color=\"primary\"/> :\n              null\n            }\n          </IconButton>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n            style={{color: \"#1E3D59\"}}\n          />\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"primary\"/>\n          </IconButton>\n        </div>\n      );\n    }else{\n      return (\n        <div className={\"fileList-viewRoot\"} style={(this.props.selected) ? \n                                                      {backgroundColor: 'rgba(30, 61, 89, 0.3)', border:\"solid #3f51b5 thin\", width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} :\n                                                       {width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} }>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n            style={{color: \"#1E3D59\"}}\n          />\n          {this.props.childViewsExist ? (this.props.open ? <ExpandLess /> : <ExpandMore />) : null}\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"primary\"/>\n          </IconButton>\n        </div>\n      );\n    }\n  }\n};\n\nclass Navigator extends React.Component {\n  \n  state = DEFAULT_STATE;\n\n  resetState = () => { this.setState(DEFAULT_STATE); }\n\n  getSourceName = fileId => validateFileIdObj(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId)\n      ? this.state.filesList[fileId.sourceId].name : '';\n  \n  getViewName = fileId => checkViewFileId(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId) &&\n    this.state.filesList[fileId.sourceId].views.hasOwnProperty(fileId.viewId)\n      ? this.state.filesList[fileId.sourceId].views[fileId.viewId].name : '';\n\n  getFileName = fileId => checkViewFileId(fileId) ? this.getViewName(fileId) : this.getSourceName(fileId);\n\n  getRenameInputValueFunctions = {\n    [RENAME_INPUT_TYPES.CURRENT_SOURCE]: this.getSourceName,\n    [RENAME_INPUT_TYPES.CURRENT_VIEW]: this.getViewName,\n    [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: this.getFileName,\n    [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: this.getFileName,\n  };\n\n  handleSwitchBackendModeSignedInStatus = status => {\n    if (status === this.props.backendModeSignedInStatus) { return true; }\n    if (handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)) {\n      this.resetState();\n      this.props.dispatchSetBackendModeSignedInStatusAction(status);\n      return true;\n    }\n    return false;\n  };\n\n  handleCancelRenaming = (inputType, fileId) => {\n    const input = document.getElementById(getRenameInputIdFunctions[inputType](fileId));\n    input.value = this.getRenameInputValueFunctions[inputType](fileId);\n    input.setSelectionRange(0, 0);\n    this.setState({ renaming: NO_RENAMING_STATE });\n  };\n\n  handleClearSearchingInput = () => {\n    document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value = '';\n    this.setState({ searching: '' });\n  };\n\n  handleChangeSearchingInput = () => {\n    this.setState({ searching: document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value.trim() });\n  };\n\n  handleDoFileNamesSearch = () => Object.fromEntries(\n    Object.entries(this.state.filesList).map(([sourceId, { name: sourceName, views }]) => [\n      sourceId,\n      {\n        name: sourceName,\n        views: this.state.searching\n          ? Object.fromEntries(Object.entries(views).filter(\n              ([_viewId, { name: viewName }]) => viewName.includes(this.state.searching)\n            ))\n          : views,\n      },\n    ]).filter(\n      ([_sourceId, { name: sourceName, views }]) => !this.state.searching ||\n        Object.keys(views).length > 0 || sourceName.includes(this.state.searching)\n    )\n  );\n\n  handleCreateNewFile = async fileType => {\n    if (!FILE_TYPE.hasOwnProperty(fileType)) { return; }\n    const sourceFileType = fileType === FILE_TYPE.SOURCE;\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    if (\n      (noOpenFileIdCheck && !sourceFileType) ||\n      (!noOpenFileIdCheck && !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID))\n    ) { return; }\n    const localStorageNextNewFileId =\n      this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n        ? (\n            sourceFileType\n              ? this.state.nextNewFileIds.source\n              : this.state.nextNewFileIds.nextNewViewIdsForSourceIds[this.props.currentOpenFileId.sourceId]\n          )\n        : null;\n    const newFilePromise = sourceFileType\n      ? FileStorageSystemClient.doSaveSourceContent(null, localStorageNextNewFileId, true)\n      : FileStorageSystemClient.doSaveViewSpec(\n          [],\n          this.props.currentOpenFileId.sourceId,\n          localStorageNextNewFileId,\n          fileType,\n          true,\n        );\n    try {\n      const newFile = await newFilePromise;\n      const updatedSourceId = sourceFileType ? newFile.id : this.state.selectedFileId;\n      const newFilesList = {\n        ...this.state.filesList,\n        [updatedSourceId]: {\n          name: sourceFileType ? newFile.name : this.state.filesList[updatedSourceId].name,\n          views: {\n            ...(\n                !sourceFileType\n                    ? {\n                      ...this.state.filesList[updatedSourceId].views,\n                      [newFile.id]: {name: newFile.name, type: newFile.type},\n                    }\n                    : null\n            ),\n          },\n        },\n      };\n      this.setState(\n        {filesList: newFilesList,\n         selectedFileId: updatedSourceId,\n         selectedFileOpen: !sourceFileType,\n         selectedViewId: (sourceFileType) ? 0 : newFile.id\n        });\n      \n      defer(() => {\n        const fileId = {sourceId: updatedSourceId, viewId: !sourceFileType ? newFile.id : 0, viewType: sourceFileType ? FILE_TYPE.EMPTY: newFile.type};\n        const fileName = {sourceName: this.getSourceName(fileId), viewName: this.getViewName(fileId)};\n        handleSetCurrentOpenFileId(fileId, fileName);\n      });\n      if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n        if (sourceFileType) {\n          doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList));\n        } else {\n          doSetLocalStorageSourceViews(updatedSourceId, newFilesList[updatedSourceId].views);\n        }\n        this.setState({\n          nextNewFileIds: {\n            source: sourceFileType\n                ? calculateLocalStorageNextNewId(newFilesList, parseInt(updatedSourceId))\n                : this.state.nextNewFileIds.source,\n            nextNewViewIdsForSourceIds: {\n              ...this.state.nextNewFileIds.nextNewViewIdsForSourceIds,\n              ...(\n                  !sourceFileType\n                      ? {\n                        [updatedSourceId]:\n                            calculateLocalStorageNextNewId(newFilesList[updatedSourceId].views, parseInt(newFile.id)),\n                      }\n                      : null\n              ),\n            },\n          },\n        });\n      }\n    } catch (e) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to create new file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n    }\n  }\n\n  handleDeleteFile = async fileId => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    if (\n      fileId.sourceId === this.props.currentOpenFileId.sourceId &&\n      fileId.viewId === this.props.currentOpenFileId.viewId &&\n      !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)\n    ) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const deleteFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doDeleteSource(\n          fileId.sourceId,\n          Object.keys(this.state.filesList[fileId.sourceId].views),\n        )\n      : FileStorageSystemClient.doDeleteView(fileId.sourceId, fileId.viewId);\n    const success = await deleteFilePromise;\n    if (!success) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to delete file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return;\n    }\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) { delete newFilesList[fileId.sourceId]; }\n    else {\n      const newSourceViews = {...newFilesList[fileId.sourceId].views};\n      delete newSourceViews[fileId.viewId];\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) {\n        doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList));\n        const newNextNewViewIdsForSourceIds = {...this.state.nextNewFileIds.nextNewViewIdsForSourceIds};\n        delete newNextNewViewIdsForSourceIds[fileId.sourceId];\n        this.setState({\n          nextNewFileIds: {\n            source: this.state.nextNewFileIds.source,\n            nextNewViewIdsForSourceIds: newNextNewViewIdsForSourceIds,\n          },\n        });\n      } else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  handleRenameFile = async (fileId) => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    const input = document.getElementById(\"rename_field\");\n    if (!input) { return; }\n    const newName = input.value.trim();\n    if (!newName || newName === this.getFileName(fileId)) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const renameFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doRenameSource(fileId.sourceId, newName)\n      : FileStorageSystemClient.doRenameView(fileId.sourceId, fileId.viewId, newName);\n    const success = await renameFilePromise;\n    if (!success) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to rename file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return;\n    }\n    store.dispatch(setCurrentOpenFileNameAction({sourceName: sourceFileIdCheck ? newName : this.getSourceName(fileId), viewName: sourceFileIdCheck ? '' : newName}));\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) {\n      newFilesList[fileId.sourceId] = { name: newName, views: newFilesList[fileId.sourceId].views };\n    } else {\n      const newSourceViews = {\n        ...newFilesList[fileId.sourceId].views,\n        [fileId.viewId]: { ...newFilesList[fileId.sourceId].views[fileId.viewId], name: newName },\n      };\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) { doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList)); }\n      else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  componentDidMount = () => {\n    this.setState({\n      selectedFileId : this.props.currentOpenFileId.sourceId,\n      selectedViewId: this.props.currentOpenFileId.viewId,\n      selectedFileOpen: this.props.currentOpenFileId.viewId !== 0\n    })\n    FileStorageSystemClient.doGetFilesList().then(filesList => {\n      if (!filesList) {\n        this.props.dispatchSetToastAction({\n          message: \"Failed to retrieve file list\",\n          severity: TOAST_SEVERITY.ERROR,\n          open: true\n        });\n      } else { this.setState({ filesList }); }\n      if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n        this.setState({ nextNewFileIds: calculateLocalStorageNextNewFileIds(this.state.filesList) });\n      }\n    });\n  };\n\n  componentDidUpdate = (prevProps, prevState) => {\n    if (prevProps.backendModeSignedInStatus !== this.props.backendModeSignedInStatus) {\n      FileStorageSystemClient.doGetFilesList().then(filesListValue => filesListValue ?? {}).then(filesList => {\n        this.setState({\n          ...DEFAULT_STATE,\n          filesList,\n          nextNewFileIds: this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n            ? calculateLocalStorageNextNewFileIds(filesList) : null,\n        });\n      });\n    }\n  };\n\n  handleFileListClick = (fileId) => {\n    if (fileId === this.state.selectedFileId) {\n      handleSetCurrentOpenFileId({ sourceId:fileId, viewId: 0, viewType: FILE_TYPE.EMPTY}, {sourceName: this.state.filesList[fileId].name, viewName: ''});\n      this.setState({\n        selectedViewId: null,\n        selectedFileOpen: !(this.state.selectedFileOpen)\n      });\n    }else{\n      if(handleSetCurrentOpenFileId({ sourceId:fileId, viewId: 0, viewType: FILE_TYPE.EMPTY}, {sourceName: this.state.filesList[fileId].name, viewName: ''})){\n        this.setState({\n          selectedFileId: fileId,\n          selectedViewId: null,\n          selectedFileOpen: true\n        });\n      }\n    }\n    \n  };\n\n  handleViewListClick = (fileId) => {\n    const fileName = {sourceName: this.getSourceName(fileId), viewName: this.getViewName(fileId)};\n    handleSetCurrentOpenFileId(fileId, fileName);\n    this.setState({\n      selectedViewId: fileId.viewId,\n    });\n  };\n\n  handleEditMenuClick = (event) => {\n    this.setState({\n      editMenuAnchorElement: event.currentTarget\n    })\n  }\n\n  handleEditMenuClose = () => {\n    this.setState({\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleDeleteMenuClick = () => {\n    this.handleEditMenuClose();\n    const fileId = { sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId === null) ? 0 : this.state.selectedViewId}\n    this.handleDeleteFile(fileId).then(success => {\n      if (fileId.viewId !== 0) {\n        this.setState({\n          selectedViewId: null,\n        });\n      }else{\n        this.setState({\n          selectedFileId: null,\n          selectedViewId: null,\n          selectedFileOpen: false\n        });\n      }\n    });\n  }\n\n  handleRenameMenuClick = (event) => {\n    this.setState({\n      renamePopoverElement: this.state.editMenuAnchorElement,\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleRenamePopoverClose = () => {\n    this.setState({\n      renamePopoverElement: null\n    })\n  }\n\n  handleViewMenuOpen = (event) => {\n    this.setState({\n      newViewAnchorElement : this.state.editMenuAnchorElement\n    })\n  }\n\n  handleViewMenuClose = () => {\n    this.setState({\n      newViewAnchorElement : null,\n      editMenuAnchorElement: null\n    })\n  }\n\n  render = () => {\n    const numFiles = countNumFiles(this.state.filesList);\n    const filteredFilesList = this.state.searching ? this.handleDoFileNamesSearch() : this.state.filesList;\n    const numFilteredFiles = countNumFiles(filteredFilesList);\n    return (\n      <div className=\"SidePane\">\n        <div id=\"file_list_container\">\n            <Button\n              variant=\"outlined\"\n              color=\"primary\"\n              endIcon={<AddCircleIcon />}\n              disableElevation\n              id=\"new_document_button\"\n              onClick={() => { this.handleCreateNewFile(FILE_TYPE.SOURCE); }}\n            >\n              New Document\n            </Button>\n          <div className=\"InputRow\" id=\"search_file_names_input_row\">\n            <Input\n              variant=\"outlined\"\n              id={SEARCH_FILE_NAMES_INPUT_ID}\n              startAdornment={\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              }\n              style={{\"width\":\"100%\"}}\n              title=\"Search File Names\"\n              placeholder=\"Search File Names\"\n              onChange={debounce(this.handleChangeSearchingInput, 150)}\n              onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n              onKeyDown={event => { if (event.key === 'Escape') { event.target.blur(); } }}\n            />\n          </div>\n          {\n            Object.keys(filteredFilesList).length > 0\n              ?  <List\n                    component=\"nav\"\n                    aria-labelledby=\"nested-list-subheader\"\n                    subheader={\n                      <ListSubheader component=\"div\" id=\"nested-list-subheader\">\n                        Source Files\n                      </ListSubheader>\n                    }\n                    id={FILE_LIST_ID}\n                    style={{\"maxWidth\" : 360, \"width\" : '100%'}}\n                  >\n                  {\n                    Object.entries(filteredFilesList).map(([sourceId, { views }]) =>\n                    <div>\n                      <ListItem button \n                      key={sourceId} \n                      disableGutters={true}\n                      divider={true}\n                      style={{\"padding\":\"0px\"}}\n                      onClick={() => {this.handleFileListClick(sourceId)}}\n                      >\n                        <FileListItem\n                          fileId={{ sourceId, viewId: 0 }}\n                          selected={sourceId === this.state.selectedFileId}\n                          open={sourceId === this.state.selectedFileId && this.state.selectedFileOpen}\n                          handleEditMenuClick={this.handleEditMenuClick}\n                          childViewsExist={Object.keys(views).length > 0}\n                          fileName={this.getFileName({ sourceId, viewId: 0 })}\n                          renameSelected={this.state.renameSelected}\n                        />\n                      </ListItem>\n                        {\n                          Object.keys(views).length > 0\n                            ? <Collapse in={sourceId === this.state.selectedFileId && this.state.selectedFileOpen} timeout=\"auto\" unmountOnExit>\n                                <List component=\"div\" disablePadding style={{\"borderStyle\": \"none solid solid solid\", \"borderColor\" :\"#3f51b5\", \"borderWidth\": \"thin\", \"borderRadius\": \"4px\"}}>\n                                {\n                                  Object.keys(views).map(viewId => {\n                                    const fileId = { sourceId, viewId, \"viewType\": views[viewId].type };\n                                    return (\n                                      <ListItem button \n                                      key={getFileIdKeyStr(fileId)} \n                                      disableGutters={true}\n                                      divider={true}\n                                      style={{ \"paddingTop\": \"0px\", \"paddingBottom\": \"0px\", \"backgroundColor\": \"transparent\"}}\n                                      onClick={() => {this.handleViewListClick(fileId)}}\n                                      >\n                                      <FileListItem\n                                          fileId={fileId}\n                                          open={viewId === this.state.selectedViewId}\n                                          handleEditMenuClick={this.handleEditMenuClick}\n                                          fileName={this.getFileName(fileId)}\n                                          viewType={views[viewId].type}\n                                          renameSelected={this.state.renameSelected}\n                                          selected={viewId === this.state.selectedViewId}\n                                        />\n                                      </ListItem>\n                                    );\n                                  })\n                                }\n                                </List>\n                              </Collapse>\n                            : null\n                          }\n                          </div>   \n                    )\n                  }\n                </List>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_files_placeholder\">\n                  No Files\n                </div>\n          }\n          <Menu\n            id=\"edit_menu\"\n            anchorEl={this.state.editMenuAnchorElement}\n            keepMounted\n            open={Boolean(this.state.editMenuAnchorElement)}\n            onClose={() => this.handleEditMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n          >\n            {\n              (this.state.selectedViewId === null) ? \n              <MenuItem onClick={() => this.handleViewMenuOpen()}>\n                <ListItemIcon>\n                  <AddIcon fontSize=\"small\" color=\"primary\" />\n                </ListItemIcon>\n                <ListItemText primary=\"New View\" color=\"primary\"/>\n              </MenuItem>\n              : null\n            }\n              <MenuItem onClick={() => this.handleRenameMenuClick()}>\n                <ListItemIcon>\n                  <EditIcon fontSize=\"small\" color=\"primary\"/>\n                </ListItemIcon>\n                <ListItemText primary=\"Rename\" color=\"primary\"/>\n              </MenuItem>\n              <MenuItem onClick={() => this.handleDeleteMenuClick()}>\n                <ListItemIcon>\n                  <DeleteIcon fontSize=\"small\" color=\"primary\"/>\n                </ListItemIcon>\n                <ListItemText primary=\"Delete\" color=\"primary\"/>\n              </MenuItem>\n          </Menu>\n          <Menu \n            id=\"viewMenu\"\n            anchorEl={this.state.newViewAnchorElement}\n            keepMounted\n            open={Boolean(this.state.newViewAnchorElement)}\n            onClose={() => this.handleViewMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'left',\n            }}\n          >\n              <MenuItem \n                  onClick={() => {\n                    this.handleViewMenuClose();\n                    this.handleCreateNewFile(FILE_TYPE.TEXT_VIEW);}}\n              >\n                <ListItemIcon>\n                  <TextFieldsIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Text View\" />\n              </MenuItem>\n              <MenuItem\n              onClick={() => {\n                this.handleViewMenuClose();\n                this.handleCreateNewFile(FILE_TYPE.CARD_VIEW);}}\n              >\n                <ListItemIcon>\n                  <AmpStoriesIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Card View\" />\n              </MenuItem>\n          </Menu>\n          <Popover\n            open={Boolean(this.state.renamePopoverElement)}\n            anchorEl={this.state.renamePopoverElement}\n            anchorOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            transformOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            id=\"rename_popover\"\n          >\n            <Input\n              id=\"rename_field\"\n              autoFocus={true}\n              defaultValue={this.getFileName({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})}\n              onKeyPress={event => {\n                if(event.key === 'Enter') {\n                    this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              onKeyDown={event => {\n                if(event.key === 'Escape') {\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              endAdornment={\n                <InputAdornment position=\"end\">\n                  <IconButton \n                    onClick= {() => {\n                      this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                      this.handleRenamePopoverClose();\n                    }}\n                  >\n                      <CheckIcon/>\n                  </IconButton>\n                </InputAdornment>\n              }\n              disableUnderline={true}\n              fullWidth={true}\n              style={{height:\"50px\", \"paddingLeft\": \"10px\"}}\n            />\n          </Popover>\n          <div\n            className=\"PlaceholderDivWithText\"\n            id=\"filtered_files_placeholder\"\n            hidden={!this.state.searching}>\n            {(numFiles - numFilteredFiles) + ' of ' + (numFiles) + ' files hidden by search'}\n          </div>\n        </div>\n        <div id=\"user_controls_container\">\n          {\n            this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN\n              ? <Button\n                  variant=\"outlined\"\n                  onClick={() => {\n                    if (\n                      this.props.dispatchSetBackendModeSignedInStatusAction(\n                        BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                      )\n                    ) { Cookies.remove(ACCESS_TOKEN_COOKIE_KEY); }\n                  }}>\n                  Sign out\n                </Button>\n              : null\n          }\n          <Button\n            variant=\"outlined\"\n            onClick={() => {\n              if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n                getUserSignedInStatus().then(backendModeSignedInStatus => {\n                  this.handleSwitchBackendModeSignedInStatus(backendModeSignedInStatus);\n                });\n              } else { this.handleSwitchBackendModeSignedInStatus(BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE); }\n            }}>\n            {\n              'Switch to ' +\n              (\n                this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n                  ? 'cloud' : 'local'\n              ) + ' storage'\n            }\n          </Button>\n        </div>\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({\n    currentOpenFileId: state.currentOpenFileId,\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(Navigator);\n","import nearley from 'nearley';\n// Generated automatically by nearley, version undefined\n// http://github.com/Hardmath123/nearley\n/*\nMain -> Expression {% id %}\nExpression -> Expression_ {% id %} | Factor {% id %}\nExpression_ -> Factor _ \"|\" _ Expression {% function(d) { return [d[0], d[2], d[4]] } %}\nFactor -> Factor_ {% id %} | Term {% id %}\nFactor_ -> Term _ \"&\" _ Factor {% function(d) { return [d[0], d[2], d[4]] } %}\nTerm -> Not {% id %} | Nested {% id %} | Tag {% id %}\nNot -> \"!\" (Nested {% id %} | Tag {% id %})\nNested -> \"(\" _ Expression _ \")\" {% function(d) { return d[2] } %}\nTag -> \"#{\" [^{}]:+ \"}\" {% function(d) { return [d[0], d[1].join(\"\"), d[2]].join(\"\") } %}\n_ -> \" \":* {% function(d) { return null } %}\n*/\nfunction id(x) {\n  return x[0];\n}\nconst Grammar = {\n  Lexer: undefined,\n  ParserRules: [\n    { name: \"Main\", symbols: [\"Expression\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Expression_\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Factor\"], postprocess: id },\n    {\n      name: \"Expression_\",\n      symbols: [\"Factor\", \"_\", { literal: \"|\", pos: 30 }, \"_\", \"Expression\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Factor\", symbols: [\"Factor_\"], postprocess: id },\n    { name: \"Factor\", symbols: [\"Term\"], postprocess: id },\n    {\n      name: \"Factor_\",\n      symbols: [\"Term\", \"_\", { literal: \"&\", pos: 60 }, \"_\", \"Factor\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Term\", symbols: [\"Not\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Tag\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Tag\"], postprocess: id },\n    {\n      name: \"Not\",\n      symbols: [{ literal: \"!\", pos: 92 }, \"Not$subexpression$1\"],\n    },\n    {\n      name: \"Nested\",\n      symbols: [\n        { literal: \"(\", pos: 110 },\n        \"_\",\n        \"Expression\",\n        \"_\",\n        { literal: \")\", pos: 118 },\n      ],\n      postprocess: function(d) {\n        return d[2];\n      },\n    },\n    {\n      name: \"Tag$string$1\",\n      symbols: [{ literal: \"#\" }, { literal: \"{\" }],\n      postprocess: function joiner(d) {\n        return d.join(\"\");\n      },\n    },\n    { name: \"Tag$ebnf$1\", symbols: [/[^{}]/] },\n    {\n      name: \"Tag$ebnf$1\",\n      symbols: [/[^{}]/, \"Tag$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"Tag\",\n      symbols: [\"Tag$string$1\", \"Tag$ebnf$1\", { literal: \"}\", pos: 131 }],\n      postprocess: function(d) {\n        return d[1].join(\"\").trim();\n      },\n    },\n    { name: \"_$ebnf$1\", symbols: [] },\n    {\n      name: \"_$ebnf$1\",\n      symbols: [{ literal: \" \", pos: 139 }, \"_$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"_\",\n      symbols: [\"_$ebnf$1\"],\n      postprocess: function(d) {\n        return null;\n      },\n    },\n  ],\n  ParserStart: \"Main\",\n};\nexport const parse = (inputText, throwErrors = true) => {\n  let outputParsedExpr = null;\n  if (inputText) {\n    const parser = new nearley.Parser(nearley.Grammar.fromCompiled(Grammar));\n    try {\n      parser.feed(inputText.trim());\n      if (parser.results.length > 0) {\n        outputParsedExpr = parser.results;\n      }\n    } catch (ex) {}\n  }\n  return outputParsedExpr;\n};\n","import React from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport {connect} from 'react-redux';\nimport {setBackendModeSignedInStatusAction} from '../reducers/BackendModeSignedInStatus';\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\nimport DescriptionIcon from '@material-ui/icons/Description';\nimport Link from '@material-ui/core/Link';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport AmpStoriesIcon from '@material-ui/icons/AmpStories';\nimport {\n\tFILE_TYPE,\n\tcheckNoOpenFileId,\n\tcheckSourceFileId,\n\tcheckViewFileId,\n\tNO_OPEN_FILE_ID\n} from '../util/FileIdAndTypeUtils';\nimport Button from '@material-ui/core/Button';\nimport SaveIcon from '@material-ui/icons/Save';\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport {parse as parseTagFilters} from '../lib/TagFiltersGrammar';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {TagFilteringPluginKey} from '../editor_extension/plugins/TagFiltering';\nimport {Selection, TextSelection} from 'prosemirror-state';\nimport {defer} from 'lodash';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\nimport store from \"../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE, SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../reducers/CurrentOpenFileState\";\n\nconst TAG_FILTERS_INPUT_ID = 'tag_filters_input';\n\nconst DEFAULT_STATE = {\n\tmodifyingTagFilters: false,\n\tcurrentTagFiltersStr: '',\n\tcurrentParsedTagFiltersStr: '',\n\tsourceSavedTagFilters: {},\n};\n\nclass Navbar extends React.Component {\n\tstate = DEFAULT_STATE;\n\t\n\thandleSave = () => {\n    store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE })\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tFileStorageSystemClient.doSaveSourceContent(\n\t\t\t\tBlockTaggingEditorExtension.editor.value(true),\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t).then(success => {\n\t\t\t\tif (success) {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved source file\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Failed to save source file\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\t\topen: true\n          });\n          store.dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (checkViewFileId(this.props.currentOpenFileId) && this.props.currentOpenFileId.viewType !== NO_OPEN_FILE_ID.viewType) {\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tthis.props.currentOpenFileId.viewType,\n\t\t\t\tfalse,\n\t\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"View saved\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n          this.props.dispatchSetToastAction({\n            message: \"Failed to save view\",\n            severity: TOAST_SEVERITY.ERROR,\n            open: true\n          });\n          store.dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE });\n        });\n\t\t}\n\t}\n\t\n\thandleCancelModifyingTagFilters = () => {\n\t\tconst input = document.getElementById(TAG_FILTERS_INPUT_ID);\n\t\tinput.value = this.state.currentTagFiltersStr;\n\t\tthis.setState({ modifyingTagFilters: false });\n\t};\n\t\n\thandleStartModifyingTagFilters = () => {\n\t\tthis.setState({ modifyingTagFilters: true });\n\t\tdefer(() => {\n\t\t\tconst input = document.getElementById(TAG_FILTERS_INPUT_ID);\n\t\t\tinput.focus();\n\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t});\n\t};\n\t\n\thandleUnpersistCurrentTagFilters = () => {\n\t\tif (\n\t\t\t!this.state.currentTagFiltersStr ||\n\t\t\t!this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr)\n\t\t) { return false; }\n\t\tconst newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n\t\tdelete newSourceSavedTagFilters[this.state.currentTagFiltersStr];\n\t\tFileStorageSystemClient.doSetSourceSavedTagFilters(\n\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\tnewSourceSavedTagFilters,\n\t\t).then(success => {\n\t\t\tif (!success) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to set source saved tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n\t\t});\n\t};\n\t\n\thandlePersistNewSavedTagFilters = () => {\n\t\tif (\n\t\t\t!this.state.currentTagFiltersStr ||\n\t\t\tthis.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr)\n\t\t) { return false; }\n\t\tconst newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n\t\tnewSourceSavedTagFilters[this.state.currentTagFiltersStr] = this.state.currentParsedTagFiltersStr;\n\t\tFileStorageSystemClient.doSetSourceSavedTagFilters(\n\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\tnewSourceSavedTagFilters,\n\t\t).then(success => {\n\t\t\tif (!success) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to set source saved tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n\t\t});\n\t};\n\t\n\thandleApplyTagFilters = () => {\n\t\tlet tagFilters = null;\n\t\tconst tagFiltersStr = document.getElementById(TAG_FILTERS_INPUT_ID).value.trim();\n\t\tif (tagFiltersStr) {\n\t\t\ttagFilters = parseTagFilters(tagFiltersStr);\n\t\t\tif (!tagFilters) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Invalid tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = tagFiltersStr;\n\t\tconst parsedTagFiltersStr = JSON.stringify(tagFilters);\n\t\tconst oldParsedTagFiltersStr = this.state.currentParsedTagFiltersStr;\n\t\tthis.setState({ currentTagFiltersStr: tagFiltersStr, currentParsedTagFiltersStr: parsedTagFiltersStr });\n\t\tif (parsedTagFiltersStr === oldParsedTagFiltersStr) { return true; }\n\t\tif(BlockTaggingEditorExtension.editor !== undefined){\n\t\t\tBlockTaggingEditorExtension.editor.view.dispatch(\n\t\t\t\tBlockTaggingEditorExtension.editor.view.state.tr.setMeta(TagFilteringPluginKey, tagFilters)\n\t\t\t\t\t.setSelection(\n\t\t\t\t\t\ttagFilters\n\t\t\t\t\t\t\t? TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0)\n\t\t\t\t\t\t\t: Selection.atStart(BlockTaggingEditorExtension.editor.view.state.doc)\n\t\t\t\t\t).scrollIntoView()\n\t\t\t);\n\t\t\tdefer(() => {\n\t\t\t\tif (tagFilters) { BlockTaggingEditorExtension.editor.view.dom.blur(); }\n\t\t\t\telse { BlockTaggingEditorExtension.editor.view.focus(); }\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t};\n\t\n\tchangeFile = async () => {\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tFileStorageSystemClient.doGetSourceSavedTagFilters(this.props.currentOpenFileId.sourceId)\n\t\t\t\t.then(sourceSavedTagFilters => {\n\t\t\t\t\tif (!sourceSavedTagFilters) {\n\t\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\t\tmessage: \"Failed to retrieve source saved tag filters\",\n\t\t\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\t\t\topen: true\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet filters = {}\n\t\t\t\t\t\tsourceSavedTagFilters.forEach(element => {\n\t\t\t\t\t\t\tfilters[element] = element;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setState({sourceSavedTagFilters: filters});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile();\n\t};\n\t\n\tcomponentDidUpdate = prevProps => {\n\t\tif(this.props.currentOpenFileName.viewName === '' && prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId){\n\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = \"\";\n\t\t\tthis.handleApplyTagFilters();\n\t\t\tthis.setState({ sourceSavedTagFilters: {} });\n\t\t\tthis.changeFile();\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tconst noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n\t\tconst currentTagFiltersSaved =this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr);\n\t\treturn(\n\t\t\t<AppBar position=\"static\" class=\"custom-navbar\">\n\t\t\t\t<Toolbar>\n\t\t\t\t\t<img className={\"menuButton\"} src={require('../images/logo.png')} style={{width: \"40px\", marginRight: \"10px\"}} alt={\"MENU\"}/>\n\t\t\t\t\t<Typography variant=\"h5\" style={{fontFamily:\"Bungee\", color:\"#F5F0E1\"}}>\n\t\t\t\t\t\tYADA\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<div style={{flexGrow: 1, marginLeft: \"150px\"}}>\n\t\t\t\t\t\t{this.props.currentOpenFileName.sourceName === '' ? null :\n\t\t\t\t\t\t\t<Breadcrumbs aria-label=\"breadcrumb\" color=\"secondary\" style={{marginRight: \"10px\", float: \"left\", border:\"1px solid #F5F0E1\", borderRadius: \"10px\", padding: \"8px\"}}>\n\t\t\t\t\t\t\t\t<Link color=\"inherit\" style={{ color: \"#F5F0E1\",}}>\n\t\t\t\t\t\t\t\t\t<DescriptionIcon color=\"secondary\"/>\n\t\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.sourceName.length <= 11 ?  this.props.currentOpenFileName.sourceName : (this.props.currentOpenFileName.sourceName.substring(0,11) + \"...\")}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.viewName === '' ? null :\n\t\t\t\t\t\t\t\t\t<Link color=\"inherit\" style={{color: \"#F5F0E1\"}}>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t(this.props.currentOpenFileId.viewType === FILE_TYPE.CARD_VIEW) ?\n\t\t\t\t\t\t\t\t\t\t\t\t<AmpStoriesIcon color=\"secondary\"/>:\n\t\t\t\t\t\t\t\t\t\t\t\t(this.props.currentOpenFileId.viewType === FILE_TYPE.TEXT_VIEW) ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TextFieldsIcon color=\"secondary\"/> :\n\t\t\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.viewName}\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</Breadcrumbs>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\ttitle=\"save\"\n\t\t\t\t\t\t\tdisabled={noOpenFileIdCheck || !this.props.saveDirtyFlag}\n\t\t\t\t\t\t\tonClick={this.handleSave}\n\t\t\t\t\t\t\tstartIcon={<SaveIcon />}\n\t\t\t\t\t\t\tstyle= {{ borderRadius: \"10px\",paddingTop: \"8px\", paddingBottom: \"8px\", float: \"left\"}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.props.currentOpenFileName.viewName === '' ?\n\t\t\t\t\t\t\t\t<div style={{backgroundColor: \"rgba(245, 240, 225, 0.8)\", marginLeft: \"250px\", width: \"50vw\", borderRadius: \"10px\", padding: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t<Grid container>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={1}>\n\t\t\t\t\t\t\t\t\t\t\t<div style={{marginTop: \"3px\", marginLeft: \"20px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t<SearchIcon color=\"primary\"/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={10}>\n\t\t\t\t\t\t\t\t\t\t\t<Autocomplete\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.currentTagFiltersStr}\n\t\t\t\t\t\t\t\t\t\t\t\tid={TAG_FILTERS_INPUT_ID}\n\t\t\t\t\t\t\t\t\t\t\t\tfreeSolo\n\t\t\t\t\t\t\t\t\t\t\t\toptions={Object.entries(this.state.sourceSavedTagFilters)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map(([tagFiltersStr, _parsedTagFiltersStr]) => tagFiltersStr)}\n\t\t\t\t\t\t\t\t\t\t\t\trenderInput={(params) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...params}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search with Tags: ( #{tag1} | !( #{tag2} ) ) & #{tag3}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{margin:\"0%\"}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"standard\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(event, value, reason) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({currentTagFiltersStr : value});\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleStartModifyingTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (reason === 'clear'){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = '';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleApplyTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tonBlur={event => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (this.handleApplyTagFilters()) { this.setState({ modifyingTagFilters: false }); }\n\t\t\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst input = event.target;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefer(() => { input.focus(); });\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyDown={event => { if (event.key === 'Escape') { this.handleCancelModifyingTagFilters(); } }}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={1}>\n\t\t\t\t\t\t\t\t\t\t\t<div style={{float: \"right\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t{ (this.state.modifyingTagFilters) ? null :\n\t\t\t\t\t\t\t\t\t\t\t\t\t(this.state.currentTagFiltersStr === '') ? null :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(currentTagFiltersSaved) ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton title=\"Unpersist Filter\" style={{padding: \"0px\", paddingRight: \"10px\", paddingTop: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<RemoveCircleIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = \"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleUnpersistCurrentTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleApplyTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton> :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton title=\"Persist Filter\" style={{padding: \"0px\", paddingRight: \"10px\", paddingTop: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SaveIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handlePersistNewSavedTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\taria-label=\"account of current user\"\n\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\tstyle={{float: \"right\"}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AccountCircleIcon color=\"secondary\"/>\n\t\t\t\t\t</IconButton>\n\t\t\t\t</Toolbar>\n\t\t\t</AppBar>\n\t\t)\n\t}\n}\n\nexport default connect(\n\tstate => ({\n\t\tcurrentOpenFileId: state.currentOpenFileId,\n\t\tcurrentOpenFileName: state.currentOpenFileName,\n\t\tbackendModeSignedInStatus: state.backendModeSignedInStatus,\n\t\ttagsInView: state.tagsInView,\n\t\tsaveDirtyFlag: state.saveDirtyFlag\n\t}),\n\tdispatch => ({\n\t\tdispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(Navbar);\n","import React from 'react';\nimport RichMarkdownEditor from 'rich-markdown-editor';\nimport BootstrapCard from 'react-bootstrap/Card';\nimport ReactCardFlip from 'react-card-flip';\n\nclass Card extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tisFlipped: false,\n\t\t\tkey: this.props.content[\"index\"],\n\t\t\tfront: this.props.content[\"front\"],\n\t\t\tback: this.props.content[\"back\"]\n\t\t};\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.createBootstrapCard = this.createBootstrapCard.bind(this);\n\t}\n\t\n\thandleClick(e) {\n\t\te.preventDefault();\n\t\tthis.setState(prevState => ({ isFlipped: !prevState.isFlipped }));\n\t}\n\t\n\tcreateBootstrapCard(key, json) {\n\t\treturn (\n\t\t\t<BootstrapCard\n\t\t\t\tkey={key}\n\t\t\t\ttext=\"black\"\n\t\t\t\tclassName=\"BootstrapCard\"\n\t\t\t\tonClick={this.handleClick}\n\t\t\t>\n\t\t\t\t{\n\t\t\t\t\tjson &&\n\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\tclassName=\"Card\"\n\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\tkey={`card${key}`}\n\t\t\t\t\t\tdefaultValue={JSON.stringify(json)}\n\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</BootstrapCard>\n\t\t);\n\t}\n\t\n\trender = () => {\n\t\tconst content = this.props.content;\n\t\tif (content !== undefined) {\n\t\t\tconst key = content[\"index\"];\n\t\t\tconst front = content[\"front\"];\n\t\t\tconst back = content[\"back\"];\n\t\t\treturn (\n\t\t\t\t<ReactCardFlip isFlipped={this.state.isFlipped} flipDirection=\"vertical\">\n\t\t\t\t\t{this.createBootstrapCard(key, front)}\n\t\t\t\t\t{this.createBootstrapCard(key, back)}\n\t\t\t\t</ReactCardFlip>\n\t\t\t);\n\t\t} else { return null; }\n\t};\n}\n\nexport default Card;\n","import React from 'react';\nimport Carousel from 'react-material-ui-carousel'\nimport Typography from '@material-ui/core/Typography';\nimport ShuffleIcon from '@material-ui/icons/Shuffle';\nimport Chip from '@material-ui/core/Chip';\n\nclass StudyView extends React.Component {\n    state = {\n        currentNumber : 0,\n        startIndex: 0,\n        cards: this.props.cards\n    }\n\n    shuffleCards = () => {\n        let shuffledCards = this.state.cards;\n        let i = shuffledCards.length - 1;\n        while(i > 0){\n            const j = Math.floor(Math.random() * i)\n            const temp = shuffledCards[i]\n            shuffledCards[i] = shuffledCards[j]\n            shuffledCards[j] = temp\n            i--\n        }\n        this.setState({cards: shuffledCards, startIndex: 3});\n    }\n\n    render = () => \n       <div>\n        <Carousel\n            navButtonsAlwaysVisible = {true}\n            indicators={false}\n            animation=\"slide\"\n            autoPlay = {false}\n            interval= {10000}\n            index={this.state.startIndex}\n            next = {() => {this.setState({currentNumber: ((this.state.currentNumber + 1) % this.state.cards.length)})}}\n            prev = {() => {this.setState({currentNumber: ((this.state.currentNumber - 1) % this.state.cards.length)})}}\n        >\n            {this.state.cards.map((card, i) => <div>{card}</div>)}\n        </Carousel>\n        <div style={{display: \"flex\", flexDirection: \"row\", flexWrap: \"nowrap\", justifyContent: \"space-between\"}}>\n                <div /> \n                <Typography variant=\"h6\" style={{color:\"#1E3D59\"}}>\n                    {this.state.currentNumber + 1}/{this.state.cards.length}\n                </Typography>\n                <Chip\n                    label=\"Shuffle\"\n                    clickable\n                    color=\"primary\"\n                    onDelete={this.shuffleCards}\n                    onClick={this.shuffleCards}\n                    deleteIcon={<ShuffleIcon />}\n                    variant=\"outlined\"\n                />\n        </div>\n        </div>\n};\n\nexport default StudyView;","import styled from 'styled-components'\nimport React from 'react';\nimport {Droppable, Draggable} from 'react-beautiful-dnd';\nimport {THEME} from \"../../App\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport {TAG_HOLDERS} from \"./TagEditor\";\n\nclass Tag extends React.Component {\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-bottom: 8px;\n\t\t\tbackground-color: ${props => (props.isDragging ? THEME.palette.secondary.dark : THEME.palette.secondary.light)};\n\t\t`;\n\t\tconst TagId = styled.h5``;\n\t\tconst Content = styled.div``\n\t\treturn (\n\t\t\t<Draggable draggableId={this.props.tagId} index={this.props.index}>\n\t\t\t\t{(provided, snapshot) => (\n\t\t\t\t\t<Container\n\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t{...provided.draggableProps}\n\t\t\t\t\t\t{...provided.dragHandleProps}\n\t\t\t\t\t\tisDragging={snapshot.isDragging}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TagId>{this.props.tagInfo[\"tag_name\"]}</TagId>\n\t\t\t\t\t\t<Content>{this.props.tagInfo.preview}</Content>\n\t\t\t\t\t</Container>\n\t\t\t\t)}\n\t\t\t</Draggable>\n\t\t);\n\t};\n}\n\nclass InnerTagList extends React.Component {\n\t// performance optimization to prevent unnecessary renders\n\tshouldComponentUpdate(nextProps, nextState, nextContext) {\n\t\treturn nextProps.tagData !== this.props.tagData;\n\t}\n\t\n\trender() {\n\t\tconsole.log(this.props);\n\t\tconst tagList = [];\n\t\tconst tagIds = Object.keys(this.props.tagData);\n\t\tfor (let i = 0; i < tagIds.length; ++i) {\n\t\t\tconst tagId = tagIds[i];\n\t\t\ttagList.push(<Tag key={tagId} tagId={tagId} index={i} tagInfo={this.props.tagData[tagId]}/>);\n\t\t\tif (this.props.viewType === FILE_TYPE.CARD_VIEW && this.props.columnId === TAG_HOLDERS.IN_VIEW) {\n\t\t\t\tif (i % 2 === 1 && i !== tagIds.length-1) {\n\t\t\t\t\ttagList.push(\n\t\t\t\t\t\t<hr style={{ color: THEME.palette.primary.main, backgroundColor: THEME.palette.primary.main, height: 1 }} />\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tagList;\n\t}\n}\n\nclass DragDropColumn extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// used to maintain scroll when rendering updates to tag list\n\t\tthis.tagListRef = React.createRef();\n\t}\n\t\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\tconst list = this.tagListRef.current;\n\t\treturn list.scrollHeight - list.scrollTop;\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot !== null) {\n\t\t\tconst list = this.tagListRef.current;\n\t\t\tlist.scrollTop = list.scrollHeight - snapshot;\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-top: 10px;\n\t\t\tmargin-bottom: 10px;\n\t\t\ttransition: background-color 0.2s ease;\n\t\t\tbackground-color: ${props => (props.isDraggingOver) ? THEME.palette.grey[300] : THEME.palette.grey[100]};\n\t\t`;\n\t\tconst Title = styled.h3`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst DroppableRegion = styled.div`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst TagList = styled.div`\n\t\t\toverflow-x: hidden;\n\t\t\toverflow-y: auto;\n\t\t\theight: 200px;\n\t\t\tpadding-bottom: 30px;\n\t\t`;\n\n\t\treturn (\n\t\t\t<Droppable droppableId={this.props.column.id}>\n\t\t\t\t{(provided, snapshot) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Container isDraggingOver={snapshot.isDraggingOver}>\n\t\t\t\t\t\t\t<Title>{this.props.column.title}</Title>\n\t\t\t\t\t\t\t\t<DroppableRegion\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<TagList ref={this.tagListRef}>\n\t\t\t\t\t\t\t\t\t\t<InnerTagList viewType={this.props.viewType} columnId={this.props.column.id} tagData={this.props.tagData}/>\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\n\t\t\t\t\t\t\t\t\t</TagList>\n\t\t\t\t\t\t\t\t</DroppableRegion>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</Droppable>\n\t\t);\n\t};\n}\n\nexport default DragDropColumn;\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport DragDropColumn from './DragDropColumn';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport {DragDropContext} from 'react-beautiful-dnd';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport {SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\n\nexport const TAG_HOLDERS = {\n\tAVAILABLE: \"tags_available\",\n\tIN_VIEW: \"tags_in_view\"\n}\n\nclass TagEditor extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\n\t\t// parse nodes to obtain preview\n\t\tfunction getPreview(node) {\n\t\t\tfor (let i = 0; i < node.content.length; ++i) {\n\t\t\t\tconst contentNode = node.content[i];\n\t\t\t\tif (contentNode.type === \"text\") {\n\t\t\t\t\treturn contentNode.text;\n\t\t\t\t} else if (contentNode) {\n\t\t\t\t\tconst recurseResponse = getPreview(contentNode);\n\t\t\t\t\tif (recurseResponse !== \"\") return recurseResponse;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t}\n\t\t\n\t\tconst tagData = this.props.allTagsData;\n\t\tObject.keys(tagData).forEach(tagId => {\n\t\t\tconst preview = getPreview(tagData[tagId].content);\n\t\t\tconst maxPreviewLength = 50;\n\t\t\ttagData[tagId][\"preview\"] = preview.substring(0, maxPreviewLength);\n\t\t\tif (preview.length > maxPreviewLength) {\n\t\t\t\ttagData[tagId][\"preview\"] += \" . . .\";\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.state = {\n\t\t\ttagData: tagData,\n\t\t\tcolumns: {\n\t\t\t\ttags_in_view: {\n\t\t\t\t\tid: TAG_HOLDERS.IN_VIEW,\n\t\t\t\t\ttitle: \"Tags in View\",\n\t\t\t\t\ttagIds: this.props.tagsInView\n\t\t\t\t},\n\t\t\t\ttags_available: {\n\t\t\t\t\tid: TAG_HOLDERS.AVAILABLE,\n\t\t\t\t\ttitle: \"Available Tags\",\n\t\t\t\t\ttagIds: availableTags\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumnOrder: ['tags_in_view', 'tags_available']\n\t\t};\n\t}\n\t\n\tonDragEnd = result => {\n\t\tconst { destination, source, draggableId } = result;\n\t\tif (!destination) return;\n\t\tif (destination.droppableId === source.droppableId && destination.index === source.index) return;\n\t\t\n\t\tlet newState = {}\n\t\tif (destination.droppableId === source.droppableId) {\n\t\t\tconst column = this.state.columns[source.droppableId]\n\t\t\tconst newTagIds = Array.from(column.tagIds);\n\t\t\tnewTagIds.splice(source.index, 1);\n\t\t\tnewTagIds.splice(destination.index, 0, draggableId)\n\t\t\t\n\t\t\tconst newColumn = {\n\t\t\t\t...column,\n\t\t\t\ttagIds: newTagIds\n\t\t\t}\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newColumn.id]: newColumn\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tconst start = this.state.columns[source.droppableId];\n\t\t\tconst finish = this.state.columns[destination.droppableId];\n\t\t\tconst startTagIds = Array.from(start.tagIds);\n\t\t\tstartTagIds.splice(source.index, 1);\n\t\t\tconst newStart = {\n\t\t\t\t...start,\n\t\t\t\ttagIds: startTagIds\n\t\t\t};\n\t\t\t\n\t\t\tconst finishTagIds = Array.from(finish.tagIds);\n\t\t\tfinishTagIds.splice(destination.index, 0, draggableId);\n\t\t\tconst newFinish = {\n\t\t\t\t...finish,\n\t\t\t\ttagIds: finishTagIds\n\t\t\t};\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newStart.id]: newStart,\n\t\t\t\t\t[newFinish.id]: newFinish\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis.props.setTagsInView(newState.columns.tags_in_view.tagIds);\n\t\tthis.setState(newState);\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tif (!this.props.saveDirtyFlag) { this.props.dispatchSetSaveDirtyFlagAction(); }\n\t\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\tconst newState = Object.assign({}, this.state);\n\t\t\tnewState.columns.tags_in_view.tagIds = tagsInView;\n\t\t\tnewState.columns.tags_available.tagIds = availableTags;\n\t\t\tthis.setState(newState);\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\treturn (\n\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\n\t\t\t\t<Container>\n\t\t\t\t\t<Row className=\"justify-content-md-center\">\n\t\t\t\t\t\t{this.state.columnOrder.map(columnId => {\n\t\t\t\t\t\t\tconst column = this.state.columns[columnId];\n\t\t\t\t\t\t\t// Generate subdict here\n\t\t\t\t\t\t\tlet tagDataInColumn = {};\n\t\t\t\t\t\t\tfor (const tagId of column.tagIds) {\n\t\t\t\t\t\t\t\ttagDataInColumn[tagId] = this.state.tagData[tagId];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Col key={column.id} md=\"12\" lg=\"6\">\n\t\t\t\t\t\t\t\t\t<DragDropColumn\n\t\t\t\t\t\t\t\t\t\tviewType={this.props.viewType}\n\t\t\t\t\t\t\t\t\t\tkey={column.id}\n\t\t\t\t\t\t\t\t\t\tcolumn={column}\n\t\t\t\t\t\t\t\t\t\ttagData={tagDataInColumn}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</DragDropContext>\n\t\t);\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, saveDirtyFlag: state.saveDirtyFlag }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE })\n\t}),\n)(TagEditor);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './CardDeck.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from './Card';\nimport StudyView from './StudyView';\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport {setToastAction, TOAST_SEVERITY} from \"../../reducers/Toast\";\nimport store from \"../../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Switch from '@material-ui/core/Switch';\n\nclass CardDeck extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t\tstudySwitch: false,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.CARD_VIEW,\n\t\t\t\tfalse,\n\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved view\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => this.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to save view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t}));\n\t\t}\n\t};\n\t\n\tconstructDoc = (tagId) => {\n\t\tconst node = this.state.allTagsData[tagId][\"content\"];\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": [node]\n\t\t};\n\t};\n\t\n\tconstructCard = (index) => {\n\t\tconst cardContent = { \"index\": index };\n\t\tcardContent[\"front\"] = this.constructDoc(this.props.tagsInView[index]);\n\t\tif (index + 1 < this.props.tagsInView.length) {\n\t\t\tcardContent[\"back\"] = this.constructDoc(this.props.tagsInView[index+1]);\n\t\t} else { cardContent[\"back\"] = null; }\n\t\treturn <Card content={cardContent} />;\n\t};\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Card Deck ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\tconst cards = [];\n\t\t\tif(this.state.studySwitch) {\n\t\t\t\tfor (let i = 0; i < this.props.tagsInView.length; i+=2) {\n\t\t\t\t\tcards.push(this.constructCard(i));\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tfor (let i = 0; i < this.props.tagsInView.length; i+=4) {\n\t\t\t\t\tcards.push(\n\t\t\t\t\t\t<Row key={`row_${i%4}`} className=\"justify-content-md-center\">\n\t\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t\t{this.constructCard(i)}\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t\t{(i + 2 < this.props.tagsInView.length) && this.constructCard(i + 2)}\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<FormControlLabel\n\t\t\t\t\t\tcontrol={\n\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\tchecked={this.state.studySwitch}\n\t\t\t\t\t\t\tonChange={() => {this.setState({studySwitch: !this.state.studySwitch})}}\n\t\t\t\t\t\t\tname=\"checkedB\"\n\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabel=\"Study Mode\"\n\t\t\t\t\t/>\n\t\t\t\t\t{this.state.studySwitch ? <StudyView cards={cards}/> : \n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<TagEditor viewType={FILE_TYPE.CARD_VIEW} allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t\t\t{cards}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(CardDeck);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './TextView.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport RichMarkdownEditor from \"rich-markdown-editor\";\nimport {setToastAction, TOAST_SEVERITY} from \"../../reducers/Toast\";\nimport store from \"../../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\n\n\nclass TextView extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.TEXT_VIEW,\n\t\t\t\tfalse,\n\t\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved view\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => this.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to save view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t}));\n\t\t}\n\t};\n\t\n\tconstructTextView = () => {\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": this.props.tagsInView.map(t => this.state.allTagsData[t][\"content\"])\n\t\t};\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Text View ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<TagEditor viewType={FILE_TYPE.TEXT_VIEW} allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.props.tagsInView.length > 0 &&\n\t\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\t\tclassName=\"TextViewEditor\"\n\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\tkey={\"text_view\"}\n\t\t\t\t\t\t\tdefaultValue={JSON.stringify(this.constructTextView())}\n\t\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(TextView);\n","import './ViewEditor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {\n\tFILE_TYPE,\n\tNO_OPEN_FILE_ID\n} from \"../util/FileIdAndTypeUtils\";\nimport FileStorageSystemClient from \"../backend/FileStorageSystemClient\";\nimport {handleSetCurrentOpenFileId} from \"./Navigator\";\nimport CardDeck from \"./CardView/CardDeck\";\nimport TextView from \"./TextView/TextView\";\nimport {setTagsInViewAction} from \"../reducers/SetTagsInView\";\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\n\nconst DEFAULT_STATE = {\n\tsourceId: 0,\n\tviewId: 0,\n\tdata: null,\n\tfileType: FILE_TYPE.EMPTY\n};\n\nclass ViewEditor extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = async () => {\n\t\tFileStorageSystemClient.doGetView(this.props.currentOpenFileId).then(value => {\n\t\t\tif (value === null) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to retrieve view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t})\n\t\t\t\thandleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n\t\t\t} else {\n\t\t\t\tthis.props.setTagsInView([]); // clear any tagsInView currently stored\n\t\t\t\tthis.setState({\n\t\t\t\t\tsourceId: this.props.currentOpenFileId.sourceId,\n\t\t\t\t\tviewId: this.props.currentOpenFileId.viewId,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttagsInView: value[\"view\"][\"order\"],\n\t\t\t\t\t\tallTagsData: value[\"tags\"][\"items\"]\n\t\t\t\t\t},\n\t\t\t\t\tfileType: this.props.currentOpenFileId.viewType\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile().then(() => console.log(\"Mounted view file\"));\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile().then(() => console.log(\"Updated view file\"));\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tif (this.state.fileType === FILE_TYPE.CARD_VIEW) {\n\t\t\treturn <CardDeck data={this.state.data}/>;\n\t\t} else if (this.state.fileType === FILE_TYPE.TEXT_VIEW) {\n\t\t\treturn <TextView data={this.state.data}/>;\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default connect(\n\tstate => ({ currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(ViewEditor);\n\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport SourceEditorWithTagFilters from \"./SourceEditorWithTagFiltersInput\";\nimport {\n\tcheckSourceFileId,\n\tcheckViewFileId,\n\tFILE_TYPE,\n} from \"../util/FileIdAndTypeUtils\";\nimport ViewEditor from \"./ViewEditor\";\n\nconst DEFAULT_STATE = {\n\tfileType: FILE_TYPE.EMPTY,\n};\n\nclass EditorManager extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = () => {\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.SOURCE});\n\t\t} else if (checkViewFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.CARD_VIEW});\n\t\t} else {\n\t\t\tthis.setState({fileType: FILE_TYPE.EMPTY});\n\t\t}\n\t};\n\t\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile();\n\t};\n\t\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile();\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\treturn (\n\t\t\t<div className=\"MainPane\">\n\t\t\t\t<div className=\"editor_container\">\n\t\t\t\t\t{\n\t\t\t\t\t\t(this.state.fileType === FILE_TYPE.EMPTY) ?\n\t\t\t\t\t\t\t<div className=\"placeholder_editor\">\n\t\t\t\t\t\t\t\t<h5>Click or create a new document from the left pane</h5>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t:\n\t\t\t\t\t\t(this.state.fileType === FILE_TYPE.SOURCE) ?\n\t\t\t\t\t\t\t<SourceEditorWithTagFilters /> : <ViewEditor/>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n};\n\nexport default connect(state => ({ currentOpenFileId: state.currentOpenFileId, currentOpenFileName: state.currentOpenFileName }))(EditorManager);\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport ReactTypingEffect from 'react-typing-effect';\n\nexport default class MobilePage extends React.Component {\n\trender = () =>\n\t\t<div style={{display:\"flex\", flexFlow: \"column\", height: \"100vh\", overflow: \"hidden\"}}>\n\t\t\t<div style={{backgroundColor: \"#F5F0E1\", flex: \"1 1 auto\", display:\"flex\"}}>\n\t\t\t\t<Grid container alignItems=\"center\">\n\t\t\t\t\t<Grid container alignItems=\"center\">\n\t\t\t\t\t\t<Grid item xs={1}/>\n\t\t\t\t\t\t<Grid item xs={10}>\n\t\t\t\t\t\t\t<Typography variant=\"h1\" align=\"center\" className={\"title\"} style={{fontFamily:\"Bungee\", color:\"#1E3D59\"}}>\n\t\t\t\t\t\t\t\tYADA\n\t\t\t\t\t\t\t\t<ReactTypingEffect\n\t\t\t\t\t\t\t\t\ttext = \"\"\n\t\t\t\t\t\t\t\t\tstyle={{fontFamily:\"Signika\"}}\n\t\t\t\t\t\t\t\t\tspeed = {10000}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t<Typography variant=\"h4\" align=\"center\" className={\"title\"} style={{fontFamily:\"Signika\", color:\"#1E3D59\"}}>\n\t\t\t\t\t\t\t\tYet Another Docs App\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={1}/>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t\n\t\t\t\t\t<Grid container alignItems=\"center\">\n\t\t\t\t\t\t<Grid item xs={1}/>\n\t\t\t\t\t\t<Grid item xs={10}>\n\t\t\t\t\t\t\t<Typography variant=\"h5\" align=\"center\" style={{fontFamily:\"Signika\", color:\"#1E3D59\"}}>\n\t\t\t\t\t\t\t\tOops! <br/>\n\t\t\t\t\t\t\t\tSeems like we cannot display content for this screen width. <br/>\n\t\t\t\t\t\t\t\tYADA works best on desktops!\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={1}/>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t\n\t\t\t\t\t<Grid container alignItems=\"center\">\n\t\t\t\t\t\t<Grid item xs={2}/>\n\t\t\t\t\t\t<Grid item xs={8} alignItems=\"center\">\n\t\t\t\t\t\t\t<img src={require('../images/graphic.png')} style={{width: \"100%\"}} alt={\"Document Graphic\"}/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={2}/>\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>\n\t\t\t</div>\n\t\t</div>\n}\n","import './App.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from './reducers/BackendModeSignedInStatus';\nimport LandingPage from './components/LandingPage';\nimport Navigator from './components/Navigator';\nimport Navbar from './components/Navbar';\nimport EditorManager from \"./components/EditorManager\";\nimport \"./components/LandingPage.css\"\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport {setToastAction, TOAST_CLEAR, TOAST_DURATION_MS} from \"./reducers/Toast\";\nimport MobilePage from \"./components/MobilePage\";\n\nexport const THEME = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#1E3D59'\n    },\n    secondary: {\n      main: '#F5F0E1'\n    }\n  }\n});\n\nclass App extends React.Component {\n\n  state = {\n    mounted: false,\n    width: window.innerWidth\n  };\n\n  handleCloseToast = () => {\n    this.props.dispatchSetToastAction(TOAST_CLEAR);\n  }\n  \n  handleWindowSizeChange = () => {\n    this.setState({ width: window.innerWidth });\n  };\n  \n  componentWillMount() {\n    window.addEventListener('resize', this.handleWindowSizeChange);\n  }\n  \n  // make sure to remove the listener\n  // when the component is not mounted anymore\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.handleWindowSizeChange);\n  }\n  \n  componentDidMount = () => {\n    if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      getUserSignedInStatus().then(backendModeSignedInStatus => {\n        this.props.dispatchSetBackendModeSignedInStatusAction(backendModeSignedInStatus);\n        this.setState({ mounted: true });\n      });\n    } else { this.setState({ mounted: true }); }\n  };\n  \n  render = () =>\n    <MuiThemeProvider theme={THEME}>\n    <React.Fragment>\n      {\n        (this.state.width <= 500) // check if we can display YADA\n            ? <MobilePage/>\n            : (this.state.mounted\n                ? (\n                    this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                      ? <div className=\"App\">\n                          <div style={{flex: \"0 1 auto\"}}>\n                            <Navbar />\n                          </div>\n                            <div style={{flex: \"1 1 auto\", display: \"flex\"}}>\n                              <div style={{float: \"left\"}}>\n                                  <Navigator />\n                              </div>\n                              <div style={{flexGrow: \"100\"}}>\n                                  <EditorManager/>\n                              </div>\n                              {/*Global Snackbar: used for display toast messages to user*/}\n                              <Snackbar open={this.props.toast.open} autoHideDuration={TOAST_DURATION_MS} onClose={this.handleCloseToast}>\n                                <MuiAlert onClose={this.handleCloseToast} elevation={6} severity={this.props.toast.severity}>\n                                  {this.props.toast.message}\n                                </MuiAlert>\n                              </Snackbar>\n                            </div>\n                          </div>\n                      : <LandingPage />\n                  )\n                : null)\n      }\n    </React.Fragment>\n    </MuiThemeProvider>\n};\n\nexport default connect(\n  state => ({\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n    currentOpenFileId: state.currentOpenFileId,\n    currentOpenFileName: state.currentOpenFileName,\n    toast: state.toast,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: {'Service-Worker': 'script'},\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport {render} from 'react-dom';\nimport {Provider} from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport store from './store';\nimport * as serviceWorker from './serviceWorker';\n\nrender(\n  <React.StrictMode>\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap\" />\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" />\n    <link href=\"https://fonts.googleapis.com/css2?family=Bungee&display=swap\" rel=\"stylesheet\" /> \n    <link href=\"https://fonts.googleapis.com/css2?family=Signika:wght@300&display=swap\" rel=\"stylesheet\"></link>\n    <Provider store={store}>\n      <App/>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}