{"version":3,"sources":["images/logo.png","images/darkLogo.png","images/graphic.png","util/FetchWithTimeout.js","reducers/BackendModeSignedInStatus.js","components/LandingPage.js","util/FileIdAndTypeUtils.js","util/ConvertStrValueOrDefault.js","reducers/CurrentOpenFileState.js","reducers/SetTagsInView.js","reducers/Toast.js","store.js","editor_extension/plugins/SelectNode.js","editor_extension/plugins/TagFiltering.js","editor_extension/plugins/CancelLineBreaks.js","editor_extension/BlockTagging.js","components/TagMenu.js","components/Editor.js","backend/LocalFileStorageSystemClient.js","backend/HostedFileStorageSystemClient.js","backend/FileStorageSystemClient.js","components/SourceEditorWithTagFiltersInput.js","components/Navigator.js","lib/TagFiltersGrammar.js","components/Navbar.js","components/CardView/Card.js","components/ViewComponents/DragDropColumn.js","components/ViewComponents/TagEditor.js","components/CardView/CardDeck.js","components/TextView/TextView.js","components/ViewEditor.js","components/EditorManager.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","fetchWithTimeout","uri","options","a","time","controller","AbortController","setTimeout","abort","fetch","signal","then","response","ok","console","log","SERVER_BASE_URL","BACKEND_MODE_SIGNED_IN_STATUS","USER_SIGNED_IN","USER_SIGNED_OUT","LOCAL_STORAGE","getUserSignedInStatus","token","Cookies","get","headers","Headers","setBackendModeSignedInStatusAction","status","type","CLIENT_ID","LandingPage","handleLoginSuccess","profileObj","name","email","tokenObj","id_token","expiry","expiresAt","axios","post","method","body","JSON","stringify","withCredentials","set","expires","Date","props","dispatchSetBackendModeSignedInStatusAction","render","style","display","flexFlow","height","overflow","className","flexGrow","AppBar","position","class","Toolbar","src","require","width","marginRight","alt","backgroundColor","flex","Grid","container","spacing","alignItems","item","xs","marginLeft","Typography","variant","fontFamily","color","text","speed","clientId","buttonText","onSuccess","onFailure","cookiePolicy","responseType","float","Button","onClick","React","Component","connect","state","backendModeSignedInStatus","dispatch","mode","FILE_TYPE","SOURCE","TEXT_VIEW","CARD_VIEW","EMPTY","NO_OPEN_FILE_ID","sourceId","viewId","viewType","validateFileIdObj","fileId","hasOwnProperty","validateHasFileIdObj","validateHasFileNameObj","fileName","checkNoOpenFileId","checkSourceFileId","checkViewFileId","getFileIdKeyStr","convertStrValueOrDefault","valueStr","defaultValue","failureMessage","convertFromString","parse","value","e","convertStrValueOrDefaultIfFalsy","storedInitialFileId","localStorage","getItem","storedInitialFileName","initialFileId","initialFileName","sourceName","viewName","setCurrentOpenFileIdAction","setCurrentOpenFileNameAction","setSelectNodeAction","selectNode","setTagsInViewAction","tagsInView","setToastAction","toast","TOAST_SEVERITY","DEFAULT_STATE","message","severity","open","configureStore","reducer","combineReducers","currentOpenFileId","action","currentOpenFileName","saveDirtyFlag","setItem","removeItem","SelectNodePluginKey","PluginKey","Plugin","key","init","apply","tr","_value","oldState","head","selection","newState","doc","nodesBetween","node","pos","attrs","eq","store","decorations","selectDecorations","getState","push","Decoration","nodeSize","DecorationSet","create","TagFilteringPluginKey","evaluateTagFilters","tagFilters","parentTags","match","taggable","nodeTags","matchTagFilters","tags","Array","isArray","length","match1","isTextblock","cumulativeChildSize","i","childCount","child","childMatch","v","val","getMeta","undefined","filterDecorations","CancelLineBreaksPluginKey","filterTransaction","steps","every","step","toJSON","stepType","slice","content","some","isLeaf","checkInsertLineBreakReplaceStep","from","to","fromNode","nodeAt","toNode","checkRemoveLineBreakReplaceStep","CancelLineBreaksPlugin","SelectNodePlugin","TagFilteringPlugin","Extension","TAG_VALUE_REGEX","INVALID_TAG_VALUE_REGEX","TagMenu","selectNodeAttrs","modifying","handleAddTag","tag","document","getElementById","trim","test","dispatchSetToastAction","newSelectNodeAttrs","uuidv4","BlockTaggingEditorExtension","editor","view","setNodeMarkup","setState","dispatchSetSaveDirtyFlagAction","handleDeleteTag","handleModifyTagValue","oldTagValue","newTagValue","handleCancelModifyTagValue","input","setSelectionRange","handleStartModifyingTagValue","defer","focus","componentDidUpdate","prevProps","id","title","placeholder","disabled","onKeyPress","event","target","preventDefault","onKeyDown","Object","keys","map","onBlur","blur","hidden","Editor","noOpenFileIdCheck","extensions","fileIdKeyStr","fileContent","jsonStrValue","setSelection","TextSelection","onChange","doSetLocalStorageSourceViews","sourceViews","doGetLocalStorageSourceViews","doSetLocalStorageSourceIdNames","sourceIdNames","calculateLocalStorageNextNewId","existingIdsDict","candidate","toString","calculateLocalStorageNextNewFileIds","filesList","source","nextNewViewIdsForSourceIds","fromEntries","entries","views","doGetFilesList","doSaveViewSpec","tagsList","createNew","viewSpecLocalStorageKey","doGetView","doGetSourceTaggedBlocks","sourceContentDocStr","sourceContentDoc","sourceTaggedBlocks","nodes","shift","tagId","doSaveSourceContent","saveValue","sourceContentLocalStorageKey","doGetSourceContent","doSetSourceSavedTagFilters","sourceSavedTagFilters","sourceSavedTagFiltersLocalStorageKey","doGetSourceSavedTagFilters","doDeleteView","doDeleteSource","localStorageSourceViewIds","doRenameView","doRenameSource","EMPTY_SOURCE_CONTENT","json","viewID","Error","viewResponse","tagResponse","view_json","tags_json","filters","getFileStorageSystemClient","LocalFileStorageSystemClient","HostedFileStorageSystemClient","clientInterface","reduce","partial","fileStorageSystemClient","SourceEditorWithTagFiltersInput","keydownHandler","window","navigator","platform","metaKey","ctrlKey","keyCode","FileStorageSystemClient","success","changeFile","focusAtStart","handleSetCurrentOpenFileId","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","confirm","batch","convertFilesListStateToFileIdNamesList","filesListState","countNumFiles","count","RENAME_INPUT_TYPES","getRenameInputIdFunctions","NO_RENAMING_STATE","inputType","searching","renaming","nextNewFileIds","selectedFileId","selectedViewId","selectedFileOpen","editMenuAnchorElement","renameSelected","newViewAnchorElement","FileListItem","selected","padding","IconButton","InputBase","Divider","orientation","handleEditMenuClick","fontSize","border","childViewsExist","Navigator","resetState","getSourceName","getViewName","getFileName","getRenameInputValueFunctions","handleSwitchBackendModeSignedInStatus","handleCancelRenaming","handleClearSearchingInput","handleChangeSearchingInput","handleDoFileNamesSearch","filter","includes","handleCreateNewFile","fileType","sourceFileType","localStorageNextNewFileId","newFilePromise","newFile","updatedSourceId","newFilesList","parseInt","handleDeleteFile","sourceFileIdCheck","deleteFilePromise","newSourceViews","newNextNewViewIdsForSourceIds","handleRenameFile","newName","renameFilePromise","prevState","filesListValue","renameInput","remainingProps","inputId","handleFileListClick","handleViewListClick","currentTarget","handleEditMenuClose","handleDeleteMenuClick","handleRenameMenuClick","renamePopoverElement","handleRenamePopoverClose","handleViewMenuOpen","handleViewMenuClose","numFiles","filteredFilesList","numFilteredFiles","endIcon","disableElevation","Input","startAdornment","InputAdornment","debounce","List","component","aria-labelledby","subheader","ListSubheader","ListItem","button","disableGutters","divider","Collapse","in","timeout","unmountOnExit","disablePadding","Menu","anchorEl","keepMounted","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","MenuItem","ListItemIcon","ListItemText","primary","Popover","endAdornment","disableUnderline","fullWidth","remove","x","Grammar","Lexer","ParserRules","symbols","postprocess","literal","d","join","concat","ParserStart","inputText","outputParsedExpr","parser","nearley","Parser","fromCompiled","feed","results","ex","modifyingTagFilters","currentTagFiltersStr","currentParsedTagFiltersStr","Navbar","handleSave","catch","handleCancelModifyingTagFilters","handleStartModifyingTagFilters","handleUnpersistCurrentTagFilters","newSourceSavedTagFilters","handlePersistNewSavedTagFilters","handleApplyTagFilters","tagFiltersStr","parseTagFilters","parsedTagFiltersStr","oldParsedTagFiltersStr","setMeta","Selection","atStart","scrollIntoView","dom","forEach","element","currentTagFiltersSaved","Breadcrumbs","aria-label","borderRadius","Link","substring","startIcon","paddingTop","paddingBottom","marginTop","Autocomplete","freeSolo","renderInput","params","TextField","margin","reason","paddingRight","edge","aria-haspopup","Card","front","back","isFlipped","flipDirection","createBootstrapCard","handleClick","bind","this","readOnly","Tag","Container","styled","div","isDragging","THEME","palette","secondary","dark","light","TagId","h5","Content","draggableId","index","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","tagInfo","preview","InnerTagList","nextProps","nextState","nextContext","tagData","tagList","tagIds","columnId","TAG_HOLDERS","IN_VIEW","main","DragDropColumn","isDraggingOver","grey","Title","h3","DroppableRegion","TagList","droppableId","column","droppableProps","tagListRef","createRef","list","current","scrollHeight","scrollTop","AVAILABLE","TagEditor","onDragEnd","result","destination","columns","newTagIds","splice","newColumn","start","finish","startTagIds","newStart","finishTagIds","newFinish","setTagsInView","tags_in_view","Row","columnOrder","tagDataInColumn","Col","md","lg","Set","availableTags","allTagsData","t","has","getPreview","contentNode","recurseResponse","tags_available","assign","CardDeck","constructDoc","constructCard","cardContent","cards","xl","data","TextView","constructTextView","ViewEditor","EditorManager","createMuiTheme","App","mounted","handleCloseToast","theme","Fragment","Snackbar","autoHideDuration","elevation","location","hostname","StrictMode","rel","href","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.d00d94cc.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e9d28ab1.png\";","module.exports = __webpack_public_path__ + \"static/media/darkLogo.eccc7628.png\";","module.exports = __webpack_public_path__ + \"static/media/graphic.2ab501e2.png\";","export const fetchWithTimeout = async (uri, options, time = 7500) => {\n  const controller = new AbortController();\n  setTimeout(() => { controller.abort(); }, time);\n  return await fetch(uri, { ...options, signal: controller.signal }).then((response) => {\n    if (!response.ok) { console.log(response); }\n    return response\n  });\n};\n","import Cookies from 'js-cookie';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\n\nexport const SERVER_BASE_URL = process.env.NODE_ENV === 'development'\n  ? \"http://localhost:5000/\" : \"https://yaas-gca4j5hw3q-uc.a.run.app/\";\n\nexport const BACKEND_MODE_SIGNED_IN_STATUS = {\n  USER_SIGNED_IN: 'USER_SIGNED_IN',\n  USER_SIGNED_OUT: 'USER_SIGNED_OUT',\n  LOCAL_STORAGE: 'LOCAL_STORAGE',\n}\n\nexport const ACCESS_TOKEN_COOKIE_KEY = 'access_token';\n\nexport const getUserSignedInStatus = async () => {\n  const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n  if (token) {\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `auth`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (ok) { return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN; }\n    } catch (e) { console.log(e); }\n  }\n  return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT;\n};\n\nexport const INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY = 'initialLocalStorageBackendMode';\n\nconst SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE = 'backendModeSignedInStatus/set';\nexport const setBackendModeSignedInStatusAction =\n  status => ({ type: SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE, status });\nexport const backendModeSignedInStatusReducer = (\n  state = localStorage.getItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY)\n    ? BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE : BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT,\n  action,\n) => {\n  if (\n    action.type !== SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE || !action.hasOwnProperty('status') ||\n    !BACKEND_MODE_SIGNED_IN_STATUS.hasOwnProperty(action.status)\n  ) { return state; }\n  if (action.status === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n    localStorage.setItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY, true);\n  } else { localStorage.removeItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY); }\n  return action.status;\n};\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {GoogleLogin} from 'react-google-login';\nimport axios from 'axios';\nimport Cookies from 'js-cookie'\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  SERVER_BASE_URL,\n  ACCESS_TOKEN_COOKIE_KEY,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button';\nimport ReactTypingEffect from 'react-typing-effect';\n\nconst CLIENT_ID = '709358329925-gic89ini15sgaenfrta1gshej1ik72jg.apps.googleusercontent.com';\n\nclass LandingPage extends React.Component {\n\n  handleLoginSuccess = async ({ profileObj: { name, email }, tokenObj: { id_token: token, expiresAt: expiry } }) => {\n    let response = null;\n    try {\n      response = await axios.post(\n        SERVER_BASE_URL + 'register_user',\n        {\n          method: 'POST',\n          body: JSON.stringify({ name, email, token }),\n          headers: { 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` },\n        },\n        { withCredentials: true },\n      );\n    } catch(e) { console.log(e); }\n    if (response && response.status === 201) {\n      Cookies.set(ACCESS_TOKEN_COOKIE_KEY, token, { expires: new Date(expiry) });\n      this.props.dispatchSetBackendModeSignedInStatusAction(BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN);\n    }\n  };\n\n  render = () =>\n    <div style={{display:\"flex\", flexFlow: \"column\", height: \"100vh\", overflow: \"hidden\"}}>\n      <div className={\"landing-root\"} style={{flexGrow: \"0 1 auto\"}}>\n      <AppBar position=\"static\" class=\"custom-navbar\">\n        <Toolbar>\n          <img className={\"menuButton\"} src={require('../images/logo.png')} style={{width: \"50px\", marginRight: \"1%\"}} alt={\"MENU\"}/>\n        </Toolbar>\n      </AppBar>\n\n    </div>\n    <div style={{backgroundColor: \"#F5F0E1\", flex: \"1 1 auto\", display:\"flex\"}}>\n    <Grid container spacing={3} alignItems=\"center\">\n        <Grid item xs={1}></Grid>\n        <Grid item xs={5} alignItems=\"center\">\n          <Grid container spacing={3} alignItems=\"center\">\n            <Grid item xs={3}>\n              <img src={require('../images/darkLogo.png')} style={{width: \"90%\", marginLeft: \"20%\"}} alt={\"YADA\"}/>\n            </Grid>\n            <Grid item xs={9}>\n              <Typography variant=\"h1\" className={\"title\"} style={{fontFamily:\"Bungee\", color:\"#1E3D59\"}}>\n              YADA\n              <ReactTypingEffect\n                text = \"\"\n                style={{fontFamily:\"Signika\"}}\n                speed = {10000}\n              />\n              </Typography>\n              <Typography variant=\"h3\" className={\"title\"} style={{fontFamily:\"Signika\", color:\"#1E3D59\"}}>\n               Yet Another Docs App\n              </Typography>\n             </Grid>\n          </Grid>\n          <br />\n          <div style={{marginLeft: \"8%\"}}>\n              <GoogleLogin\n                  clientId={CLIENT_ID}\n                  buttonText=\"Sign in With Google\"\n                  onSuccess={response => { this.handleLoginSuccess(response); }}\n                  onFailure={response => { console.log(response); }}\n                  cookiePolicy=\"single_host_origin\"\n                  responseType=\"code,token\"\n                  style={{float: \"left\"}}\n                />\n                <Button \n                  variant=\"outlined\"\n                  style={{\"height\" : \"250%\", marginLeft: \"3%\"}}\n                  onClick={() => {\n                    this.props.dispatchSetBackendModeSignedInStatusAction(BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE);\n                  }}>\n                  Use local storage\n                </Button>\n          </div>\n        </Grid>\n        <Grid item xs={6}>\n           <img src={require('../images/graphic.png')} style={{width: \"70%\", marginLeft: \"10%\"}} alt={\"Document Graphic\"}/>\n        </Grid>\n    </Grid>\n    </div>\n  </div>\n}\n\nexport default connect(\n  state => ({ backendModeSignedInStatus: state.backendModeSignedInStatus }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n  }),\n)(LandingPage);\n","export const FILE_TYPE = {\n  SOURCE: 'SOURCE',\n  TEXT_VIEW: 'TEXT_VIEW',\n  CARD_VIEW: 'CARD_VIEW',\n  EMPTY: 'NON_EXISTENT',\n};\n\nexport const NO_OPEN_FILE_ID = { sourceId: 0, viewId: 0, viewType: FILE_TYPE.EMPTY };\n\nexport const validateFileIdObj = fileId => fileId.hasOwnProperty('sourceId') && fileId.hasOwnProperty('viewId');\nexport const validateHasFileIdObj = state => state.hasOwnProperty('fileId') && validateFileIdObj(state.fileId);\nexport const validateFileNameObj = fileName => fileName.hasOwnProperty('sourceName') && fileName.hasOwnProperty('viewName');\nexport const validateHasFileNameObj = state => state.hasOwnProperty('fileName') && validateFileNameObj(state.fileName);\n\nexport const checkNoOpenFileId = fileId => validateFileIdObj(fileId) && !fileId.sourceId && !fileId.viewId;\nexport const checkSourceFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && !fileId.viewId;\nexport const checkViewFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && fileId.viewId;\n\nexport const getFileIdKeyStr = fileId => validateFileIdObj(fileId)\n  ? (fileId.sourceId + (fileId.viewId ? '#' + fileId.viewId : '')) : '';\n","export const convertStrValueOrDefault =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    let value = defaultValue;\n    if (valueStr) {\n      try { value = convertFromString(valueStr); }\n      catch (e) {\n        if (failureMessage) { console.log(failureMessage); }\n        console.log(e);\n      }\n    }\n    return value;\n  };\n\nexport const convertStrValueOrDefaultIfFalsy =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    if (!valueStr) { return defaultValue; }\n    let value = null;\n    try { value = convertFromString(valueStr); }\n    catch (e) {\n      if (failureMessage) { console.log(failureMessage); }\n      console.log(e);\n    }\n    return value;\n  };\n","import {convertStrValueOrDefault} from '../util/ConvertStrValueOrDefault';\nimport {NO_OPEN_FILE_ID, validateHasFileIdObj, validateHasFileNameObj} from '../util/FileIdAndTypeUtils';\n\nexport const INITIAL_FILE_ID_LOCAL_STORAGE_KEY = 'initialFileId';\nexport const INITIAL_FILE_NAME_LOCAL_STORAGE_KEY = 'initialFileName';\n\nconst storedInitialFileId = convertStrValueOrDefault(\n  localStorage.getItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY),\n  {},\n  'invalid initialFileId',\n);\n\nconst storedInitialFileName = convertStrValueOrDefault(\n  localStorage.getItem(INITIAL_FILE_NAME_LOCAL_STORAGE_KEY),\n  {},\n  'invalid initialFileName',\n);\n\nconst initialFileId = {\n  sourceId: storedInitialFileId.hasOwnProperty('sourceId')\n    ? storedInitialFileId.sourceId : NO_OPEN_FILE_ID.sourceId,\n  viewId: storedInitialFileId.hasOwnProperty('viewId') ? storedInitialFileId.viewId : NO_OPEN_FILE_ID.viewId,\n  viewType: storedInitialFileId.hasOwnProperty('viewType') ? storedInitialFileId.viewType : NO_OPEN_FILE_ID.viewType,\n}\n\nconst initialFileName = {\n  sourceName: storedInitialFileName.hasOwnProperty('sourceName')\n    ? storedInitialFileName.sourceName : '',\n  viewName: storedInitialFileName.hasOwnProperty('viewName') ? storedInitialFileName.viewName : '',\n}\n\nconst SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE = 'currentOpenFileId/set';\nexport const setCurrentOpenFileIdAction = fileId => ({ type: SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE, fileId });\nexport const currentOpenFileIdReducer = (state = initialFileId, action) =>\n  action.type !== SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE || !validateHasFileIdObj(action)\n    ? state : action.fileId;\n\nconst SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE = 'currentOpenFileName/set';\nexport const setCurrentOpenFileNameAction = fileName => ({ type: SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE, fileName });\nexport const currentOpenFileNameReducer = (state = initialFileName, action) =>\n  action.type !== SET_CURRENT_OPEN_FILE_NAME_ACTION_TYPE || !validateHasFileNameObj(action)\n    ? state : action.fileName;\n\nexport const SET_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/set';\nexport const CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/clear';\nexport const saveDirtyFlagReducer = (state = false, action) =>\n  action.type !== SET_SAVE_DIRTY_FLAG_ACTION_TYPE && action.type !== CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE\n    ? state : action.type === SET_SAVE_DIRTY_FLAG_ACTION_TYPE;\n\nconst SET_SELECT_NODE_ACTION_TYPE = 'selectNode/set';\nexport const setSelectNodeAction = selectNode => ({ type: SET_SELECT_NODE_ACTION_TYPE, selectNode });\nexport const selectNodeReducer = (state = null, action) =>\n  action.type === SET_SELECT_NODE_ACTION_TYPE && action.hasOwnProperty('selectNode') &&\n  (!action.selectNode || action.selectNode.hasOwnProperty('pos'))\n    ? action.selectNode : (action.type === SET_SELECT_NODE_ACTION_TYPE ? null : state);\n","export const SET_TAGS_IN_VIEW_ACTION_TYPE = 'tagsInView/set';\nexport const setTagsInViewAction = tagsInView => ({ type: SET_TAGS_IN_VIEW_ACTION_TYPE, tagsInView });\nexport const setTagsInViewReducer = (state = null, action) =>\n\taction.type !== SET_TAGS_IN_VIEW_ACTION_TYPE || !action.hasOwnProperty('tagsInView')\n\t\t? state : action.tagsInView;\n","export const SET_TOAST_ACTION_TYPE = 'toast/set';\nexport const setToastAction = toast => ({ type: SET_TOAST_ACTION_TYPE, toast });\n\nexport const TOAST_DURATION_MS = 5000;\nexport const TOAST_CLEAR = 'clear';\nexport const TOAST_SEVERITY = {\n\tERROR: 'error',\n\tWARNING: 'warning',\n\tINFO: 'info',\n\tSUCCESS: 'success',\n}\nconst DEFAULT_STATE = {\n\tmessage: \"\",\n\tseverity: TOAST_SEVERITY.INFO,\n\topen: false\n}\n\nexport const setToastReducer = (state = DEFAULT_STATE, action) =>\n\taction.type !== SET_TOAST_ACTION_TYPE || !action.hasOwnProperty('toast')\n\t\t? state : (action === TOAST_CLEAR ? DEFAULT_STATE : action.toast);\n","import {configureStore} from '@reduxjs/toolkit';\nimport {combineReducers} from 'redux';\nimport {currentOpenFileIdReducer, saveDirtyFlagReducer, selectNodeReducer, currentOpenFileNameReducer} from './reducers/CurrentOpenFileState';\nimport {backendModeSignedInStatusReducer} from './reducers/BackendModeSignedInStatus';\nimport {setTagsInViewReducer} from \"./reducers/SetTagsInView\";\nimport {setToastReducer} from \"./reducers/Toast\";\n\nexport default configureStore({\n  reducer: combineReducers({\n    currentOpenFileId: currentOpenFileIdReducer,\n    currentOpenFileName: currentOpenFileNameReducer,\n    saveDirtyFlag: saveDirtyFlagReducer,\n    selectNode: selectNodeReducer,\n    backendModeSignedInStatus: backendModeSignedInStatusReducer,\n    tagsInView: setTagsInViewReducer,\n    toast: setToastReducer,\n  }),\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {setSelectNodeAction} from '../../reducers/CurrentOpenFileState';\nimport store from '../../store';\n\nconst SELECT_NODE_PLUGIN_NAME = 'select-node';\nexport const SelectNodePluginKey = new PluginKey(SELECT_NODE_PLUGIN_NAME);\n\nexport default new Plugin({\n  key: SelectNodePluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, _value, oldState) => {\n      let head = tr.selection.head;\n      let newState = null;\n      tr.doc.nodesBetween(head, head, (node, pos) => {\n        if (node.hasOwnProperty('attrs') && node.attrs['tags']) { newState = { node, pos }; }\n      });\n      if (\n        (!oldState && newState) || (oldState && !newState) ||\n        (oldState && newState && (newState.pos !== oldState.pos || !newState.node.eq(oldState.node)))\n      ) { store.dispatch(setSelectNodeAction(newState ? { pos: newState.pos } : null)); }\n      return newState;\n    },\n  },\n  props: {\n    decorations: state => {\n      const selectDecorations = [];\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (selectNode) {\n        selectDecorations.push(Decoration.node(\n          selectNode.pos,\n          selectNode.pos + selectNode.node.nodeSize,\n          { style: 'background: #FAFAFA; outline: 1px solid #DCDCDC;' },\n        ));\n      }\n      return DecorationSet.create(state.doc, selectDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {SelectNodePluginKey} from './SelectNode';\n\nconst TAG_FILTERING_PLUGIN_NAME = 'tag-filtering';\nexport const TagFilteringPluginKey = new PluginKey(TAG_FILTERING_PLUGIN_NAME);\n\nconst matchTagFilters = (tags, tagFilters) => {\n  if (!tagFilters) { return true; }\n  if (!Array.isArray(tagFilters)) { return tags.hasOwnProperty(tagFilters); }\n  // invariant: tagFilters isArray\n  // only not expressions have array length 2\n  if (tagFilters.length === 2) { return !matchTagFilters(tags, tagFilters[1]); }\n  const match1 = matchTagFilters(tags, tagFilters[0]);\n  if (tagFilters.length === 1) { return match1; }\n  // invariant: length 3, [1] is op, [2] is tag or sub expression\n  const andOp = tagFilters[1] === '&';\n  // short circuit evaluation\n  if (andOp !== match1) { return match1; }\n  // invariant:\n  // if andOp then !match1, so result should be match2,\n  // if !andOp then match1, so result should be match2\n  return matchTagFilters(tags, tagFilters[2]);\n};\n\nconst evaluateTagFilters = (decorations, tagFilters, selectNode, node, parentTags, pos) => {\n  let match = false;\n  const taggable = node.hasOwnProperty('attrs') && node.attrs['tags'];\n  const nodeTags = { ...parentTags, ...(taggable ? node.attrs['tags'] : null) };\n  if (taggable) { match = matchTagFilters(nodeTags, tagFilters); }\n  if (!node.isTextblock) {\n    let cumulativeChildSize = 1;\n    for (let i = 0; i < node.childCount; ++i) {\n      const child = node.child(i);\n      const childPos = pos + cumulativeChildSize;\n      const childMatch = evaluateTagFilters(decorations, tagFilters, selectNode, child, nodeTags, childPos);\n      match = match || childMatch;\n      cumulativeChildSize += child.nodeSize;\n    }\n  }\n  if (pos !== 0 && !match) {\n    decorations.push(Decoration.node(pos - 1, pos - 1 + node.nodeSize, { style: 'display: none;' }));\n  }\n  return match;\n};\n\nexport default new Plugin({\n  key: TagFilteringPluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, v) => {\n      const val = tr.getMeta(TagFilteringPluginKey);\n      return val === undefined ? v : val;\n    },\n  },\n  props: {\n    decorations: state => {\n      const filterDecorations = [];\n      const tagFilters = TagFilteringPluginKey.getState(state);\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (tagFilters) { evaluateTagFilters(filterDecorations, tagFilters, selectNode, state.doc, {}, 0); }\n      return DecorationSet.create(state.doc, filterDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {checkSourceFileId} from '../../util/FileIdAndTypeUtils';\nimport {TagFilteringPluginKey} from './TagFiltering';\nimport store from '../../store';\n\nconst CANCEL_LINE_BREAKS_PLUGIN_NAME = 'cancel-line-breaks';\nexport const CancelLineBreaksPluginKey = new PluginKey(CANCEL_LINE_BREAKS_PLUGIN_NAME);\n\nconst checkInsertLineBreakReplaceStep = step => step.slice.content.content.some(node => !node.isLeaf);\n\nconst checkRemoveLineBreakReplaceStep = (step, doc) => {\n  if (step.from === step.to) { return false; }\n  const fromNode = doc.nodeAt(step.from);\n  const toNode = doc.nodeAt(step.to);\n  if (toNode) { return !fromNode || (fromNode && !fromNode.eq(toNode)); }\n  return !fromNode || !doc.nodeAt(step.to - 1).eq(fromNode);\n};\n\nexport default new Plugin({\n  key: CancelLineBreaksPluginKey,\n  filterTransaction: (tr, state) =>\n    (checkSourceFileId(store.getState().currentOpenFileId) && !TagFilteringPluginKey.getState(state)) ||\n    tr.steps.every(\n      step => step.toJSON().stepType !== 'replace' ||\n        (!checkInsertLineBreakReplaceStep(step) && !checkRemoveLineBreakReplaceStep(step, state.doc))\n    ),\n});\n","import {Extension} from 'rich-markdown-editor';\nimport CancelLineBreaksPlugin from './plugins/CancelLineBreaks';\nimport SelectNodePlugin from './plugins/SelectNode';\nimport TagFilteringPlugin from './plugins/TagFiltering';\n\nclass BlockTagging extends Extension {\n  get name() { return 'yada-blockTagging'; }\n  get plugins() { return [CancelLineBreaksPlugin, SelectNodePlugin, TagFilteringPlugin]; }\n}\n\nexport default new BlockTagging();\n","import './TagMenu.css';\nimport {defer} from 'lodash';\nimport {v4 as uuidv4} from 'uuid';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from '../reducers/CurrentOpenFileState';\n\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\n\nconst BLOCK_NODE_TAGS_LIST_ID = 'block_node_tags_list';\n\nconst ADD_TAG_INPUT_ID = 'add_tag_input';\n\nconst MODIFY_TAG_INPUT_ID_PREFIX = 'modify_tag_input_';\n\nconst TAG_VALUE_REGEX = /[^{}]/;\nconst INVALID_TAG_VALUE_REGEX = /[{}]/;\n\nclass TagMenu extends React.Component {\n\n  state = { selectNodeAttrs: {}, modifying: '' }\n\n  handleAddTag = () => {\n    const tag = document.getElementById(ADD_TAG_INPUT_ID).value.trim();\n    if (!tag || INVALID_TAG_VALUE_REGEX.test(tag) || !this.props.selectNode) { return false; }\n    if (this.state.selectNodeAttrs.hasOwnProperty('tags') && this.state.selectNodeAttrs.tags.hasOwnProperty(tag)) {\n      this.props.dispatchSetToastAction({\n        message: `Tag value \"${tag}\" already exists`,\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[tag] = uuidv4();\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleDeleteTag = tag => {\n    if (\n      !this.props.selectNode || !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(tag)\n    ) { return false; }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    delete newSelectNodeAttrs.tags[tag];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleModifyTagValue = oldTagValue => {\n    const newTagValue = document.getElementById(MODIFY_TAG_INPUT_ID_PREFIX + oldTagValue).value.trim();\n    if (\n      !newTagValue || INVALID_TAG_VALUE_REGEX.test(newTagValue) || !this.props.selectNode ||\n      !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(oldTagValue)\n    ) { return false; }\n    if (newTagValue === oldTagValue) { return true; }\n    if (this.state.selectNodeAttrs.tags.hasOwnProperty(newTagValue)) {\n      this.props.dispatchSetToastAction({\n        message: `Tag value ${newTagValue} already exists`,\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[newTagValue] = newSelectNodeAttrs.tags[oldTagValue];\n    delete newSelectNodeAttrs.tags[oldTagValue];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleCancelModifyTagValue = tag => {\n    const input = MODIFY_TAG_INPUT_ID_PREFIX + tag;\n    input.value = tag;\n    input.setSelectionRange(0, 0);\n    if (this.state.modifying === tag) { this.setState({ modifying: '' }); }\n  };\n\n  handleStartModifyingTagValue = (tag) => {\n    this.setState({ modifying: tag });\n    defer(() => {\n      const input = document.getElementById(MODIFY_TAG_INPUT_ID_PREFIX + tag);\n      input.focus();\n      input.setSelectionRange(0, input.value.length);\n    });\n  };\n  \n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId ||\n      (!prevProps.selectNode && this.props.selectNode) || (prevProps.selectNode && !this.props.selectNode) ||\n      (prevProps.selectNode && this.props.selectNode && prevProps.selectNode.pos !== this.props.selectNode.pos)\n    ) {\n      document.getElementById(ADD_TAG_INPUT_ID).value = '';\n      defer(() => {\n        if (this.props.selectNode) {\n          const node = BlockTaggingEditorExtension.editor.view.state.doc.nodeAt(this.props.selectNode.pos);\n          this.setState({ selectNodeAttrs: {...(node && node.hasOwnProperty('attrs') ? node.attrs : null)} });\n        } else { this.setState({ selectNodeAttrs: {} }); }\n      });\n    }\n  };\n\n  render = () =>\n    <div className=\"MarginPane\">\n      <div id=\"tag_menu_wrapper\">\n        <div className=\"InputRow\" id=\"add_tag_input_row\">\n          <input\n            id={ADD_TAG_INPUT_ID}\n            title=\"new tag\"\n            placeholder=\"new tag\"\n            disabled={!this.props.selectNode}\n            onKeyPress={event=> {\n              if (event.key === 'Enter' && this.handleAddTag()) { event.target.value = ''; }\n              if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n            }}\n            onKeyDown={event=> {\n              if (event.key === 'Escape') {\n                event.target.value = '';\n                BlockTaggingEditorExtension.editor.view.focus();\n              }\n            }}\n          />\n          <button\n            className=\"MonospaceCharButton\"\n            title=\"add\"\n            disabled={!this.props.selectNode}\n            onClick={this.handleAddTag}>\n            {'+'}\n          </button>\n        </div>\n        <div id=\"tag_menu_list_container\">\n          {\n            this.props.selectNode && this.state.selectNodeAttrs.hasOwnProperty('tags') &&\n            Object.keys(this.state.selectNodeAttrs.tags).length > 0\n              ? <ul id={BLOCK_NODE_TAGS_LIST_ID}>\n                  {\n                    Object.keys(this.state.selectNodeAttrs.tags).map(tag =>\n                      <li key={tag}>\n                        <div className=\"ButtonRow\">\n                          {\n                            this.state.modifying !== tag\n                              ? <button disabled>{tag}</button>\n                              :  <input\n                                  id={MODIFY_TAG_INPUT_ID_PREFIX + tag}\n                                  defaultValue={tag}\n                                  placeholder={tag}\n                                  disabled={this.state.modifying !== tag}\n                                  onBlur={event => {\n                                    this.handleModifyTagValue(tag);\n                                    if (this.state.modifying === tag) { this.setState({ modifying: '' }); }\n                                  }}\n                                  onKeyDown={event => {\n                                    if (event.key === 'Escape') { this.handleCancelModifyTagValue(tag); }\n                                  }}\n                                  onKeyPress={event => {\n                                    if (event.key === 'Enter') { event.target.blur(); }\n                                    if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n                                  }}\n                                />\n                          }\n                          <button\n                            className=\"MonospaceCharButton\"\n                            title=\"modify\"\n                            hidden={this.state.modifying === tag}\n                            onClick={() => { this.handleStartModifyingTagValue(tag); }}>\n                            {'#'}\n                          </button>\n                          <button\n                            className=\"MonospaceCharButton\"\n                            title=\"remove\"\n                            onClick={() => { this.handleDeleteTag(tag); }}>\n                            {'-'}\n                          </button>\n                        </div>\n                      </li>\n                    )\n                  }\n                </ul>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_tags_placeholder\">\n                  {'no ' + (!this.props.selectNode ? 'selected block' : 'block tags')}\n                </div>\n          }\n        </div>\n      </div>\n    </div>;\n};\n\nexport default connect(\n  state => ({\n    selectNode: state.selectNode,\n    saveDirtyFlag: state.saveDirtyFlag,\n    currentOpenFileId: state.currentOpenFileId,\n  }),\n  dispatch => ({\n    dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(TagMenu);\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {checkNoOpenFileId} from '../util/FileIdAndTypeUtils';\nimport {\n  SET_SAVE_DIRTY_FLAG_ACTION_TYPE,\n} from '../reducers/CurrentOpenFileState';\nimport {TextSelection} from 'prosemirror-state';\nimport TagMenu from './TagMenu';\nimport RichMarkdownEditor from 'rich-markdown-editor';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\n\nclass Editor extends React.Component {\n  render = () => {\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    return (\n      <div className=\"MainPane\">\n        <div className=\"editor_container\">\n          <div className=\"editor\" hidden={noOpenFileIdCheck}>\n            <RichMarkdownEditor\n              extensions={[BlockTaggingEditorExtension]}\n              key={this.props.fileIdKeyStr}\n              defaultValue={this.props.fileContent}\n              jsonStrValue={!(!this.props.fileContent)}\n              onKeyDown={event => {\n                if (event.key === 'Escape') {\n                  BlockTaggingEditorExtension.editor.view.dispatch(\n                    BlockTaggingEditorExtension.editor.view.state.tr\n                      .setSelection(TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0))\n                  );\n                  event.target.blur();\n                }\n              }}\n              onChange={() => { if (!this.props.saveDirtyFlag) { this.props.dispatchSetSaveDirtyFlagAction(); } }}\n            />\n          </div>\n          <div\n            className=\"placeholder_editor\"\n            hidden={!noOpenFileIdCheck}>\n            <h5>Click or create a new document from the left pane</h5>\n          </div>\n        </div>\n        <TagMenu />\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({ currentOpenFileId: state.currentOpenFileId, currentOpenFileName: state.currentOpenFileName, saveDirtyFlag: state.saveDirtyFlag }),\n  dispatch => ({ dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }) }),\n)(Editor);\n","import {convertStrValueOrDefault, convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\n\nconst SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX = 'sourceViews_';\n\n// API-ish\nexport const doSetLocalStorageSourceViews = (sourceId, sourceViews) =>\n  localStorage.setItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId, JSON.stringify(sourceViews));\n\nconst doGetLocalStorageSourceViews = sourceId => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n  {},\n  'invalid sourceViews',\n);\n\nconst SOURCE_ID_NAMES_LOCAL_STORAGE_KEY = 'sourceIdNames';\n\n// API-ish\nexport const doSetLocalStorageSourceIdNames = sourceIdNames =>\n  localStorage.setItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY, JSON.stringify(sourceIdNames));\n\nconst doGetLocalStorageSourceIdNames = () => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY),\n  {},\n  'invalid sourceIdNames',\n);\n\nexport const calculateLocalStorageNextNewId = (existingIdsDict, candidate) => {\n  while (!candidate || existingIdsDict.hasOwnProperty(candidate.toString())) { candidate += 1; }\n  return candidate.toString();\n};\n\nexport const calculateLocalStorageNextNewFileIds = filesList => ({\n  source: calculateLocalStorageNextNewId(filesList, 0),\n  nextNewViewIdsForSourceIds: Object.fromEntries(Object.entries(filesList).map(\n    ([sourceId, { views }]) => [sourceId, calculateLocalStorageNextNewId(views, 0)]\n  )),\n});\n\nconst DEFAULT_VIEW_NAME = 'Unnamed View';\nconst DEFAULT_SOURCE_NAME = 'Unnamed Source';\n\nconst SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX = 'sourceSavedTagFilters_';\n\nconst VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX = 'viewSpec_';\n\nconst SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX = 'sourceContent_';\n\nexport default {\n  doGetFilesList: async () => {\n    const sourceIdNames = doGetLocalStorageSourceIdNames();\n    if (!sourceIdNames) { return null; }\n    const filesList = {};\n    for (const [sourceId, sourceName] of Object.entries(sourceIdNames)) {\n      const sourceViews = doGetLocalStorageSourceViews(sourceId);\n      if (!sourceViews) { return null; }\n      filesList[sourceId] = { name: sourceName, views: sourceViews };\n    }\n    return filesList;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const viewSpecLocalStorageKey = VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId);\n    if (tagsList.length > 0) { localStorage.setItem(viewSpecLocalStorageKey, JSON.stringify(tagsList)); }\n    else { localStorage.removeItem(viewSpecLocalStorageKey); }\n    return { id: viewId, sourceId, ...(createNew ? { name: DEFAULT_VIEW_NAME, type } : null) };\n  },\n  doGetView: async (fileId) => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(fileId.sourceId, fileId.viewId)),\n    [],\n    'invalid viewSpec',\n  ),\n  doGetSourceTaggedBlocks: async sourceId => {\n    const sourceContentDocStr = localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    if (!sourceContentDocStr) { return {}; }\n    const sourceContentDoc = convertStrValueOrDefault(sourceContentDocStr, null, 'invalid sourceContent');\n    if (!sourceContentDoc) { return null; }\n    const sourceTaggedBlocks = {};\n    if (sourceContentDoc) {\n      const nodes = [sourceContentDoc];\n      while (nodes.length > 0) {\n        const node = nodes.shift();\n        if (node.hasOwnProperty('attrs') && node.attrs.hasOwnProperty('tags')) {\n          for (const [tag, tagId] of Object.entries(node.attrs.tags)) { sourceTaggedBlocks[tagId] = { tag, node }; }\n        } else if (node.hasOwnProperty('content')) { nodes.push(...node.content); }\n      }\n    }\n    return sourceTaggedBlocks;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      '',\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (saveValue === null) { return null; }\n    const sourceContentLocalStorageKey = SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (saveValue) { localStorage.setItem(sourceContentLocalStorageKey, saveValue); }\n    else { localStorage.removeItem(sourceContentLocalStorageKey); }\n    return { id: sourceId, ...(createNew ? { name: DEFAULT_SOURCE_NAME } : null) };\n  },\n  doGetSourceContent: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    '',\n    'invalid sourceContent',\n    valueStr => {\n      JSON.parse(valueStr);\n      return valueStr;\n    },\n  ),\n  // TODO add/remove single instead of set list\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const sourceSavedTagFiltersLocalStorageKey = SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (Object.keys(sourceSavedTagFilters).length > 0) {\n      localStorage.setItem(sourceSavedTagFiltersLocalStorageKey, JSON.stringify(sourceSavedTagFilters));\n    } else { localStorage.removeItem(sourceSavedTagFiltersLocalStorageKey); }\n    return true;\n  },\n  doGetSourceSavedTagFilters: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    {},\n    'invalid sourceSavedTagFilters',\n  ),\n  doDeleteView: async (sourceId, viewId) => {\n    localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    return true;\n  },\n  doDeleteSource: async (sourceId, localStorageSourceViewIds) => {\n    localStorage.removeItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    localStorage.removeItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    for (const viewId of localStorageSourceViewIds) {\n      localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    }\n    localStorage.removeItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    return true;\n  },\n  doRenameView: async () => true,\n  doRenameSource: async () => true,\n};\n","import Cookies from 'js-cookie';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\nimport {convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {ACCESS_TOKEN_COOKIE_KEY, SERVER_BASE_URL} from '../reducers/BackendModeSignedInStatus';\n\nconst EMPTY_SOURCE_CONTENT = { type: 'doc', content: [{ type: 'paragraph', attrs: { tags: {} } }] };\n\nexport default {\n  doGetFilesList: async () => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `documents`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewType=${type}` + (!createNew ? `&viewID=${viewId}` : ''),\n        {\n          method: 'PUT',\n          body: JSON.stringify({ tags: tagsList }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n    );\n    if (response.ok) {\n      const { viewID } = await response.json();\n      return { id: viewID, sourceId: sourceId, ...(createNew ? { name:\"Untitled\", type } : null) };\n    }\n    throw new Error(\"Failed to save view\");\n  },\n  doGetView: async (fileId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const viewResponse = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${fileId.sourceId}&viewID=${fileId.viewId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      const tagResponse = await fetchWithTimeout(\n          SERVER_BASE_URL + `tags?docID=${fileId.sourceId}`,\n          { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (!viewResponse.ok || !tagResponse.ok) { return null; }\n      const view_json = await viewResponse.json();\n      const tags_json = await tagResponse.json();\n      return {\"view\": view_json, \"tags\": tags_json, \"type\": fileId.viewType};\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceTaggedBlocks: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `tags?docID=${sourceId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      JSON.stringify(EMPTY_SOURCE_CONTENT),\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (!saveValue) { return null; }\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + 'document' + (!createNew ? `?docID=${sourceId}` : ''),\n        {\n          method: 'PUT',\n          body: saveValue,\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        const { id, name } = await response.json();\n        return { id: id, ...(createNew ? { name } : null) };\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceContent: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.text(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    const filters = Object.keys(sourceSavedTagFilters);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=`,\n        {\n          method: 'POST',\n          body: JSON.stringify({ body: {\"docID\": sourceId, \"filters\": filters} }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        return true;\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceSavedTagFilters: async sourceId => { // TODO\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doDeleteSource: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doDeleteView: async (sourceId, viewId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameSource: async (sourceId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameView: async (sourceId, viewId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n};\n","import {BACKEND_MODE_SIGNED_IN_STATUS} from '../reducers/BackendModeSignedInStatus';\nimport LocalFileStorageSystemClient from './LocalFileStorageSystemClient';\nimport HostedFileStorageSystemClient from './HostedFileStorageSystemClient';\nimport store from '../store';\n\nconst getFileStorageSystemClient = () =>\n  store.getState().backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n    ? LocalFileStorageSystemClient : HostedFileStorageSystemClient;\n\nconst clientInterface = {\n  doGetFilesList: () => { throw new Error('not implemented'); },\n  doSaveViewSpec: () => { throw new Error('not implemented'); },\n  doGetView: () => { throw new Error('not implemented'); },\n  doGetSourceTaggedBlocks: () => { throw new Error('not implemented'); },\n  doSaveSourceContent: () => { throw new Error('not implemented'); },\n  doGetSourceContent: () => { throw new Error('not implemented'); },\n  doSetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doGetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doDeleteView: () => { throw new Error('not implemented'); },\n  doDeleteSource: () => { throw new Error('not implemented'); },\n  doRenameView: () => { throw new Error('not implemented'); },\n  doRenameSource: () => { throw new Error('not implemented'); },\n};\n\nexport default Object.keys(clientInterface).reduce(\n  (partial, key) => {\n    partial[key] = async (...args) => {\n      const fileStorageSystemClient = getFileStorageSystemClient();\n      return fileStorageSystemClient.hasOwnProperty(key)\n        ? (\n            store.getState().backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n              ? await fileStorageSystemClient[key](...args) : null\n          )\n        : clientInterface[key]();\n    };\n    return partial;\n  },\n  {},\n);\n","import './Editor.css';\nimport {defer} from 'lodash';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {NO_OPEN_FILE_ID, checkNoOpenFileId, checkSourceFileId, getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\nimport Editor from './Editor';\nimport {handleSetCurrentOpenFileId} from './Navigator';\n\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\nimport {BACKEND_MODE_SIGNED_IN_STATUS} from \"../reducers/BackendModeSignedInStatus\";\nimport store from \"../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../reducers/CurrentOpenFileState\";\n\nexport const INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY = 'initialTagFilters';\n\nconst DEFAULT_STATE = {\n  fileIdKeyStr: getFileIdKeyStr(NO_OPEN_FILE_ID),\n  fileContent: '',\n};\n\nclass SourceEditorWithTagFiltersInput extends React.Component {\n\n  state = DEFAULT_STATE;\n  \n  keydownHandler = event => {\n    if ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey) && event.keyCode === 83) {\n      event.preventDefault();\n      if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT) {\n        if (checkSourceFileId(this.props.currentOpenFileId)) {\n          FileStorageSystemClient.doSaveSourceContent(\n              BlockTaggingEditorExtension.editor.value(true),\n              this.props.currentOpenFileId.sourceId,\n          ).then(success => {\n            if (success) {\n              this.props.dispatchSetToastAction({\n                message: \"Saved source file\",\n                severity: TOAST_SEVERITY.SUCCESS,\n                open: true\n              });\n              store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n            }\n            else {\n              this.props.dispatchSetToastAction({\n                message: \"Failed to save source file\",\n                severity: TOAST_SEVERITY.ERROR,\n                open: true\n              });\n            }\n          });\n        }\n      }\n    }\n  }\n  \n  changeFile = async () => {\n    if (!checkNoOpenFileId(this.props.currentOpenFileId)) {\n      defer(() => {\n        BlockTaggingEditorExtension.editor.focusAtStart();\n      });\n    }\n    const fileIdKeyStr = getFileIdKeyStr(this.props.currentOpenFileId);\n    if (checkSourceFileId(this.props.currentOpenFileId)) {\n      FileStorageSystemClient.doGetSourceContent(this.props.currentOpenFileId.sourceId).then(value => {\n        if (value === null) {\n          this.props.dispatchSetToastAction({\n            message: \"Failed to retrieve source content\",\n            severity: TOAST_SEVERITY.ERROR,\n            open: true\n          });\n          handleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n        } else {\n          this.setState({fileIdKeyStr, fileContent: value ?? ''});\n        }\n      });\n    } else {\n      this.setState({fileIdKeyStr, fileContent: ''});\n    }\n  };\n\n  componentDidMount = () => {\n    document.addEventListener('keydown',this.keydownHandler);\n    this.changeFile();\n  };\n  \n  componentWillUnmount = () => { document.removeEventListener('keydown', this.keydownHandler); };\n  \n  \n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n    ) {\n      this.changeFile();\n    }\n  };\n\n  render = () => {\n    return (\n      <Editor fileIdKeyStr={this.state.fileIdKeyStr} fileContent={this.state.fileContent} />\n    );\n  };\n}\n\nexport default connect(\n    state => ({\n      currentOpenFileId: state.currentOpenFileId,\n      currentOpenFileName: state.currentOpenFileName\n    }),\n    dispatch => ({\n      dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n    }),\n)(SourceEditorWithTagFiltersInput);\n","import './Navigator.css';\nimport {debounce, defer} from 'lodash';\nimport Cookies from 'js-cookie';\nimport React from 'react';\nimport {batch, connect} from 'react-redux';\nimport {\n  FILE_TYPE,\n  NO_OPEN_FILE_ID,\n  validateFileIdObj,\n  checkNoOpenFileId,\n  checkSourceFileId,\n  checkViewFileId,\n  getFileIdKeyStr,\n} from '../util/FileIdAndTypeUtils';\nimport {INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY} from './SourceEditorWithTagFiltersInput';\nimport {\n  CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE,\n  INITIAL_FILE_ID_LOCAL_STORAGE_KEY,\n  INITIAL_FILE_NAME_LOCAL_STORAGE_KEY,\n  setCurrentOpenFileIdAction,\n  setCurrentOpenFileNameAction,\n  setSelectNodeAction,\n} from '../reducers/CurrentOpenFileState';\nimport {\n  ACCESS_TOKEN_COOKIE_KEY,\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport {\n  doSetLocalStorageSourceIdNames,\n  doSetLocalStorageSourceViews,\n  calculateLocalStorageNextNewId,\n  calculateLocalStorageNextNewFileIds,\n} from '../backend/LocalFileStorageSystemClient';\nimport Button from '@material-ui/core/Button';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Divider from '@material-ui/core/Divider';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Collapse from '@material-ui/core/Collapse';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport EditIcon from '@material-ui/icons/Edit';\nimport Popover from '@material-ui/core/Popover';\nimport store from '../store';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport CheckIcon from '@material-ui/icons/Check';\nimport AddIcon from '@material-ui/icons/Add';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport AmpStoriesIcon from '@material-ui/icons/AmpStories';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\n\nexport const handleSetCurrentOpenFileId = (fileId, fileName={\"sourceName\": '', \"viewName\": ''}) => {\n  if (!validateFileIdObj(fileId)) { return false; }\n  const currentOpenFileId = store.getState().currentOpenFileId;\n  if (fileId.sourceId === currentOpenFileId.sourceId && fileId.viewId === currentOpenFileId.viewId) { return true; }\n  if (!store.getState().saveDirtyFlag || window.confirm('confirm discard unsaved changes')) {\n    batch(() => {\n      store.dispatch(setCurrentOpenFileIdAction(fileId));\n      store.dispatch(setCurrentOpenFileNameAction(fileName));\n      store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n      store.dispatch(setSelectNodeAction(null));\n    });\n    localStorage.setItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY, JSON.stringify(fileId));\n    localStorage.setItem(INITIAL_FILE_NAME_LOCAL_STORAGE_KEY, JSON.stringify(fileName));\n    localStorage.removeItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY);\n    return true;\n  }\n  return false;\n};\n\nconst convertFilesListStateToFileIdNamesList = filesListState => Object.fromEntries(\n  Object.entries(filesListState).map(([id, { name }]) => [id, name])\n);\n\nconst countNumFiles = filesList => Object.entries(filesList)\n  .reduce((count, [_sourceId, { views }]) => count + 1 + Object.keys(views).length, 0);\n\nconst FILE_LIST_ID = 'file_list';\n\nconst SEARCH_FILE_NAMES_INPUT_ID = 'search_file_names_input';\n\nconst CURRENT_SOURCE_NAME_INPUT_ID = 'current_source_name_input';\nconst CURRENT_VIEW_NAME_INPUT_ID = 'current_view_name_input';\n\nconst RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX = 'rename_source_list_item_input_';\nconst RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX = 'rename_view_list_item_input_';\n\nconst RENAME_INPUT_TYPES = {\n  CURRENT_SOURCE: 'CURRENT_SOURCE',\n  CURRENT_VIEW: 'CURRENT_VIEW',\n  SOURCE_LIST_ITEM: 'SOURCE_LIST_ITEM',\n  VIEW_LIST_ITEM: 'VIEW_LIST_ITEM',\n};\n\nconst getRenameInputIdFunctions = {\n  [RENAME_INPUT_TYPES.CURRENT_SOURCE]: () => CURRENT_SOURCE_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.CURRENT_VIEW]: () => CURRENT_VIEW_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: fileId => RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX + fileId.sourceId,\n  [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: fileId => RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX + getFileIdKeyStr(fileId),\n};\n\nconst NO_RENAMING_STATE = { inputType: null, fileId: NO_OPEN_FILE_ID };\n\nconst DEFAULT_STATE = {\n  searching: '',\n  renaming: NO_RENAMING_STATE,\n  filesList: {},\n  nextNewFileIds: null,\n  selectedFileId: null,\n  selectedViewId: null,\n  selectedFileOpen: false,\n  editMenuAnchorElement: null,\n  renameSelected: false,\n  newViewAnchorElement: null\n};\n\nclass FileListItem extends React.Component {\n  render = () => {\n    if(this.props.fileId.viewId !== 0){\n      const viewType = this.props.viewType;\n      return (\n        <div className={\"fileList-viewRoot\"} style={(this.props.selected) ? \n                                                  {backgroundColor: 'rgba(30, 61, 89, 0.3)', width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} : \n                                                  {width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} }>\n          <IconButton>\n            {\n              (viewType === FILE_TYPE.CARD_VIEW) ? \n              <AmpStoriesIcon color=\"primary\"/>:\n              (viewType === FILE_TYPE.TEXT_VIEW) ?\n             <TextFieldsIcon color=\"primary\"/> :\n              null\n            }\n          </IconButton>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n            style={{color: \"#1E3D59\"}}\n          />\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"primary\"/>\n          </IconButton>\n        </div>\n      );\n    }else{\n      return (\n        <div className={\"fileList-viewRoot\"} style={(this.props.selected) ? \n                                                      {backgroundColor: 'rgba(30, 61, 89, 0.3)', border:\"solid #3f51b5 thin\", width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} :\n                                                       {width:\"100%\", display: \"flex\", padding: \"2px 4px\", alignItems: \"center\"} }>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n            style={{color: \"#1E3D59\"}}\n          />\n          {this.props.childViewsExist ? (this.props.open ? <ExpandLess /> : <ExpandMore />) : null}\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"primary\"/>\n          </IconButton>\n        </div>\n      );\n    }\n  }\n};\n\nclass Navigator extends React.Component {\n  \n  state = DEFAULT_STATE;\n\n  resetState = () => { this.setState(DEFAULT_STATE); }\n\n  getSourceName = fileId => validateFileIdObj(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId)\n      ? this.state.filesList[fileId.sourceId].name : '';\n  \n  getViewName = fileId => checkViewFileId(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId) &&\n    this.state.filesList[fileId.sourceId].views.hasOwnProperty(fileId.viewId)\n      ? this.state.filesList[fileId.sourceId].views[fileId.viewId].name : '';\n\n  getFileName = fileId => checkViewFileId(fileId) ? this.getViewName(fileId) : this.getSourceName(fileId);\n\n  getRenameInputValueFunctions = {\n    [RENAME_INPUT_TYPES.CURRENT_SOURCE]: this.getSourceName,\n    [RENAME_INPUT_TYPES.CURRENT_VIEW]: this.getViewName,\n    [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: this.getFileName,\n    [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: this.getFileName,\n  };\n\n  handleSwitchBackendModeSignedInStatus = status => {\n    if (status === this.props.backendModeSignedInStatus) { return true; }\n    if (handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)) {\n      this.resetState();\n      this.props.dispatchSetBackendModeSignedInStatusAction(status);\n      return true;\n    }\n    return false;\n  };\n\n  handleCancelRenaming = (inputType, fileId) => {\n    const input = document.getElementById(getRenameInputIdFunctions[inputType](fileId));\n    input.value = this.getRenameInputValueFunctions[inputType](fileId);\n    input.setSelectionRange(0, 0);\n    this.setState({ renaming: NO_RENAMING_STATE });\n  };\n\n  handleClearSearchingInput = () => {\n    document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value = '';\n    this.setState({ searching: '' });\n  };\n\n  handleChangeSearchingInput = () => {\n    this.setState({ searching: document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value.trim() });\n  };\n\n  handleDoFileNamesSearch = () => Object.fromEntries(\n    Object.entries(this.state.filesList).map(([sourceId, { name: sourceName, views }]) => [\n      sourceId,\n      {\n        name: sourceName,\n        views: this.state.searching\n          ? Object.fromEntries(Object.entries(views).filter(\n              ([_viewId, { name: viewName }]) => viewName.includes(this.state.searching)\n            ))\n          : views,\n      },\n    ]).filter(\n      ([_sourceId, { name: sourceName, views }]) => !this.state.searching ||\n        Object.keys(views).length > 0 || sourceName.includes(this.state.searching)\n    )\n  );\n\n  handleCreateNewFile = async fileType => {\n    if (!FILE_TYPE.hasOwnProperty(fileType)) { return; }\n    const sourceFileType = fileType === FILE_TYPE.SOURCE;\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    if (\n      (noOpenFileIdCheck && !sourceFileType) ||\n      (!noOpenFileIdCheck && !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID))\n    ) { return; }\n    const localStorageNextNewFileId =\n      this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n        ? (\n            sourceFileType\n              ? this.state.nextNewFileIds.source\n              : this.state.nextNewFileIds.nextNewViewIdsForSourceIds[this.props.currentOpenFileId.sourceId]\n          )\n        : null;\n    const newFilePromise = sourceFileType\n      ? FileStorageSystemClient.doSaveSourceContent(null, localStorageNextNewFileId, true)\n      : FileStorageSystemClient.doSaveViewSpec(\n          [],\n          this.props.currentOpenFileId.sourceId,\n          localStorageNextNewFileId,\n          fileType,\n          true,\n        );\n    try {\n      const newFile = await newFilePromise;\n      const updatedSourceId = sourceFileType ? newFile.id : this.state.selectedFileId;\n      const newFilesList = {\n        ...this.state.filesList,\n        [updatedSourceId]: {\n          name: sourceFileType ? newFile.name : this.state.filesList[updatedSourceId].name,\n          views: {\n            ...(\n                !sourceFileType\n                    ? {\n                      ...this.state.filesList[updatedSourceId].views,\n                      [newFile.id]: {name: newFile.name, type: newFile.type},\n                    }\n                    : null\n            ),\n          },\n        },\n      };\n      this.setState(\n        {filesList: newFilesList,\n         selectedFileId: updatedSourceId,\n         selectedFileOpen: !sourceFileType,\n         selectedViewId: (sourceFileType) ? 0 : newFile.id\n        });\n      \n      defer(() => {\n        const fileId = {sourceId: updatedSourceId, viewId: !sourceFileType ? newFile.id : 0, viewType: sourceFileType ? FILE_TYPE.EMPTY: newFile.type};\n        const fileName = {sourceName: this.getSourceName(fileId), viewName: this.getViewName(fileId)};\n        handleSetCurrentOpenFileId(fileId, fileName);\n      });\n      if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n        if (sourceFileType) {\n          doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList));\n        } else {\n          doSetLocalStorageSourceViews(updatedSourceId, newFilesList[updatedSourceId].views);\n        }\n        this.setState({\n          nextNewFileIds: {\n            source: sourceFileType\n                ? calculateLocalStorageNextNewId(newFilesList, parseInt(updatedSourceId))\n                : this.state.nextNewFileIds.source,\n            nextNewViewIdsForSourceIds: {\n              ...this.state.nextNewFileIds.nextNewViewIdsForSourceIds,\n              ...(\n                  !sourceFileType\n                      ? {\n                        [updatedSourceId]:\n                            calculateLocalStorageNextNewId(newFilesList[updatedSourceId].views, parseInt(newFile.id)),\n                      }\n                      : null\n              ),\n            },\n          },\n        });\n      }\n    } catch (e) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to create new file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n    }\n  }\n\n  handleDeleteFile = async fileId => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    if (\n      fileId.sourceId === this.props.currentOpenFileId.sourceId &&\n      fileId.viewId === this.props.currentOpenFileId.viewId &&\n      !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)\n    ) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const deleteFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doDeleteSource(\n          fileId.sourceId,\n          Object.keys(this.state.filesList[fileId.sourceId].views),\n        )\n      : FileStorageSystemClient.doDeleteView(fileId.sourceId, fileId.viewId);\n    const success = await deleteFilePromise;\n    if (!success) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to delete file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return;\n    }\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) { delete newFilesList[fileId.sourceId]; }\n    else {\n      const newSourceViews = {...newFilesList[fileId.sourceId].views};\n      delete newSourceViews[fileId.viewId];\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) {\n        doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList));\n        const newNextNewViewIdsForSourceIds = {...this.state.nextNewFileIds.nextNewViewIdsForSourceIds};\n        delete newNextNewViewIdsForSourceIds[fileId.sourceId];\n        this.setState({\n          nextNewFileIds: {\n            source: this.state.nextNewFileIds.source,\n            nextNewViewIdsForSourceIds: newNextNewViewIdsForSourceIds,\n          },\n        });\n      } else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  handleRenameFile = async (fileId) => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    const input = document.getElementById(\"rename_field\");\n    if (!input) { return; }\n    const newName = input.value.trim();\n    if (!newName || newName === this.getFileName(fileId)) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const renameFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doRenameSource(fileId.sourceId, newName)\n      : FileStorageSystemClient.doRenameView(fileId.sourceId, fileId.viewId, newName);\n    const success = await renameFilePromise;\n    if (!success) {\n      this.props.dispatchSetToastAction({\n        message: \"Failed to rename file\",\n        severity: TOAST_SEVERITY.ERROR,\n        open: true\n      });\n      return;\n    }\n    store.dispatch(setCurrentOpenFileNameAction({sourceName: sourceFileIdCheck ? newName : this.getSourceName(fileId), viewName: sourceFileIdCheck ? '' : newName}));\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) {\n      newFilesList[fileId.sourceId] = { name: newName, views: newFilesList[fileId.sourceId].views };\n    } else {\n      const newSourceViews = {\n        ...newFilesList[fileId.sourceId].views,\n        [fileId.viewId]: { ...newFilesList[fileId.sourceId].views[fileId.viewId], name: newName },\n      };\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) { doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList)); }\n      else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  componentDidMount = () => {\n    this.setState({\n      selectedFileId : this.props.currentOpenFileId.sourceId,\n      selectedViewId: this.props.currentOpenFileId.viewId,\n      selectedFileOpen: this.props.currentOpenFileId.viewId !== 0\n    })\n    FileStorageSystemClient.doGetFilesList().then(filesList => {\n      if (!filesList) {\n        this.props.dispatchSetToastAction({\n          message: \"Failed to retrieve file list\",\n          severity: TOAST_SEVERITY.ERROR,\n          open: true\n        });\n      } else { this.setState({ filesList }); }\n      if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n        this.setState({ nextNewFileIds: calculateLocalStorageNextNewFileIds(this.state.filesList) });\n      }\n    });\n  };\n\n  componentDidUpdate = (prevProps, prevState) => {\n    if (prevProps.backendModeSignedInStatus !== this.props.backendModeSignedInStatus) {\n      FileStorageSystemClient.doGetFilesList().then(filesListValue => filesListValue ?? {}).then(filesList => {\n        this.setState({\n          ...DEFAULT_STATE,\n          filesList,\n          nextNewFileIds: this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n            ? calculateLocalStorageNextNewFileIds(filesList) : null,\n        });\n      });\n    }\n  };\n  \n  renameInput = ({ inputType, fileId, ...remainingProps }) => {\n    const inputId = getRenameInputIdFunctions[inputType](fileId);\n    const value = this.getRenameInputValueFunctions[inputType](fileId);\n    return (\n      <input\n        id={inputId}\n        defaultValue={value}\n        placeholder={value}\n        disabled={\n          checkNoOpenFileId(fileId) || this.state.renaming.inputType !== inputType ||\n          this.state.renaming.fileId.sourceId !== fileId.sourceId ||\n          this.state.renaming.fileId.viewId !== fileId.viewId\n        }\n        onBlur={() => {\n          this.handleRenameFile(inputType, fileId).then(() => {\n            if (\n              this.state.renaming.inputType === inputType && this.state.renaming.fileId.sourceId === fileId.sourceId &&\n              this.state.renaming.fileId.viewId === fileId.viewId\n            ) { this.handleCancelRenaming(inputType, fileId); }\n          });\n        }}\n        onKeyDown={event => { if (event.key === 'Escape') { this.handleCancelRenaming(inputType, fileId); } }}\n        onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n        {...remainingProps}\n      />\n    );\n  };\n\n  handleFileListClick = (fileId) => {\n    if (fileId === this.state.selectedFileId) {\n      handleSetCurrentOpenFileId({ sourceId:fileId, viewId: 0, viewType: FILE_TYPE.EMPTY}, {sourceName: this.state.filesList[fileId].name, viewName: ''});\n      this.setState({\n        selectedViewId: null,\n        selectedFileOpen: !(this.state.selectedFileOpen)\n      });\n    }else{\n      if(handleSetCurrentOpenFileId({ sourceId:fileId, viewId: 0, viewType: FILE_TYPE.EMPTY}, {sourceName: this.state.filesList[fileId].name, viewName: ''})){\n        this.setState({\n          selectedFileId: fileId,\n          selectedViewId: null,\n          selectedFileOpen: true\n        });\n      }\n    }\n    \n  };\n\n  handleViewListClick = (fileId) => {\n    const fileName = {sourceName: this.getSourceName(fileId), viewName: this.getViewName(fileId)};\n    handleSetCurrentOpenFileId(fileId, fileName);\n    this.setState({\n      selectedViewId: fileId.viewId,\n    });\n  };\n\n  handleEditMenuClick = (event) => {\n    this.setState({\n      editMenuAnchorElement: event.currentTarget\n    })\n  }\n\n  handleEditMenuClose = () => {\n    this.setState({\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleDeleteMenuClick = () => {\n    this.handleEditMenuClose();\n    const fileId = { sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId === null) ? 0 : this.state.selectedViewId}\n    this.handleDeleteFile(fileId).then(success => {\n      if (fileId.viewId !== 0) {\n        this.setState({\n          selectedViewId: null,\n        });\n      }else{\n        this.setState({\n          selectedFileId: null,\n          selectedViewId: null,\n          selectedFileOpen: false\n        });\n      }\n    });\n  }\n\n  handleRenameMenuClick = (event) => {\n    this.setState({\n      renamePopoverElement: this.state.editMenuAnchorElement,\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleRenamePopoverClose = () => {\n    this.setState({\n      renamePopoverElement: null\n    })\n  }\n\n  handleViewMenuOpen = (event) => {\n    this.setState({\n      newViewAnchorElement : this.state.editMenuAnchorElement\n    })\n  }\n\n  handleViewMenuClose = () => {\n    this.setState({\n      newViewAnchorElement : null,\n      editMenuAnchorElement: null\n    })\n  }\n\n  render = () => {\n    const numFiles = countNumFiles(this.state.filesList);\n    const filteredFilesList = this.state.searching ? this.handleDoFileNamesSearch() : this.state.filesList;\n    const numFilteredFiles = countNumFiles(filteredFilesList);\n    return (\n      <div className=\"SidePane\">\n        <div id=\"file_list_container\">\n            <Button\n              variant=\"outlined\"\n              color=\"primary\"\n              endIcon={<AddCircleIcon />}\n              disableElevation\n              id=\"new_document_button\"\n              onClick={() => { this.handleCreateNewFile(FILE_TYPE.SOURCE); }}\n            >\n              New Document\n            </Button>\n          <div className=\"InputRow\" id=\"search_file_names_input_row\">\n            <Input\n              variant=\"outlined\"\n              id={SEARCH_FILE_NAMES_INPUT_ID}\n              startAdornment={\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              }\n              style={{\"width\":\"100%\"}}\n              title=\"Search File Names\"\n              placeholder=\"Search File Names\"\n              onChange={debounce(this.handleChangeSearchingInput, 150)}\n              onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n              onKeyDown={event => { if (event.key === 'Escape') { event.target.blur(); } }}\n            />\n          </div>\n          {\n            Object.keys(filteredFilesList).length > 0\n              ?  <List\n                    component=\"nav\"\n                    aria-labelledby=\"nested-list-subheader\"\n                    subheader={\n                      <ListSubheader component=\"div\" id=\"nested-list-subheader\">\n                        Source Files\n                      </ListSubheader>\n                    }\n                    id={FILE_LIST_ID}\n                    style={{\"maxWidth\" : 360, \"width\" : '100%'}}\n                  >\n                  {\n                    Object.entries(filteredFilesList).map(([sourceId, { views }]) =>\n                    <div>\n                      <ListItem button \n                      key={sourceId} \n                      disableGutters={true}\n                      divider={true}\n                      style={{\"padding\":\"0px\"}}\n                      onClick={() => {this.handleFileListClick(sourceId)}}\n                      >\n                        <FileListItem\n                          fileId={{ sourceId, viewId: 0 }}\n                          selected={sourceId === this.state.selectedFileId}\n                          open={sourceId === this.state.selectedFileId && this.state.selectedFileOpen}\n                          handleEditMenuClick={this.handleEditMenuClick}\n                          childViewsExist={Object.keys(views).length > 0}\n                          fileName={this.getFileName({ sourceId, viewId: 0 })}\n                          renameSelected={this.state.renameSelected}\n                        />\n                      </ListItem>\n                        {\n                          Object.keys(views).length > 0\n                            ? <Collapse in={sourceId === this.state.selectedFileId && this.state.selectedFileOpen} timeout=\"auto\" unmountOnExit>\n                                <List component=\"div\" disablePadding style={{\"borderStyle\": \"none solid solid solid\", \"borderColor\" :\"#3f51b5\", \"borderWidth\": \"thin\", \"borderRadius\": \"4px\"}}>\n                                {\n                                  Object.keys(views).map(viewId => {\n                                    const fileId = { sourceId, viewId, \"viewType\": views[viewId].type };\n                                    return (\n                                      <ListItem button \n                                      key={getFileIdKeyStr(fileId)} \n                                      disableGutters={true}\n                                      divider={true}\n                                      style={{ \"paddingTop\": \"0px\", \"paddingBottom\": \"0px\", \"backgroundColor\": \"transparent\"}}\n                                      onClick={() => {this.handleViewListClick(fileId)}}\n                                      >\n                                      <FileListItem\n                                          fileId={fileId}\n                                          open={viewId === this.state.selectedViewId}\n                                          handleEditMenuClick={this.handleEditMenuClick}\n                                          fileName={this.getFileName(fileId)}\n                                          viewType={views[viewId].type}\n                                          renameSelected={this.state.renameSelected}\n                                          selected={viewId === this.state.selectedViewId}\n                                        />\n                                      </ListItem>\n                                    );\n                                  })\n                                }\n                                </List>\n                              </Collapse>\n                            : null\n                          }\n                          </div>   \n                    )\n                  }\n                </List>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_files_placeholder\">\n                  No Files\n                </div>\n          }\n          <Menu\n            id=\"edit_menu\"\n            anchorEl={this.state.editMenuAnchorElement}\n            keepMounted\n            open={Boolean(this.state.editMenuAnchorElement)}\n            onClose={() => this.handleEditMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n          >\n            {\n              (this.state.selectedViewId === null) ? \n              <MenuItem onClick={() => this.handleViewMenuOpen()}>\n                <ListItemIcon>\n                  <AddIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"New View\" />\n              </MenuItem>\n              : null\n            }\n              <MenuItem onClick={() => this.handleRenameMenuClick()}>\n                <ListItemIcon>\n                  <EditIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Rename\" />\n              </MenuItem>\n              <MenuItem onClick={() => this.handleDeleteMenuClick()}>\n                <ListItemIcon>\n                  <DeleteIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Delete\" />\n              </MenuItem>\n          </Menu>\n          <Menu \n            id=\"viewMenu\"\n            anchorEl={this.state.newViewAnchorElement}\n            keepMounted\n            open={Boolean(this.state.newViewAnchorElement)}\n            onClose={() => this.handleViewMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'left',\n            }}\n          >\n              <MenuItem \n                  onClick={() => {\n                    this.handleViewMenuClose();\n                    this.handleCreateNewFile(FILE_TYPE.TEXT_VIEW);}}\n              >\n                <ListItemIcon>\n                  <TextFieldsIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Text View\" />\n              </MenuItem>\n              <MenuItem\n              onClick={() => {\n                this.handleViewMenuClose();\n                this.handleCreateNewFile(FILE_TYPE.CARD_VIEW);}}\n              >\n                <ListItemIcon>\n                  <AmpStoriesIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Card View\" />\n              </MenuItem>\n          </Menu>\n          <Popover\n            open={Boolean(this.state.renamePopoverElement)}\n            anchorEl={this.state.renamePopoverElement}\n            anchorOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            transformOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            id=\"rename_popover\"\n          >\n            <Input\n              id=\"rename_field\"\n              defaultValue={this.getFileName({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})}\n              onKeyPress={event => {\n                if(event.key === 'Enter') {\n                    this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              onKeyDown={event => {\n                if(event.key === 'Escape') {\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              endAdornment={\n                <InputAdornment position=\"end\">\n                  <IconButton \n                    onClick= {() => {\n                      this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                      this.handleRenamePopoverClose();\n                    }}\n                  >\n                      <CheckIcon/>\n                  </IconButton>\n                </InputAdornment>\n              }\n              disableUnderline={true}\n              fullWidth={true}\n              style={{height:\"50px\", \"paddingLeft\": \"10px\"}}\n            />\n          </Popover>\n          <div\n            className=\"PlaceholderDivWithText\"\n            id=\"filtered_files_placeholder\"\n            hidden={!this.state.searching}>\n            {(numFiles - numFilteredFiles) + ' of ' + (numFiles) + ' files hidden by search'}\n          </div>\n        </div>\n        <div id=\"user_controls_container\">\n          {\n            this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN\n              ? <Button\n                  variant=\"outlined\"\n                  onClick={() => {\n                    if (\n                      this.props.dispatchSetBackendModeSignedInStatusAction(\n                        BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                      )\n                    ) { Cookies.remove(ACCESS_TOKEN_COOKIE_KEY); }\n                  }}>\n                  Sign out\n                </Button>\n              : null\n          }\n          <Button\n            variant=\"outlined\"\n            onClick={() => {\n              if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n                getUserSignedInStatus().then(backendModeSignedInStatus => {\n                  this.handleSwitchBackendModeSignedInStatus(backendModeSignedInStatus);\n                });\n              } else { this.handleSwitchBackendModeSignedInStatus(BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE); }\n            }}>\n            {\n              'Switch to ' +\n              (\n                this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n                  ? 'cloud' : 'local'\n              ) + ' storage'\n            }\n          </Button>\n        </div>\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({\n    currentOpenFileId: state.currentOpenFileId,\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(Navigator);\n","import nearley from 'nearley';\n// Generated automatically by nearley, version undefined\n// http://github.com/Hardmath123/nearley\n/*\nMain -> Expression {% id %}\nExpression -> Expression_ {% id %} | Factor {% id %}\nExpression_ -> Factor _ \"|\" _ Expression {% function(d) { return [d[0], d[2], d[4]] } %}\nFactor -> Factor_ {% id %} | Term {% id %}\nFactor_ -> Term _ \"&\" _ Factor {% function(d) { return [d[0], d[2], d[4]] } %}\nTerm -> Not {% id %} | Nested {% id %} | Tag {% id %}\nNot -> \"!\" (Nested {% id %} | Tag {% id %})\nNested -> \"(\" _ Expression _ \")\" {% function(d) { return d[2] } %}\nTag -> \"#{\" [^{}]:+ \"}\" {% function(d) { return [d[0], d[1].join(\"\"), d[2]].join(\"\") } %}\n_ -> \" \":* {% function(d) { return null } %}\n*/\nfunction id(x) {\n  return x[0];\n}\nconst Grammar = {\n  Lexer: undefined,\n  ParserRules: [\n    { name: \"Main\", symbols: [\"Expression\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Expression_\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Factor\"], postprocess: id },\n    {\n      name: \"Expression_\",\n      symbols: [\"Factor\", \"_\", { literal: \"|\", pos: 30 }, \"_\", \"Expression\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Factor\", symbols: [\"Factor_\"], postprocess: id },\n    { name: \"Factor\", symbols: [\"Term\"], postprocess: id },\n    {\n      name: \"Factor_\",\n      symbols: [\"Term\", \"_\", { literal: \"&\", pos: 60 }, \"_\", \"Factor\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Term\", symbols: [\"Not\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Tag\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Tag\"], postprocess: id },\n    {\n      name: \"Not\",\n      symbols: [{ literal: \"!\", pos: 92 }, \"Not$subexpression$1\"],\n    },\n    {\n      name: \"Nested\",\n      symbols: [\n        { literal: \"(\", pos: 110 },\n        \"_\",\n        \"Expression\",\n        \"_\",\n        { literal: \")\", pos: 118 },\n      ],\n      postprocess: function(d) {\n        return d[2];\n      },\n    },\n    {\n      name: \"Tag$string$1\",\n      symbols: [{ literal: \"#\" }, { literal: \"{\" }],\n      postprocess: function joiner(d) {\n        return d.join(\"\");\n      },\n    },\n    { name: \"Tag$ebnf$1\", symbols: [/[^{}]/] },\n    {\n      name: \"Tag$ebnf$1\",\n      symbols: [/[^{}]/, \"Tag$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"Tag\",\n      symbols: [\"Tag$string$1\", \"Tag$ebnf$1\", { literal: \"}\", pos: 131 }],\n      postprocess: function(d) {\n        return d[1].join(\"\").trim();\n      },\n    },\n    { name: \"_$ebnf$1\", symbols: [] },\n    {\n      name: \"_$ebnf$1\",\n      symbols: [{ literal: \" \", pos: 139 }, \"_$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"_\",\n      symbols: [\"_$ebnf$1\"],\n      postprocess: function(d) {\n        return null;\n      },\n    },\n  ],\n  ParserStart: \"Main\",\n};\nexport const parse = (inputText, throwErrors = true) => {\n  let outputParsedExpr = null;\n  if (inputText) {\n    const parser = new nearley.Parser(nearley.Grammar.fromCompiled(Grammar));\n    try {\n      parser.feed(inputText.trim());\n      if (parser.results.length > 0) {\n        outputParsedExpr = parser.results;\n      }\n    } catch (ex) {}\n  }\n  return outputParsedExpr;\n};\n","import React from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport {connect} from 'react-redux';\nimport {setBackendModeSignedInStatusAction} from '../reducers/BackendModeSignedInStatus';\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\nimport DescriptionIcon from '@material-ui/icons/Description';\nimport Link from '@material-ui/core/Link';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport AmpStoriesIcon from '@material-ui/icons/AmpStories';\nimport {\n\tFILE_TYPE,\n\tcheckNoOpenFileId,\n\tcheckSourceFileId,\n\tcheckViewFileId,\n\tNO_OPEN_FILE_ID\n} from '../util/FileIdAndTypeUtils';\nimport Button from '@material-ui/core/Button';\nimport SaveIcon from '@material-ui/icons/Save';\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport {parse as parseTagFilters} from '../lib/TagFiltersGrammar';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\nimport {TagFilteringPluginKey} from '../editor_extension/plugins/TagFiltering';\nimport {Selection, TextSelection} from 'prosemirror-state';\nimport {defer} from 'lodash';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\nimport store from \"../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE, SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../reducers/CurrentOpenFileState\";\n\nconst TAG_FILTERS_INPUT_ID = 'tag_filters_input';\n\nconst DEFAULT_STATE = {\n\tmodifyingTagFilters: false,\n\tcurrentTagFiltersStr: '',\n\tcurrentParsedTagFiltersStr: '',\n\tsourceSavedTagFilters: {},\n};\n\nclass Navbar extends React.Component {\n\tstate = DEFAULT_STATE;\n\t\n\thandleSave = () => {\n    store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE })\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tFileStorageSystemClient.doSaveSourceContent(\n\t\t\t\tBlockTaggingEditorExtension.editor.value(true),\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t).then(success => {\n\t\t\t\tif (success) {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved source file\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Failed to save source file\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\t\topen: true\n          });\n          store.dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (checkViewFileId(this.props.currentOpenFileId) && this.props.currentOpenFileId.viewType !== NO_OPEN_FILE_ID.viewType) {\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tthis.props.currentOpenFileId.viewType,\n\t\t\t\tfalse,\n\t\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"View saved\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n          this.props.dispatchSetToastAction({\n            message: \"Failed to save view\",\n            severity: TOAST_SEVERITY.ERROR,\n            open: true\n          });\n          store.dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE });\n        });\n\t\t}\n\t}\n\t\n\thandleCancelModifyingTagFilters = () => {\n\t\tconst input = document.getElementById(TAG_FILTERS_INPUT_ID);\n\t\tinput.value = this.state.currentTagFiltersStr;\n\t\tthis.setState({ modifyingTagFilters: false });\n\t};\n\t\n\thandleStartModifyingTagFilters = () => {\n\t\tthis.setState({ modifyingTagFilters: true });\n\t\tdefer(() => {\n\t\t\tconst input = document.getElementById(TAG_FILTERS_INPUT_ID);\n\t\t\tinput.focus();\n\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t});\n\t};\n\t\n\thandleUnpersistCurrentTagFilters = () => {\n\t\tif (\n\t\t\t!this.state.currentTagFiltersStr ||\n\t\t\t!this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr)\n\t\t) { return false; }\n\t\tconst newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n\t\tdelete newSourceSavedTagFilters[this.state.currentTagFiltersStr];\n\t\tFileStorageSystemClient.doSetSourceSavedTagFilters(\n\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\tnewSourceSavedTagFilters,\n\t\t).then(success => {\n\t\t\tif (!success) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to set source saved tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n\t\t});\n\t};\n\t\n\thandlePersistNewSavedTagFilters = () => {\n\t\tif (\n\t\t\t!this.state.currentTagFiltersStr ||\n\t\t\tthis.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr)\n\t\t) { return false; }\n\t\tconst newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n\t\tnewSourceSavedTagFilters[this.state.currentTagFiltersStr] = this.state.currentParsedTagFiltersStr;\n\t\tFileStorageSystemClient.doSetSourceSavedTagFilters(\n\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\tnewSourceSavedTagFilters,\n\t\t).then(success => {\n\t\t\tif (!success) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to set source saved tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n\t\t});\n\t};\n\t\n\thandleApplyTagFilters = () => {\n\t\tlet tagFilters = null;\n\t\tconst tagFiltersStr = document.getElementById(TAG_FILTERS_INPUT_ID).value.trim();\n\t\tif (tagFiltersStr) {\n\t\t\ttagFilters = parseTagFilters(tagFiltersStr);\n\t\t\tif (!tagFilters) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Invalid tag filters\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = tagFiltersStr;\n\t\tconst parsedTagFiltersStr = JSON.stringify(tagFilters);\n\t\tconst oldParsedTagFiltersStr = this.state.currentParsedTagFiltersStr;\n\t\tthis.setState({ currentTagFiltersStr: tagFiltersStr, currentParsedTagFiltersStr: parsedTagFiltersStr });\n\t\tif (parsedTagFiltersStr === oldParsedTagFiltersStr) { return true; }\n\t\tif(BlockTaggingEditorExtension.editor !== undefined){\n\t\t\tBlockTaggingEditorExtension.editor.view.dispatch(\n\t\t\t\tBlockTaggingEditorExtension.editor.view.state.tr.setMeta(TagFilteringPluginKey, tagFilters)\n\t\t\t\t\t.setSelection(\n\t\t\t\t\t\ttagFilters\n\t\t\t\t\t\t\t? TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0)\n\t\t\t\t\t\t\t: Selection.atStart(BlockTaggingEditorExtension.editor.view.state.doc)\n\t\t\t\t\t).scrollIntoView()\n\t\t\t);\n\t\t\tdefer(() => {\n\t\t\t\tif (tagFilters) { BlockTaggingEditorExtension.editor.view.dom.blur(); }\n\t\t\t\telse { BlockTaggingEditorExtension.editor.view.focus(); }\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t};\n\t\n\tchangeFile = async () => {\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tFileStorageSystemClient.doGetSourceSavedTagFilters(this.props.currentOpenFileId.sourceId)\n\t\t\t\t.then(sourceSavedTagFilters => {\n\t\t\t\t\tif (!sourceSavedTagFilters) {\n\t\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\t\tmessage: \"Failed to retrieve source saved tag filters\",\n\t\t\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\t\t\topen: true\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet filters = {}\n\t\t\t\t\t\tsourceSavedTagFilters.forEach(element => {\n\t\t\t\t\t\t\tfilters[element] = element;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setState({sourceSavedTagFilters: filters});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile();\n\t};\n\t\n\tcomponentDidUpdate = prevProps => {\n\t\tif(this.props.currentOpenFileName.viewName === '' && prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId){\n\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = \"\";\n\t\t\tthis.handleApplyTagFilters();\n\t\t\tthis.setState({ sourceSavedTagFilters: {} });\n\t\t\tthis.changeFile();\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tconst noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n\t\tconst currentTagFiltersSaved =this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentTagFiltersStr);\n\t\treturn(\n\t\t\t<AppBar position=\"static\" class=\"custom-navbar\">\n\t\t\t\t<Toolbar>\n\t\t\t\t\t<img className={\"menuButton\"} src={require('../images/logo.png')} style={{width: \"40px\", marginRight: \"10px\"}} alt={\"MENU\"}/>\n\t\t\t\t\t<Typography variant=\"h5\" style={{fontFamily:\"Bungee\", color:\"#F5F0E1\"}}>\n\t\t\t\t\t\tYADA\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<div style={{flexGrow: 1, marginLeft: \"150px\"}}>\n\t\t\t\t\t\t{this.props.currentOpenFileName.sourceName === '' ? null :\n\t\t\t\t\t\t\t<Breadcrumbs aria-label=\"breadcrumb\" color=\"secondary\" style={{marginRight: \"10px\", float: \"left\", border:\"1px solid #F5F0E1\", borderRadius: \"10px\", padding: \"8px\"}}>\n\t\t\t\t\t\t\t\t<Link color=\"inherit\" style={{ color: \"#F5F0E1\",}}>\n\t\t\t\t\t\t\t\t\t<DescriptionIcon color=\"secondary\"/>\n\t\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.sourceName.length <= 11 ?  this.props.currentOpenFileName.sourceName : (this.props.currentOpenFileName.sourceName.substring(0,11) + \"...\")}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.viewName === '' ? null :\n\t\t\t\t\t\t\t\t\t<Link color=\"inherit\" style={{color: \"#F5F0E1\"}}>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t(this.props.currentOpenFileId.viewType === FILE_TYPE.CARD_VIEW) ?\n\t\t\t\t\t\t\t\t\t\t\t\t<AmpStoriesIcon color=\"secondary\"/>:\n\t\t\t\t\t\t\t\t\t\t\t\t(this.props.currentOpenFileId.viewType === FILE_TYPE.TEXT_VIEW) ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TextFieldsIcon color=\"secondary\"/> :\n\t\t\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t{this.props.currentOpenFileName.viewName}\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</Breadcrumbs>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\ttitle=\"save\"\n\t\t\t\t\t\t\tdisabled={noOpenFileIdCheck || !this.props.saveDirtyFlag}\n\t\t\t\t\t\t\tonClick={this.handleSave}\n\t\t\t\t\t\t\tstartIcon={<SaveIcon />}\n\t\t\t\t\t\t\tstyle= {{ borderRadius: \"10px\",paddingTop: \"8px\", paddingBottom: \"8px\", float: \"left\"}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.props.currentOpenFileName.viewName === '' ?\n\t\t\t\t\t\t\t\t<div style={{backgroundColor: \"rgba(245, 240, 225, 0.8)\", marginLeft: \"250px\", width: \"50vw\", borderRadius: \"10px\", padding: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t<Grid container>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={1}>\n\t\t\t\t\t\t\t\t\t\t\t<div style={{marginTop: \"3px\", marginLeft: \"20px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t<SearchIcon color=\"primary\"/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={10}>\n\t\t\t\t\t\t\t\t\t\t\t<Autocomplete\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.currentTagFiltersStr}\n\t\t\t\t\t\t\t\t\t\t\t\tid={TAG_FILTERS_INPUT_ID}\n\t\t\t\t\t\t\t\t\t\t\t\tfreeSolo\n\t\t\t\t\t\t\t\t\t\t\t\toptions={Object.entries(this.state.sourceSavedTagFilters)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map(([tagFiltersStr, _parsedTagFiltersStr]) => tagFiltersStr)}\n\t\t\t\t\t\t\t\t\t\t\t\trenderInput={(params) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...params}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search with Tags: ( #{tag1} | !( #{tag2} ) ) & #{tag3}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{margin:\"0%\"}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"standard\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(event, value, reason) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({currentTagFiltersStr : value});\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleStartModifyingTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (reason === 'clear'){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = '';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleApplyTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tonBlur={event => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (this.handleApplyTagFilters()) { this.setState({ modifyingTagFilters: false }); }\n\t\t\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst input = event.target;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefer(() => { input.focus(); });\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyDown={event => { if (event.key === 'Escape') { this.handleCancelModifyingTagFilters(); } }}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={1}>\n\t\t\t\t\t\t\t\t\t\t\t<div style={{float: \"right\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t{ (this.state.modifyingTagFilters) ? null :\n\t\t\t\t\t\t\t\t\t\t\t\t\t(this.state.currentTagFiltersStr === '') ? null :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(currentTagFiltersSaved) ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton title=\"Unpersist Filter\" style={{padding: \"0px\", paddingRight: \"10px\", paddingTop: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<RemoveCircleIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(TAG_FILTERS_INPUT_ID).value = \"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleUnpersistCurrentTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleApplyTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton> :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton title=\"Persist Filter\" style={{padding: \"0px\", paddingRight: \"10px\", paddingTop: \"5px\"}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SaveIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handlePersistNewSavedTagFilters();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\taria-label=\"account of current user\"\n\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\tstyle={{float: \"right\"}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AccountCircleIcon color=\"secondary\"/>\n\t\t\t\t\t</IconButton>\n\t\t\t\t</Toolbar>\n\t\t\t</AppBar>\n\t\t)\n\t}\n}\n\nexport default connect(\n\tstate => ({\n\t\tcurrentOpenFileId: state.currentOpenFileId,\n\t\tcurrentOpenFileName: state.currentOpenFileName,\n\t\tbackendModeSignedInStatus: state.backendModeSignedInStatus,\n\t\ttagsInView: state.tagsInView,\n\t\tsaveDirtyFlag: state.saveDirtyFlag\n\t}),\n\tdispatch => ({\n\t\tdispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(Navbar);\n","import React from 'react';\nimport RichMarkdownEditor from 'rich-markdown-editor';\nimport BootstrapCard from 'react-bootstrap/Card';\nimport ReactCardFlip from 'react-card-flip';\n\nclass Card extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tisFlipped: false,\n\t\t\tkey: this.props.content[\"index\"],\n\t\t\tfront: this.props.content[\"front\"],\n\t\t\tback: this.props.content[\"back\"]\n\t\t};\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.createBootstrapCard = this.createBootstrapCard.bind(this);\n\t}\n\t\n\thandleClick(e) {\n\t\te.preventDefault();\n\t\tthis.setState(prevState => ({ isFlipped: !prevState.isFlipped }));\n\t}\n\t\n\tcreateBootstrapCard(key, json) {\n\t\treturn (\n\t\t\t<BootstrapCard\n\t\t\t\tkey={key}\n\t\t\t\ttext=\"black\"\n\t\t\t\tclassName=\"BootstrapCard\"\n\t\t\t\tonClick={this.handleClick}\n\t\t\t>\n\t\t\t\t{\n\t\t\t\t\tjson &&\n\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\tclassName=\"Card\"\n\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\tkey={`card${key}`}\n\t\t\t\t\t\tdefaultValue={JSON.stringify(json)}\n\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</BootstrapCard>\n\t\t);\n\t}\n\t\n\trender = () => {\n\t\tconst content = this.props.content;\n\t\tif (content !== undefined) {\n\t\t\tconst key = content[\"index\"];\n\t\t\tconst front = content[\"front\"];\n\t\t\tconst back = content[\"back\"];\n\t\t\treturn (\n\t\t\t\t<ReactCardFlip isFlipped={this.state.isFlipped} flipDirection=\"vertical\">\n\t\t\t\t\t{this.createBootstrapCard(key, front)}\n\t\t\t\t\t{this.createBootstrapCard(key, back)}\n\t\t\t\t</ReactCardFlip>\n\t\t\t);\n\t\t} else { return null; }\n\t};\n}\n\nexport default Card;\n","import styled from 'styled-components'\nimport React from 'react';\nimport {Droppable, Draggable} from 'react-beautiful-dnd';\nimport {THEME} from \"../../App\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport {TAG_HOLDERS} from \"./TagEditor\";\n\nclass Tag extends React.Component {\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-bottom: 8px;\n\t\t\tbackground-color: ${props => (props.isDragging ? THEME.palette.secondary.dark : THEME.palette.secondary.light)};\n\t\t`;\n\t\tconst TagId = styled.h5``;\n\t\tconst Content = styled.div``\n\t\treturn (\n\t\t\t<Draggable draggableId={this.props.tagId} index={this.props.index}>\n\t\t\t\t{(provided, snapshot) => (\n\t\t\t\t\t<Container\n\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t{...provided.draggableProps}\n\t\t\t\t\t\t{...provided.dragHandleProps}\n\t\t\t\t\t\tisDragging={snapshot.isDragging}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TagId>{this.props.tagInfo[\"tag_name\"]}</TagId>\n\t\t\t\t\t\t<Content>{this.props.tagInfo.preview}</Content>\n\t\t\t\t\t</Container>\n\t\t\t\t)}\n\t\t\t</Draggable>\n\t\t);\n\t};\n}\n\nclass InnerTagList extends React.Component {\n\t// performance optimization to prevent unnecessary renders\n\tshouldComponentUpdate(nextProps, nextState, nextContext) {\n\t\treturn nextProps.tagData !== this.props.tagData;\n\t}\n\t\n\trender() {\n\t\tconsole.log(this.props);\n\t\tconst tagList = [];\n\t\tconst tagIds = Object.keys(this.props.tagData);\n\t\tfor (let i = 0; i < tagIds.length; ++i) {\n\t\t\tconst tagId = tagIds[i];\n\t\t\ttagList.push(<Tag key={tagId} tagId={tagId} index={i} tagInfo={this.props.tagData[tagId]}/>);\n\t\t\tif (this.props.viewType === FILE_TYPE.CARD_VIEW && this.props.columnId === TAG_HOLDERS.IN_VIEW) {\n\t\t\t\tif (i % 2 === 1 && i !== tagIds.length-1) {\n\t\t\t\t\ttagList.push(\n\t\t\t\t\t\t<hr style={{ color: THEME.palette.primary.main, backgroundColor: THEME.palette.primary.main, height: 1 }} />\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tagList;\n\t}\n}\n\nclass DragDropColumn extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// used to maintain scroll when rendering updates to tag list\n\t\tthis.tagListRef = React.createRef();\n\t}\n\t\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\tconst list = this.tagListRef.current;\n\t\treturn list.scrollHeight - list.scrollTop;\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot !== null) {\n\t\t\tconst list = this.tagListRef.current;\n\t\t\tlist.scrollTop = list.scrollHeight - snapshot;\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-top: 10px;\n\t\t\tmargin-bottom: 10px;\n\t\t\ttransition: background-color 0.2s ease;\n\t\t\tbackground-color: ${props => (props.isDraggingOver) ? THEME.palette.grey[300] : THEME.palette.grey[100]};\n\t\t`;\n\t\tconst Title = styled.h3`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst DroppableRegion = styled.div`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst TagList = styled.div`\n\t\t\toverflow-x: hidden;\n\t\t\toverflow-y: auto;\n\t\t\theight: 200px;\n\t\t\tpadding-bottom: 30px;\n\t\t`;\n\n\t\treturn (\n\t\t\t<Droppable droppableId={this.props.column.id}>\n\t\t\t\t{(provided, snapshot) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Container isDraggingOver={snapshot.isDraggingOver}>\n\t\t\t\t\t\t\t<Title>{this.props.column.title}</Title>\n\t\t\t\t\t\t\t\t<DroppableRegion\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<TagList ref={this.tagListRef}>\n\t\t\t\t\t\t\t\t\t\t<InnerTagList viewType={this.props.viewType} columnId={this.props.column.id} tagData={this.props.tagData}/>\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\n\t\t\t\t\t\t\t\t\t</TagList>\n\t\t\t\t\t\t\t\t</DroppableRegion>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</Droppable>\n\t\t);\n\t};\n}\n\nexport default DragDropColumn;\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport DragDropColumn from './DragDropColumn';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport {DragDropContext} from 'react-beautiful-dnd';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport {SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\n\nexport const TAG_HOLDERS = {\n\tAVAILABLE: \"tags_available\",\n\tIN_VIEW: \"tags_in_view\"\n}\n\nclass TagEditor extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\n\t\t// parse nodes to obtain preview\n\t\tfunction getPreview(node) {\n\t\t\tfor (let i = 0; i < node.content.length; ++i) {\n\t\t\t\tconst contentNode = node.content[i];\n\t\t\t\tif (contentNode.type === \"text\") {\n\t\t\t\t\treturn contentNode.text;\n\t\t\t\t} else if (contentNode) {\n\t\t\t\t\tconst recurseResponse = getPreview(contentNode);\n\t\t\t\t\tif (recurseResponse !== \"\") return recurseResponse;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t}\n\t\t\n\t\tconst tagData = this.props.allTagsData;\n\t\tObject.keys(tagData).forEach(tagId => {\n\t\t\tconst preview = getPreview(tagData[tagId].content);\n\t\t\tconst maxPreviewLength = 50;\n\t\t\ttagData[tagId][\"preview\"] = preview.substring(0, maxPreviewLength);\n\t\t\tif (preview.length > maxPreviewLength) {\n\t\t\t\ttagData[tagId][\"preview\"] += \" . . .\";\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.state = {\n\t\t\ttagData: tagData,\n\t\t\tcolumns: {\n\t\t\t\ttags_in_view: {\n\t\t\t\t\tid: TAG_HOLDERS.IN_VIEW,\n\t\t\t\t\ttitle: \"Tags in View\",\n\t\t\t\t\ttagIds: this.props.tagsInView\n\t\t\t\t},\n\t\t\t\ttags_available: {\n\t\t\t\t\tid: TAG_HOLDERS.AVAILABLE,\n\t\t\t\t\ttitle: \"Available Tags\",\n\t\t\t\t\ttagIds: availableTags\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumnOrder: ['tags_in_view', 'tags_available']\n\t\t};\n\t}\n\t\n\tonDragEnd = result => {\n\t\tconst { destination, source, draggableId } = result;\n\t\tif (!destination) return;\n\t\tif (destination.droppableId === source.droppableId && destination.index === source.index) return;\n\t\t\n\t\tlet newState = {}\n\t\tif (destination.droppableId === source.droppableId) {\n\t\t\tconst column = this.state.columns[source.droppableId]\n\t\t\tconst newTagIds = Array.from(column.tagIds);\n\t\t\tnewTagIds.splice(source.index, 1);\n\t\t\tnewTagIds.splice(destination.index, 0, draggableId)\n\t\t\t\n\t\t\tconst newColumn = {\n\t\t\t\t...column,\n\t\t\t\ttagIds: newTagIds\n\t\t\t}\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newColumn.id]: newColumn\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tconst start = this.state.columns[source.droppableId];\n\t\t\tconst finish = this.state.columns[destination.droppableId];\n\t\t\tconst startTagIds = Array.from(start.tagIds);\n\t\t\tstartTagIds.splice(source.index, 1);\n\t\t\tconst newStart = {\n\t\t\t\t...start,\n\t\t\t\ttagIds: startTagIds\n\t\t\t};\n\t\t\t\n\t\t\tconst finishTagIds = Array.from(finish.tagIds);\n\t\t\tfinishTagIds.splice(destination.index, 0, draggableId);\n\t\t\tconst newFinish = {\n\t\t\t\t...finish,\n\t\t\t\ttagIds: finishTagIds\n\t\t\t};\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newStart.id]: newStart,\n\t\t\t\t\t[newFinish.id]: newFinish\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis.props.setTagsInView(newState.columns.tags_in_view.tagIds);\n\t\tthis.setState(newState);\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tif (!this.props.saveDirtyFlag) { this.props.dispatchSetSaveDirtyFlagAction(); }\n\t\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\tconst newState = Object.assign({}, this.state);\n\t\t\tnewState.columns.tags_in_view.tagIds = tagsInView;\n\t\t\tnewState.columns.tags_available.tagIds = availableTags;\n\t\t\tthis.setState(newState);\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\treturn (\n\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\n\t\t\t\t<Container>\n\t\t\t\t\t<Row className=\"justify-content-md-center\">\n\t\t\t\t\t\t{this.state.columnOrder.map(columnId => {\n\t\t\t\t\t\t\tconst column = this.state.columns[columnId];\n\t\t\t\t\t\t\t// Generate subdict here\n\t\t\t\t\t\t\tlet tagDataInColumn = {};\n\t\t\t\t\t\t\tfor (const tagId of column.tagIds) {\n\t\t\t\t\t\t\t\ttagDataInColumn[tagId] = this.state.tagData[tagId];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Col key={column.id} md=\"12\" lg=\"6\">\n\t\t\t\t\t\t\t\t\t<DragDropColumn\n\t\t\t\t\t\t\t\t\t\tviewType={this.props.viewType}\n\t\t\t\t\t\t\t\t\t\tkey={column.id}\n\t\t\t\t\t\t\t\t\t\tcolumn={column}\n\t\t\t\t\t\t\t\t\t\ttagData={tagDataInColumn}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</DragDropContext>\n\t\t);\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, saveDirtyFlag: state.saveDirtyFlag }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE })\n\t}),\n)(TagEditor);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './CardDeck.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from './Card';\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport {setToastAction, TOAST_SEVERITY} from \"../../reducers/Toast\";\nimport store from \"../../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\n\n\nclass CardDeck extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.CARD_VIEW,\n\t\t\t\tfalse,\n\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved view\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => this.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to save view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t}));\n\t\t}\n\t};\n\t\n\tconstructDoc = (tagId) => {\n\t\tconst node = this.state.allTagsData[tagId][\"content\"];\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": [node]\n\t\t};\n\t};\n\t\n\tconstructCard = (index) => {\n\t\tconst cardContent = { \"index\": index };\n\t\tcardContent[\"front\"] = this.constructDoc(this.props.tagsInView[index]);\n\t\tif (index + 1 < this.props.tagsInView.length) {\n\t\t\tcardContent[\"back\"] = this.constructDoc(this.props.tagsInView[index+1]);\n\t\t} else { cardContent[\"back\"] = null; }\n\t\treturn <Card content={cardContent} />;\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Card Deck ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\tconst cards = [];\n\t\t\tfor (let i = 0; i < this.props.tagsInView.length; i+=4) {\n\t\t\t\tcards.push(\n\t\t\t\t\t<Row key={`row_${i%4}`} className=\"justify-content-md-center\">\n\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t{this.constructCard(i)}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t{(i + 2 < this.props.tagsInView.length) && this.constructCard(i + 2)}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<TagEditor viewType={FILE_TYPE.CARD_VIEW} allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t{cards}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(CardDeck);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './TextView.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport RichMarkdownEditor from \"rich-markdown-editor\";\nimport {setToastAction, TOAST_SEVERITY} from \"../../reducers/Toast\";\nimport store from \"../../store\";\nimport {CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE} from \"../../reducers/CurrentOpenFileState\";\n\n\nclass TextView extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.TEXT_VIEW,\n\t\t\t\tfalse,\n\t\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\t\tmessage: \"Saved view\",\n\t\t\t\t\t\tseverity: TOAST_SEVERITY.SUCCESS,\n\t\t\t\t\t\topen: true\n\t\t\t\t\t});\n\t\t\t\t\tstore.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n\t\t\t\t})\n\t\t\t\t.catch(() => this.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to save view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t}));\n\t\t}\n\t};\n\t\n\tconstructTextView = () => {\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": this.props.tagsInView.map(t => this.state.allTagsData[t][\"content\"])\n\t\t};\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Text View ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<TagEditor viewType={FILE_TYPE.TEXT_VIEW} allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.props.tagsInView.length > 0 &&\n\t\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\t\tclassName=\"TextViewEditor\"\n\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\tkey={\"text_view\"}\n\t\t\t\t\t\t\tdefaultValue={JSON.stringify(this.constructTextView())}\n\t\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(TextView);\n","import './ViewEditor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {\n\tFILE_TYPE,\n\tNO_OPEN_FILE_ID\n} from \"../util/FileIdAndTypeUtils\";\nimport FileStorageSystemClient from \"../backend/FileStorageSystemClient\";\nimport {handleSetCurrentOpenFileId} from \"./Navigator\";\nimport CardDeck from \"./CardView/CardDeck\";\nimport TextView from \"./TextView/TextView\";\nimport {setTagsInViewAction} from \"../reducers/SetTagsInView\";\nimport {setToastAction, TOAST_SEVERITY} from \"../reducers/Toast\";\n\nconst DEFAULT_STATE = {\n\tsourceId: 0,\n\tviewId: 0,\n\tdata: null,\n\tfileType: FILE_TYPE.EMPTY\n};\n\nclass ViewEditor extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = async () => {\n\t\tFileStorageSystemClient.doGetView(this.props.currentOpenFileId).then(value => {\n\t\t\tif (value === null) {\n\t\t\t\tthis.props.dispatchSetToastAction({\n\t\t\t\t\tmessage: \"Failed to retrieve view\",\n\t\t\t\t\tseverity: TOAST_SEVERITY.ERROR,\n\t\t\t\t\topen: true\n\t\t\t\t})\n\t\t\t\thandleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n\t\t\t} else {\n\t\t\t\tthis.props.setTagsInView([]); // clear any tagsInView currently stored\n\t\t\t\tthis.setState({\n\t\t\t\t\tsourceId: this.props.currentOpenFileId.sourceId,\n\t\t\t\t\tviewId: this.props.currentOpenFileId.viewId,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttagsInView: value[\"view\"][\"order\"],\n\t\t\t\t\t\tallTagsData: value[\"tags\"][\"items\"]\n\t\t\t\t\t},\n\t\t\t\t\tfileType: this.props.currentOpenFileId.viewType\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile().then(() => console.log(\"Mounted view file\"));\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile().then(() => console.log(\"Updated view file\"));\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tif (this.state.fileType === FILE_TYPE.CARD_VIEW) {\n\t\t\treturn <CardDeck data={this.state.data}/>;\n\t\t} else if (this.state.fileType === FILE_TYPE.TEXT_VIEW) {\n\t\t\treturn <TextView data={this.state.data}/>;\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default connect(\n\tstate => ({ currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({\n\t\tsetTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)),\n\t\tdispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n\t}),\n)(ViewEditor);\n\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport SourceEditorWithTagFilters from \"./SourceEditorWithTagFiltersInput\";\nimport {\n\tcheckSourceFileId,\n\tcheckViewFileId,\n\tFILE_TYPE,\n} from \"../util/FileIdAndTypeUtils\";\nimport ViewEditor from \"./ViewEditor\";\n\nconst DEFAULT_STATE = {\n\tfileType: FILE_TYPE.EMPTY,\n};\n\nclass EditorManager extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = () => {\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.SOURCE});\n\t\t} else if (checkViewFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.CARD_VIEW});\n\t\t} else {\n\t\t\tthis.setState({fileType: FILE_TYPE.EMPTY});\n\t\t}\n\t};\n\t\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile();\n\t};\n\t\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile();\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\treturn (\n\t\t\t<div className=\"MainPane\">\n\t\t\t\t<div className=\"editor_container\">\n\t\t\t\t\t{\n\t\t\t\t\t\t(this.state.fileType === FILE_TYPE.EMPTY) ?\n\t\t\t\t\t\t\t<div className=\"placeholder_editor\">\n\t\t\t\t\t\t\t\t<h5>Click or create a new document from the left pane</h5>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t:\n\t\t\t\t\t\t(this.state.fileType === FILE_TYPE.SOURCE) ?\n\t\t\t\t\t\t\t<SourceEditorWithTagFilters /> : <ViewEditor/>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n};\n\nexport default connect(state => ({ currentOpenFileId: state.currentOpenFileId, currentOpenFileName: state.currentOpenFileName }))(EditorManager);\n","import './App.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from './reducers/BackendModeSignedInStatus';\nimport LandingPage from './components/LandingPage';\nimport Navigator from './components/Navigator';\nimport Navbar from './components/Navbar';\nimport EditorManager from \"./components/EditorManager\";\nimport \"./components/LandingPage.css\"\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport {setToastAction, TOAST_CLEAR, TOAST_DURATION_MS} from \"./reducers/Toast\";\n\nexport const THEME = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#1E3D59'\n    },\n    secondary: {\n      main: '#F5F0E1'\n    }\n  }\n});\n\nclass App extends React.Component {\n\n  state = { mounted: false };\n\n  handleCloseToast = () => {\n    this.props.dispatchSetToastAction(TOAST_CLEAR);\n  }\n  \n  componentDidMount = () => {\n    if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      getUserSignedInStatus().then(backendModeSignedInStatus => {\n        this.props.dispatchSetBackendModeSignedInStatusAction(backendModeSignedInStatus);\n        this.setState({ mounted: true });\n      });\n    } else { this.setState({ mounted: true }); }\n  };\n  \n  render = () =>\n    <MuiThemeProvider theme={THEME}>\n    <React.Fragment>\n      {\n        this.state.mounted\n          ? (\n              this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                ? <div className=\"App\">\n                    <div style={{flex: \"0 1 auto\"}}>\n                      <Navbar />\n                    </div>\n                      <div style={{flex: \"1 1 auto\", display: \"flex\"}}>\n                        <div style={{float: \"left\"}}>\n                            <Navigator />\n                        </div>\n                        <div style={{flexGrow: \"100\"}}>\n                            <EditorManager/>\n                        </div>\n                        {/*Global Snackbar: used for display toast messages to user*/}\n                        <Snackbar open={this.props.toast.open} autoHideDuration={TOAST_DURATION_MS} onClose={this.handleCloseToast}>\n                          <MuiAlert onClose={this.handleCloseToast} elevation={6} severity={this.props.toast.severity}>\n                            {this.props.toast.message}\n                          </MuiAlert>\n                        </Snackbar>\n                      </div>\n                    </div>\n                : <LandingPage />\n            )\n          : null\n      }\n      {/* <div className=\"NoApp\">\n        This app doesn't support mobile screen widths.\n      </div> */}\n    </React.Fragment>\n    </MuiThemeProvider>\n};\n\nexport default connect(\n  state => ({\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n    currentOpenFileId: state.currentOpenFileId,\n    currentOpenFileName: state.currentOpenFileName,\n    toast: state.toast,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n    dispatchSetToastAction: toast => dispatch(setToastAction(toast)),\n  }),\n)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: {'Service-Worker': 'script'},\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport {render} from 'react-dom';\nimport {Provider} from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport store from './store';\nimport * as serviceWorker from './serviceWorker';\n\nrender(\n  <React.StrictMode>\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap\" />\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" />\n    <link href=\"https://fonts.googleapis.com/css2?family=Bungee&display=swap\" rel=\"stylesheet\" /> \n    <link href=\"https://fonts.googleapis.com/css2?family=Signika:wght@300&display=swap\" rel=\"stylesheet\"></link>\n    <Provider store={store}>\n      <App/>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}