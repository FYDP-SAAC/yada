(this.webpackJsonpYADA=this.webpackJsonpYADA||[]).push([[0],{104:function(e,t,n){},225:function(e,t,n){e.exports=n(490)},234:function(e,t,n){},235:function(e,t,n){},254:function(e,t,n){e.exports=n.p+"static/media/logo.e9d28ab1.png"},255:function(e,t,n){e.exports=n.p+"static/media/darkLogo.eccc7628.png"},256:function(e,t,n){e.exports=n.p+"static/media/graphic.2ab501e2.png"},257:function(e,t,n){},258:function(e,t,n){},486:function(e,t,n){},487:function(e,t,n){},488:function(e,t,n){},489:function(e,t,n){},490:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),i=n(23),c=(n(234),n(18)),s=n(20),l=n(19),u=(n(235),{SOURCE:"SOURCE",TEXT_VIEW:"TEXT_VIEW",CARD_VIEW:"CARD_VIEW",EMPTY:"NON_EXISTENT"}),d={sourceId:0,viewId:0,viewType:u.EMPTY},p=function(e){return e.hasOwnProperty("sourceId")&&e.hasOwnProperty("viewId")},f=function(e){return e.hasOwnProperty("fileId")&&p(e.fileId)},m=function(e){return p(e)&&!e.sourceId&&!e.viewId},g=function(e){return p(e)&&e.sourceId&&!e.viewId},v=function(e){return p(e)&&e.sourceId&&e.viewId},h=function(e){return p(e)?e.sourceId+(e.viewId?"#"+e.viewId:""):""},w=n(5),I=n.n(w),b=n(13),S=n(30),y=n.n(S),O=n(7),E=function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a,r,o=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:7500,r=new AbortController,setTimeout((function(){r.abort()}),a),e.next=5,fetch(t,Object(O.a)(Object(O.a)({},n),{},{signal:r.signal})).then((function(e){return e.ok||console.log(e),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k="https://yaas.azurewebsites.net/",F={USER_SIGNED_IN:"USER_SIGNED_IN",USER_SIGNED_OUT:"USER_SIGNED_OUT",LOCAL_STORAGE:"LOCAL_STORAGE"},j=function(){var e=Object(b.a)(I.a.mark((function e(){var t,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=y.a.get("access_token"))){e.next=14;break}return e.prev=2,e.next=5,E(k+"auth",{headers:new Headers({"Set-Cookie":"token=".concat(t)})});case 5:if(n=e.sent,!n.ok){e.next=9;break}return e.abrupt("return",F.USER_SIGNED_IN);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:return e.abrupt("return",F.USER_SIGNED_OUT);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),_=function(e){return{type:"backendModeSignedInStatus/set",status:e}},x=n(200),T=n(118),C=n.n(T),N=n(530),D=n(533),V=n(87),A=n(534),M=n(535),L=n(201),R=n.n(L),P="709358329925-gic89ini15sgaenfrta1gshej1ik72jg.apps.googleusercontent.com",B=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleLoginSuccess=function(){var t=Object(b.a)(I.a.mark((function t(n){var a,r,o,i,c,s,l;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.profileObj,r=a.name,o=a.email,i=n.tokenObj,c=i.id_token,s=i.expiresAt,l=null,t.prev=2,t.next=5,C.a.post(k+"register_user",{method:"POST",body:JSON.stringify({name:r,email:o,token:c}),headers:{"Content-Type":"application/json","Set-Cookie":"token=".concat(c)}},{withCredentials:!0});case 5:l=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:l&&201===l.status&&(y.a.set("access_token",c,{expires:new Date(s)}),e.props.dispatchSetBackendModeSignedInStatusAction(F.USER_SIGNED_IN));case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}(),e.render=function(){return r.a.createElement("div",{style:{display:"flex",flexFlow:"column",height:"100vh",overflow:"hidden"}},r.a.createElement("div",{className:"landing-root",style:{flexGrow:"0 1 auto"}},r.a.createElement(N.a,{position:"static",class:"custom-navbar"},r.a.createElement(D.a,null,r.a.createElement("img",{className:"menuButton",src:n(254),style:{width:"50px",marginRight:"1%"}})))),r.a.createElement("div",{style:{backgroundColor:"#F5F0E1",flex:"1 1 auto"}},r.a.createElement(A.a,{container:!0,spacing:3,alignItems:"center",style:{height:"100%"}},r.a.createElement(A.a,{item:!0,xs:1}),r.a.createElement(A.a,{item:!0,xs:5,alignItems:"center"},r.a.createElement(A.a,{container:!0,spacing:3,alignItems:"center"},r.a.createElement(A.a,{item:!0,xs:3},r.a.createElement("img",{src:n(255),style:{width:"90%",marginLeft:"20%"}})),r.a.createElement(A.a,{item:!0,xs:9},r.a.createElement(V.a,{variant:"h1",className:"title",style:{fontFamily:"Bungee",color:"#1E3D59"}},"YADA",r.a.createElement(R.a,{text:"",style:{fontFamily:"Signika"},speed:1e4})),r.a.createElement(V.a,{variant:"h3",className:"title",style:{fontFamily:"Signika",color:"#1E3D59"}},"Yet Another Docs App"))),r.a.createElement("br",null),r.a.createElement("div",{style:{marginLeft:"8%"}},r.a.createElement(x.GoogleLogin,{clientId:P,buttonText:"Sign in With Google",onSuccess:function(t){e.handleLoginSuccess(t)},onFailure:function(e){console.log(e)},cookiePolicy:"single_host_origin",responseType:"code,token",style:{float:"left"}}),r.a.createElement(M.a,{variant:"outlined",style:{height:"250%",marginLeft:"3%"},onClick:function(){e.props.dispatchSetBackendModeSignedInStatusAction(F.LOCAL_STORAGE)}},"Use local storage"))),r.a.createElement(A.a,{item:!0,xs:6},r.a.createElement("img",{src:n(256),style:{width:"70%",marginLeft:"10%"}})))))},e}return a}(r.a.Component),G=Object(i.c)((function(e){return{backendModeSignedInStatus:e.backendModeSignedInStatus}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(_(t))}}}))(B),U=n(216),W=n(29),H=n(40),K=(n(257),n(35)),$=(n(104),n(3)),z=n(121),J=n.n(z);function Y(e){return e[0]}var X,q={Lexer:void 0,ParserRules:[{name:"Main",symbols:["Expression"],postprocess:Y},{name:"Expression",symbols:["Expression_"],postprocess:Y},{name:"Expression",symbols:["Factor"],postprocess:Y},{name:"Expression_",symbols:["Factor","_",{literal:"|",pos:30},"_","Expression"],postprocess:function(e){return[e[0],e[2],e[4]]}},{name:"Factor",symbols:["Factor_"],postprocess:Y},{name:"Factor",symbols:["Term"],postprocess:Y},{name:"Factor_",symbols:["Term","_",{literal:"&",pos:60},"_","Factor"],postprocess:function(e){return[e[0],e[2],e[4]]}},{name:"Term",symbols:["Not"],postprocess:Y},{name:"Term",symbols:["Nested"],postprocess:Y},{name:"Term",symbols:["Tag"],postprocess:Y},{name:"Not$subexpression$1",symbols:["Nested"],postprocess:Y},{name:"Not$subexpression$1",symbols:["Tag"],postprocess:Y},{name:"Not",symbols:[{literal:"!",pos:92},"Not$subexpression$1"]},{name:"Nested",symbols:[{literal:"(",pos:110},"_","Expression","_",{literal:")",pos:118}],postprocess:function(e){return e[2]}},{name:"Tag$string$1",symbols:[{literal:"#"},{literal:"{"}],postprocess:function(e){return e.join("")}},{name:"Tag$ebnf$1",symbols:[/[^{}]/]},{name:"Tag$ebnf$1",symbols:[/[^{}]/,"Tag$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"Tag",symbols:["Tag$string$1","Tag$ebnf$1",{literal:"}",pos:131}],postprocess:function(e){return e[1].join("").trim()}},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:[{literal:" ",pos:139},"_$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(e){return null}}],ParserStart:"Main"},Q=function(e){var t=null;if(e){var n=new J.a.Parser(J.a.Grammar.fromCompiled(q));try{n.feed(e.trim()),n.results.length>0&&(t=n.results)}catch(a){}}return t},Z=n(25),ee=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return JSON.parse(e)},r=t;if(e)try{r=a(e)}catch(o){n&&console.log(n),console.log(o)}return r},te=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return JSON.parse(e)};if(!e)return t;var r=null;try{r=a(e)}catch(o){n&&console.log(n),console.log(o)}return r},ne=ee(localStorage.getItem("initialFileId"),{},"invalid initialFileId"),ae={sourceId:ne.hasOwnProperty("sourceId")?ne.sourceId:d.sourceId,viewId:ne.hasOwnProperty("viewId")?ne.viewId:d.viewId,viewType:ne.hasOwnProperty("viewType")?ne.viewType:d.viewId},re=function(e){return{type:"selectNode/set",selectNode:e}},oe=n(214),ie=n(28),ce=function(e){return{type:"tagsInView/set",tagsInView:e}},se=Object(oe.a)({reducer:Object(ie.c)({currentOpenFileId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;return"currentOpenFileId/set"===t.type&&f(t)?t.fileId:e},saveDirtyFlag:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"saveDirtyFlag/set"!==t.type&&"saveDirtyFlag/clear"!==t.type?e:"saveDirtyFlag/set"===t.type},selectNode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"selectNode/set"!==t.type||!t.hasOwnProperty("selectNode")||t.selectNode&&!t.selectNode.hasOwnProperty("pos")?"selectNode/set"===t.type?null:e:t.selectNode},backendModeSignedInStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage.getItem("initialLocalStorageBackendMode")?F.LOCAL_STORAGE:F.USER_SIGNED_OUT,t=arguments.length>1?arguments[1]:void 0;return"backendModeSignedInStatus/set"===t.type&&t.hasOwnProperty("status")&&F.hasOwnProperty(t.status)?(t.status===F.LOCAL_STORAGE?localStorage.setItem("initialLocalStorageBackendMode",!0):localStorage.removeItem("initialLocalStorageBackendMode"),t.status):e},tagsInView:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"tagsInView/set"===t.type&&t.hasOwnProperty("tagsInView")?t.tagsInView:e}})}),le=new $.PluginKey("select-node"),ue=new $.Plugin({key:le,state:{init:function(){return null},apply:function(e,t,n){var a=e.selection.head,r=null;return e.doc.nodesBetween(a,a,(function(e,t){e.hasOwnProperty("attrs")&&e.attrs.tags&&(r={node:e,pos:t})})),(!n&&r||n&&!r||n&&r&&(r.pos!==n.pos||!r.node.eq(n.node)))&&se.dispatch(re(r?{pos:r.pos}:null)),r}},props:{decorations:function(e){var t=[],n=le.getState(e);return n&&t.push(Z.Decoration.node(n.pos,n.pos+n.node.nodeSize,{style:"background: #FAFAFA; outline: 1px solid #DCDCDC;"})),Z.DecorationSet.create(e.doc,t)}}}),de=new $.PluginKey("tag-filtering"),pe=function e(t,n,a,r,o,i){var c=!1,s=r.hasOwnProperty("attrs")&&r.attrs.tags,l=Object(O.a)(Object(O.a)({},o),s?r.attrs.tags:null);if(s&&(c=function e(t,n){if(!n)return!0;if(!Array.isArray(n))return t.hasOwnProperty(n);if(2===n.length)return!e(t,n[1]);var a=e(t,n[0]);return 1===n.length||"&"===n[1]!==a?a:e(t,n[2])}(l,n)),!r.isTextblock)for(var u=1,d=0;d<r.childCount;++d){var p=r.child(d),f=e(t,n,a,p,l,i+u);c=c||f,u+=p.nodeSize}return 0===i||c||t.push(Z.Decoration.node(i-1,i-1+r.nodeSize,{style:"display: none;"})),c},fe=new $.Plugin({key:de,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(de);return void 0===n?t:n}},props:{decorations:function(e){var t=[],n=de.getState(e),a=le.getState(e);return n&&pe(t,n,a,e.doc,{},0),Z.DecorationSet.create(e.doc,t)}}}),me=(n(258),n(548)),ge=n(54),ve=n(56),he=n.n(ve),we=new $.PluginKey("cancel-line-breaks"),Ie=new $.Plugin({key:we,filterTransaction:function(e,t){return g(se.getState().currentOpenFileId)&&!de.getState(t)||e.steps.every((function(e){return"replace"!==e.toJSON().stepType||!function(e){return e.slice.content.content.some((function(e){return!e.isLeaf}))}(e)&&!function(e,t){if(e.from===e.to)return!1;var n=t.nodeAt(e.from),a=t.nodeAt(e.to);return a?!n||n&&!n.eq(a):!n||!t.nodeAt(e.to-1).eq(n)}(e,t.doc)}))}}),be=new(function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(ge.a)(n,[{key:"name",get:function(){return"yada-blockTagging"}},{key:"plugins",get:function(){return[Ie,ue,fe]}}]),n}(ve.Extension)),Se=/[^{}]/,ye=/[{}]/,Oe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={selectNodeAttrs:{},modifying:""},e.handleAddTag=function(){var t=document.getElementById("add_tag_input").value.trim();if(!t||ye.test(t)||!e.props.selectNode)return!1;if(e.state.selectNodeAttrs.hasOwnProperty("tags")&&e.state.selectNodeAttrs.tags.hasOwnProperty(t))return alert('tag value "'+t+'" already exists'),!1;var n=Object(O.a)(Object(O.a)({},e.state.selectNodeAttrs),{},{tags:Object(O.a)({},e.state.selectNodeAttrs.tags)});return n.tags[t]=Object(me.a)(),be.editor.view.dispatch(be.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,n)),e.setState({selectNodeAttrs:n}),e.props.dispatchSetSaveDirtyFlagAction(),!0},e.handleDeleteTag=function(t){if(!e.props.selectNode||!e.state.selectNodeAttrs.hasOwnProperty("tags")||!e.state.selectNodeAttrs.tags.hasOwnProperty(t))return!1;var n=Object(O.a)(Object(O.a)({},e.state.selectNodeAttrs),{},{tags:Object(O.a)({},e.state.selectNodeAttrs.tags)});return delete n.tags[t],be.editor.view.dispatch(be.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,n)),e.setState({selectNodeAttrs:n}),e.props.dispatchSetSaveDirtyFlagAction(),!0},e.handleModifyTagValue=function(t){var n=document.getElementById("modify_tag_input_"+t).value.trim();if(!n||ye.test(n)||!e.props.selectNode||!e.state.selectNodeAttrs.hasOwnProperty("tags")||!e.state.selectNodeAttrs.tags.hasOwnProperty(t))return!1;if(n===t)return!0;if(e.state.selectNodeAttrs.tags.hasOwnProperty(n))return alert('tag value "'+n+'" already exists'),!1;var a=Object(O.a)(Object(O.a)({},e.state.selectNodeAttrs),{},{tags:Object(O.a)({},e.state.selectNodeAttrs.tags)});return a.tags[n]=a.tags[t],delete a.tags[t],be.editor.view.dispatch(be.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,a)),e.setState({selectNodeAttrs:a}),e.props.dispatchSetSaveDirtyFlagAction(),!0},e.handleCancelModifyTagValue=function(t){var n="modify_tag_input_"+t;n.value=t,n.setSelectionRange(0,0),e.state.modifying===t&&e.setState({modifying:""})},e.handleStartModifyingTagValue=function(t){e.setState({modifying:t}),Object(K.defer)((function(){var e=document.getElementById("modify_tag_input_"+t);e.focus(),e.setSelectionRange(0,e.value.length)}))},e.componentDidUpdate=function(t){(t.currentOpenFileId.sourceId!==e.props.currentOpenFileId.sourceId||t.currentOpenFileId.viewId!==e.props.currentOpenFileId.viewId||!t.selectNode&&e.props.selectNode||t.selectNode&&!e.props.selectNode||t.selectNode&&e.props.selectNode&&t.selectNode.pos!==e.props.selectNode.pos)&&(document.getElementById("add_tag_input").value="",Object(K.defer)((function(){if(e.props.selectNode){var t=be.editor.view.state.doc.nodeAt(e.props.selectNode.pos);e.setState({selectNodeAttrs:Object(O.a)({},t&&t.hasOwnProperty("attrs")?t.attrs:null)})}else e.setState({selectNodeAttrs:{}})})))},e.render=function(){return r.a.createElement("div",{className:"MarginPane"},r.a.createElement("div",{id:"tag_menu_wrapper"},r.a.createElement("div",{className:"InputRow",id:"add_tag_input_row"},r.a.createElement("input",{id:"add_tag_input",title:"new tag",placeholder:"new tag",disabled:!e.props.selectNode,onKeyPress:function(t){"Enter"===t.key&&e.handleAddTag()&&(t.target.value=""),Se.test(t.key)||t.preventDefault()},onKeyDown:function(e){"Escape"===e.key&&(e.target.value="",be.editor.view.focus())}}),r.a.createElement("button",{className:"MonospaceCharButton",title:"add",disabled:!e.props.selectNode,onClick:e.handleAddTag},"+")),r.a.createElement("div",{id:"tag_menu_list_container"},e.props.selectNode&&e.state.selectNodeAttrs.hasOwnProperty("tags")&&Object.keys(e.state.selectNodeAttrs.tags).length>0?r.a.createElement("ul",{id:"block_node_tags_list"},Object.keys(e.state.selectNodeAttrs.tags).map((function(t){return r.a.createElement("li",{key:t},r.a.createElement("div",{className:"ButtonRow"},e.state.modifying!==t?r.a.createElement("button",{disabled:!0},t):r.a.createElement("input",{id:"modify_tag_input_"+t,defaultValue:t,placeholder:t,disabled:e.state.modifying!==t,onBlur:function(n){e.handleModifyTagValue(t),e.state.modifying===t&&e.setState({modifying:""})},onKeyDown:function(n){"Escape"===n.key&&e.handleCancelModifyTagValue(t)},onKeyPress:function(e){"Enter"===e.key&&e.target.blur(),Se.test(e.key)||e.preventDefault()}}),r.a.createElement("button",{className:"MonospaceCharButton",title:"modify",hidden:e.state.modifying===t,onClick:function(){e.handleStartModifyingTagValue(t)}},"#"),r.a.createElement("button",{className:"MonospaceCharButton",title:"remove",onClick:function(){e.handleDeleteTag(t)}},"-")))}))):r.a.createElement("div",{className:"PlaceholderDivWithText",id:"no_tags_placeholder"},"no "+(e.props.selectNode?"block tags":"selected block")))))},e}return n}(r.a.Component),Ee=Object(i.c)((function(e){return{selectNode:e.selectNode,saveDirtyFlag:e.saveDirtyFlag,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{dispatchSetSaveDirtyFlagAction:function(){return e({type:"saveDirtyFlag/set"})}}}))(Oe),ke=n(97),Fe=n(215),je=function(e,t){return localStorage.setItem("sourceViews_"+e,JSON.stringify(t))},_e=function(e){return te(localStorage.getItem("sourceViews_"+e),{},"invalid sourceViews")},xe=function(e){return localStorage.setItem("sourceIdNames",JSON.stringify(e))},Te=function(e,t){for(;!t||e.hasOwnProperty(t.toString());)t+=1;return t.toString()},Ce=function(e){return{source:Te(e,0),nextNewViewIdsForSourceIds:Object.fromEntries(Object.entries(e).map((function(e){var t=Object(H.a)(e,2),n=t[0],a=t[1].views;return[n,Te(a,0)]})))}},Ne={doGetFilesList:function(){var e=Object(b.a)(I.a.mark((function e(){var t,n,a,r,o,i,c,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=te(localStorage.getItem("sourceIdNames"),{},"invalid sourceIdNames")){e.next=3;break}return e.abrupt("return",null);case 3:n={},a=0,r=Object.entries(t);case 5:if(!(a<r.length)){e.next=14;break}if(o=Object(H.a)(r[a],2),i=o[0],c=o[1],s=_e(i)){e.next=10;break}return e.abrupt("return",null);case 10:n[i]={name:c,views:s};case 11:a++,e.next=5;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),doSaveViewSpec:function(){var e=Object(b.a)(I.a.mark((function e(t,n,a,r,o){var i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="viewSpec_"+h(n),t.length>0?localStorage.setItem(i,JSON.stringify(t)):localStorage.removeItem(i),e.abrupt("return",Object(O.a)({id:a,sourceId:n},o?{name:"Unnamed View",type:r}:null));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),doGetView:function(){var e=Object(b.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(localStorage.getItem("viewSpec_"+h(t.sourceId,t.viewId)),[],"invalid viewSpec"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doGetSourceTaggedBlocks:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a,r,o,i,c,s,l,u,d;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("sourceContent_"+t)){e.next=3;break}return e.abrupt("return",{});case 3:if(a=ee(n,null,"invalid sourceContent")){e.next=6;break}return e.abrupt("return",null);case 6:if(r={},a)for(o=[a];o.length>0;)if((i=o.shift()).hasOwnProperty("attrs")&&i.attrs.hasOwnProperty("tags"))for(c=0,s=Object.entries(i.attrs.tags);c<s.length;c++)l=Object(H.a)(s[c],2),u=l[0],d=l[1],r[d]={tag:u,node:i};else i.hasOwnProperty("content")&&o.push.apply(o,Object(Fe.a)(i.content));return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doSaveSourceContent:function(){var e=Object(b.a)(I.a.mark((function e(t,n,a){var r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=te(t,"","invalid sourceContent value",(function(e){return JSON.parse(e),e})))){e.next=3;break}return e.abrupt("return",null);case 3:return o="sourceContent_"+n,r?localStorage.setItem(o,r):localStorage.removeItem(o),e.abrupt("return",Object(O.a)({id:n},a?{name:"Unnamed Source"}:null));case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),doGetSourceContent:function(){var e=Object(b.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(localStorage.getItem("sourceContent_"+t),"","invalid sourceContent",(function(e){return JSON.parse(e),e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doSetSourceSavedTagFilters:function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="sourceSavedTagFilters_"+t,Object.keys(n).length>0?localStorage.setItem(a,JSON.stringify(n)):localStorage.removeItem(a),e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doGetSourceSavedTagFilters:function(){var e=Object(b.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(localStorage.getItem("sourceSavedTagFilters_"+t),{},"invalid sourceSavedTagFilters"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doDeleteView:function(){var e=Object(b.a)(I.a.mark((function e(t,n){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("viewSpec_"+h(t)),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doDeleteSource:function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("sourceSavedTagFilters_"+t),localStorage.removeItem("sourceContent_"+t),a=Object(ke.a)(n);try{for(a.s();!(r=a.n()).done;)r.value,localStorage.removeItem("viewSpec_"+h(t))}catch(o){a.e(o)}finally{a.f()}return localStorage.removeItem("sourceViews_"+t),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doRenameView:function(){var e=Object(b.a)(I.a.mark((function e(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),doRenameSource:function(){var e=Object(b.a)(I.a.mark((function e(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},De={type:"doc",content:[{type:"paragraph",attrs:{tags:{}}}]},Ve={doGetFilesList:function(){var e=Object(b.a)(I.a.mark((function e(){var t,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"documents",{headers:new Headers({"Set-Cookie":"token=".concat(t)})});case 4:if(!(n=e.sent).ok){e.next=9;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),doSaveViewSpec:function(){var e=Object(b.a)(I.a.mark((function e(t,n,a,r,o){var i,c,s,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"view?docID=".concat(n,"&viewType=").concat(r)+(o?"":"&viewID=".concat(a)),{method:"PUT",body:JSON.stringify({tags:t}),headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(i)})});case 4:if(!(c=e.sent).ok){e.next=11;break}return e.next=8,c.json();case 8:return s=e.sent,l=s.viewID,e.abrupt("return",Object(O.a)({id:l,sourceId:n},o?{name:"Untitled",type:r}:null));case 11:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),doGetView:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a,r,o,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"view?docID=".concat(t.sourceId,"&viewID=").concat(t.viewId),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:return a=e.sent,e.next=7,E(k+"tags?docID=".concat(t.sourceId),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 7:if(r=e.sent,a.ok&&r.ok){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,a.json();case 12:return o=e.sent,e.next=15,r.json();case 15:return i=e.sent,e.abrupt("return",{view:o,tags:i,type:t.viewType});case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0);case 22:return e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),doGetSourceTaggedBlocks:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"tags?docID=".concat(t),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),doSaveSourceContent:function(){var e=Object(b.a)(I.a.mark((function e(t,n,a){var r,o,i,c,s,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=te(t,JSON.stringify(De),"invalid sourceContent value",(function(e){return JSON.parse(e),e}))){e.next=3;break}return e.abrupt("return",null);case 3:return o=y.a.get("access_token"),e.prev=4,e.next=7,E(k+"document"+(a?"":"?docID=".concat(n)),{method:"PUT",body:r,headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(o)})});case 7:if(!(i=e.sent).ok){e.next=15;break}return e.next=11,i.json();case 11:return c=e.sent,s=c.id,l=c.name,e.abrupt("return",Object(O.a)({id:s},a?{name:l}:null));case 15:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),console.log(e.t0);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}(),doGetSourceContent:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"document?docID=".concat(t),{headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.text();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),doSetSourceSavedTagFilters:function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.a.get("access_token"),r=Object.keys(n).map((function(e){return n[e]})),e.prev=2,e.next=5,E(k+"filters?docID=",{method:"POST",body:JSON.stringify({body:{docID:t,filters:r}}),headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(a)})});case 5:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",!0);case 8:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),doGetSourceSavedTagFilters:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"filters?docID=".concat(t),{headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),doDeleteSource:function(){var e=Object(b.a)(I.a.mark((function e(t){var n,a,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"document?docID=".concat(t),{method:"DELETE",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:return a=e.sent,r=a.ok,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),doDeleteView:function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"view?docID=".concat(t,"&viewID=").concat(n),{method:"DELETE",headers:new Headers({"Set-Cookie":"token=".concat(a)})});case 4:return r=e.sent,o=r.ok,e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),doRenameSource:function(){var e=Object(b.a)(I.a.mark((function e(t,n){var a,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"document?docID=".concat(t,"&name=").concat(n),{method:"PATCH",headers:new Headers({"Set-Cookie":"token=".concat(a)})});case 4:return r=e.sent,o=r.ok,e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),doRenameView:function(){var e=Object(b.a)(I.a.mark((function e(t,n,a){var r,o,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.a.get("access_token"),e.prev=1,e.next=4,E(k+"view?docID=".concat(t,"&viewID=").concat(n,"&name=").concat(a),{method:"PATCH",headers:new Headers({"Set-Cookie":"token=".concat(r)})});case 4:return o=e.sent,i=o.ok,e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,a){return e.apply(this,arguments)}}()},Ae=function(){return se.getState().backendModeSignedInStatus===F.LOCAL_STORAGE?Ne:Ve},Me={doGetFilesList:function(){throw new Error("not implemented")},doSaveViewSpec:function(){throw new Error("not implemented")},doGetView:function(){throw new Error("not implemented")},doGetSourceTaggedBlocks:function(){throw new Error("not implemented")},doSaveSourceContent:function(){throw new Error("not implemented")},doGetSourceContent:function(){throw new Error("not implemented")},doSetSourceSavedTagFilters:function(){throw new Error("not implemented")},doGetSourceSavedTagFilters:function(){throw new Error("not implemented")},doDeleteView:function(){throw new Error("not implemented")},doDeleteSource:function(){throw new Error("not implemented")},doRenameView:function(){throw new Error("not implemented")},doRenameSource:function(){throw new Error("not implemented")}},Le=Object.keys(Me).reduce((function(e,t){return e[t]=Object(b.a)(I.a.mark((function e(){var n,a=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Ae()).hasOwnProperty(t)){e.next=12;break}if(se.getState().backendModeSignedInStatus===F.USER_SIGNED_OUT){e.next=8;break}return e.next=5,n[t].apply(n,a);case 5:e.t1=e.sent,e.next=9;break;case 8:e.t1=null;case 9:e.t0=e.t1,e.next=13;break;case 12:e.t0=Me[t]();case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e)}))),e}),{}),Re=function(){var e=se.getState().currentOpenFileId;g(se.getState().currentOpenFileId)&&se.getState().saveDirtyFlag&&Le.doSaveSourceContent(be.editor.value(!0),e.sourceId).then((function(e){e?se.dispatch({type:"saveDirtyFlag/clear"}):alert("failed to save source content")}))},Pe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).render=function(){var t=m(e.props.currentOpenFileId);return r.a.createElement("div",{className:"MainPane"},r.a.createElement("div",{id:"editor_container"},r.a.createElement("div",{className:"InputRow",id:"current_open_file_controls"},r.a.createElement("button",{className:"MonospaceCharButton",title:"close",disabled:t,onClick:function(){Tt(d)}},"\u2715"),r.a.createElement("button",{className:"MonospaceCharButton",title:"save",disabled:t||!e.props.saveDirtyFlag,onClick:Re},"^"),r.a.createElement("div",{style:{minWidth:"5px"}}),e.props.children),r.a.createElement("div",{id:"editor",hidden:t},r.a.createElement(he.a,{extensions:[be],key:e.props.fileIdKeyStr,defaultValue:e.props.fileContent,jsonStrValue:!!e.props.fileContent,onKeyDown:function(e){"Escape"===e.key&&(be.editor.view.dispatch(be.editor.view.state.tr.setSelection($.TextSelection.create(be.editor.view.state.doc,0,0))),e.target.blur())},onChange:function(){e.props.saveDirtyFlag||e.props.dispatchSetSaveDirtyFlagAction()}})),r.a.createElement("div",{className:"PlaceholderDivWithText",id:"no_file_editor_placeholder",hidden:!t},r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flexGrow:2}}),"open a doc using the navigator side pane on the left",r.a.createElement("div",{style:{flexGrow:3}})),r.a.createElement("div",{style:{flexGrow:8}}))),r.a.createElement(Ee,null))},e}return n}(r.a.Component),Be=Object(i.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,saveDirtyFlag:e.saveDirtyFlag}}),(function(e){return{dispatchSetSaveDirtyFlagAction:function(){return e({type:"saveDirtyFlag/set"})}}}))(Pe),Ge={fileIdKeyStr:h(d),fileContent:"",modifyingTagFilters:!1,currentTagFiltersStr:"",currentParsedTagFiltersStr:"",sourceSavedTagFilters:{}},Ue=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state=Ge,e.handleCancelModifyingTagFilters=function(){document.getElementById("tag_filters_input").value=e.state.currentTagFiltersStr,e.setState({modifyingTagFilters:!1})},e.handleStartModifyingTagFilters=function(){e.setState({modifyingTagFilters:!0}),Object(K.defer)((function(){var e=document.getElementById("tag_filters_input");e.focus(),e.setSelectionRange(e.value.length,e.value.length)}))},e.handleUnpersistCurrentTagFilters=function(){if(!e.state.currentTagFiltersStr||!e.state.sourceSavedTagFilters.hasOwnProperty(e.state.currentParsedTagFiltersStr))return!1;var t=Object(O.a)({},e.state.sourceSavedTagFilters);delete t[e.state.currentParsedTagFiltersStr],Le.doSetSourceSavedTagFilters(e.props.currentOpenFileId.sourceId,t).then((function(n){n?e.setState({sourceSavedTagFilters:t}):alert("failed to set source saved tag filters")}))},e.handlePersistNewSavedTagFilters=function(){if(!e.state.currentTagFiltersStr||e.state.sourceSavedTagFilters.hasOwnProperty(e.state.currentParsedTagFiltersStr))return!1;var t=Object(O.a)({},e.state.sourceSavedTagFilters);t[e.state.currentParsedTagFiltersStr]=e.state.currentTagFiltersStr,Le.doSetSourceSavedTagFilters(e.props.currentOpenFileId.sourceId,t).then((function(n){n?e.setState({sourceSavedTagFilters:t}):alert("failed to set source saved tag filters")}))},e.handleApplyTagFilters=function(){var t=null,n=document.getElementById("tag_filters_input").value.trim();if(n&&!(t=Q(n)))return alert("invalid tag filters"),!1;document.getElementById("tag_filters_input").value=n,t?localStorage.setItem("initialTagFilters",n):localStorage.removeItem("initialTagFilters");var a=JSON.stringify(t),r=e.state.currentParsedTagFiltersStr;return e.setState({currentTagFiltersStr:n,currentParsedTagFiltersStr:a}),a===r||(be.editor.view.dispatch(be.editor.view.state.tr.setMeta(de,t).setSelection(t?$.TextSelection.create(be.editor.view.state.doc,0,0):$.Selection.atStart(be.editor.view.state.doc)).scrollIntoView()),Object(K.defer)((function(){t?be.editor.view.dom.blur():be.editor.view.focus()}))),!0},e.changeFile=Object(b.a)(I.a.mark((function t(){var n;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Change FILE"),m(e.props.currentOpenFileId)||Object(K.defer)((function(){be.editor.focusAtStart()})),n=h(e.props.currentOpenFileId),console.log(e.props.currentOpenFileId),g(e.props.currentOpenFileId)?Le.doGetSourceContent(e.props.currentOpenFileId.sourceId).then((function(t){null===t?(alert("failed to retrieve source content"),Tt(d)):(e.setState({fileIdKeyStr:n,fileContent:null!==t&&void 0!==t?t:""}),Le.doGetSourceSavedTagFilters(e.props.currentOpenFileId.sourceId).then((function(t){t?e.setState({sourceSavedTagFilters:t}):alert("failed to retrieve source saved tag filters")})))})):e.setState({fileIdKeyStr:n,fileContent:""});case 5:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.changeFile().then((function(){if(g(e.props.currentOpenFileId)){var t=localStorage.getItem("initialTagFilters");t&&(document.getElementById("tag_filters_input").value=t,e.handleApplyTagFilters())}}))},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||(document.getElementById("tag_filters_input").value="",e.handleApplyTagFilters(),e.setState({sourceSavedTagFilters:{}}),e.changeFile())},e.render=function(){var t=g(e.props.currentOpenFileId),n=e.state.sourceSavedTagFilters.hasOwnProperty(e.state.currentParsedTagFiltersStr);return r.a.createElement(Be,{fileIdKeyStr:e.state.fileIdKeyStr,fileContent:e.state.fileContent},r.a.createElement("div",{className:"InputRow"},r.a.createElement("button",{className:"MonospaceCharButton",title:(n?"un-":"")+"persist",disabled:!t||!e.state.currentTagFiltersStr||e.state.modifyingTagFilters,onClick:n?e.handleUnpersistCurrentTagFilters:e.handlePersistNewSavedTagFilters},n?"-":"+"),r.a.createElement("button",{className:"MonospaceCharButton",title:"modify",disabled:!t||e.state.modifyingTagFilters,onClick:e.handleStartModifyingTagFilters},"#"),r.a.createElement("input",{id:"tag_filters_input",defaultValue:e.state.currentTagFiltersStr,placeholder:"tag filters",title:"tag filters - example syntax: ( #{tag1} | !( #{tag2} ) ) & #{tag3}",list:"saved_tag_filters_datalist",disabled:!t||!e.state.modifyingTagFilters,onBlur:function(t){if(e.handleApplyTagFilters())e.setState({modifyingTagFilters:!1});else{var n=t.target;Object(K.defer)((function(){n.focus()}))}},onKeyDown:function(t){"Escape"===t.key&&e.handleCancelModifyingTagFilters()},onKeyPress:function(e){"Enter"===e.key&&e.target.blur()}}),r.a.createElement("datalist",{id:"saved_tag_filters_datalist"},Object.entries(e.state.sourceSavedTagFilters).map((function(e){var t=Object(H.a)(e,2),n=(t[0],t[1]);return r.a.createElement("option",{key:n,value:n})}))),r.a.createElement("button",{className:"MonospaceCharButton",title:"clear",disabled:!t||!e.state.currentTagFiltersStr||e.state.modifyingTagFilters,onClick:function(){document.getElementById("tag_filters_input").value="",e.handleApplyTagFilters()}},"\u2715")))},e}return n}(r.a.Component),We=Object(i.c)((function(e){return{currentOpenFileId:e.currentOpenFileId}}))(Ue),He=n(206),Ke=n.n(He),$e=n(539),ze=n(540),Je=n(207),Ye=n.n(Je),Xe=n(537),qe=n(542),Qe=n(541),Ze=n(494),et=n(545),tt=n(546),nt=n(543),at=n(122),rt=n.n(at),ot=n(123),it=n.n(ot),ct=n(493),st=n(496),lt=n(536),ut=n(210),dt=n.n(ut),pt=n(538),ft=n(86),mt=n.n(ft),gt=n(549),vt=n(544),ht=n(209),wt=n.n(ht),It=n(547),bt=n(211),St=n.n(bt),yt=n(208),Ot=n.n(yt),Et=n(101),kt=n.n(Et),Ft=n(100),jt=n.n(Ft),_t=n(205),xt=n.n(_t),Tt=function(e){if(console.log(e),!p(e))return!1;var t=se.getState().currentOpenFileId;return e.sourceId===t.sourceId&&e.viewId===t.viewId||!(se.getState().saveDirtyFlag&&!window.confirm("confirm discard unsaved changes"))&&(Object(i.b)((function(){se.dispatch(function(e){return{type:"currentOpenFileId/set",fileId:e}}(e)),se.dispatch({type:"saveDirtyFlag/clear"}),se.dispatch(re(null))})),localStorage.setItem("initialFileId",JSON.stringify(e)),localStorage.removeItem("initialTagFilters"),!0)},Ct=function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(H.a)(e,2);return[t[0],t[1].name]})))},Nt=function(e){return Object.entries(e).reduce((function(e,t){var n=Object(H.a)(t,2),a=(n[0],n[1].views);return e+1+Object.keys(a).length}),0)},Dt="CURRENT_SOURCE",Vt="CURRENT_VIEW",At="SOURCE_LIST_ITEM",Mt="VIEW_LIST_ITEM",Lt=(X={},Object(W.a)(X,Dt,(function(){return"current_source_name_input"})),Object(W.a)(X,Vt,(function(){return"current_view_name_input"})),Object(W.a)(X,At,(function(e){return"rename_source_list_item_input_"+e.sourceId})),Object(W.a)(X,Mt,(function(e){return"rename_view_list_item_input_"+h(e)})),X),Rt={inputType:null,fileId:d},Pt={searching:"",renaming:Rt,filesList:{},nextNewFileIds:null,selectedFileId:null,selectedViewId:null,selectedFileOpen:!1,editMenuAnchorElement:null,renameSelected:!1,newViewAnchorElement:null},Bt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).render=function(){if(0!==e.props.fileId.viewId){var t=e.props.viewType;return r.a.createElement("div",{className:"fileList-viewRoot",style:e.props.selected?{backgroundColor:"rgba(0, 0, 0, 0.08)",width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}:{width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}},r.a.createElement(lt.a,null,t===u.CARD_VIEW?r.a.createElement(jt.a,null):t===u.TEXT_VIEW?r.a.createElement(kt.a,null):null),r.a.createElement(st.a,{value:e.props.fileName,className:"file_list_input",disabled:!(e.props.selected&&e.props.renameSelected)}),r.a.createElement(Xe.a,{className:"fileList-divider",orientation:"vertical"}),r.a.createElement(lt.a,{className:"fileList-iconButton",onClick:e.props.handleEditMenuClick},r.a.createElement(mt.a,{fontSize:"small",color:"disabled"})))}return r.a.createElement("div",{className:"fileList-viewRoot",style:e.props.selected?{backgroundColor:"#a3d2f7",border:"solid #3f51b5 thin",width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}:{width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}},r.a.createElement(st.a,{value:e.props.fileName,className:"file_list_input",disabled:!(e.props.selected&&e.props.renameSelected)}),e.props.childViewsExist?e.props.open?r.a.createElement(rt.a,null):r.a.createElement(it.a,null):null,r.a.createElement(Xe.a,{className:"fileList-divider",orientation:"vertical"}),r.a.createElement(lt.a,{className:"fileList-iconButton",onClick:e.props.handleEditMenuClick},r.a.createElement(mt.a,{fontSize:"small",color:"disabled"})))},e}return n}(r.a.Component),Gt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e,a;Object(c.a)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(a=t.call.apply(t,[this].concat(i))).state=Pt,a.resetState=function(){a.setState(Pt)},a.getSourceName=function(e){return p(e)&&a.state.filesList.hasOwnProperty(e.sourceId)?a.state.filesList[e.sourceId].name:""},a.getViewName=function(e){return v(e)&&a.state.filesList.hasOwnProperty(e.sourceId)&&a.state.filesList[e.sourceId].views.hasOwnProperty(e.viewId)?a.state.filesList[e.sourceId].views[e.viewId].name:""},a.getFileName=function(e){return v(e)?a.getViewName(e):a.getSourceName(e)},a.getRenameInputValueFunctions=(e={},Object(W.a)(e,Dt,a.getSourceName),Object(W.a)(e,Vt,a.getViewName),Object(W.a)(e,At,a.getFileName),Object(W.a)(e,Mt,a.getFileName),e),a.handleSwitchBackendModeSignedInStatus=function(e){return e===a.props.backendModeSignedInStatus||!!Tt(d)&&(a.resetState(),a.props.dispatchSetBackendModeSignedInStatusAction(e),!0)},a.handleCancelRenaming=function(e,t){var n=document.getElementById(Lt[e](t));n.value=a.getRenameInputValueFunctions[e](t),n.setSelectionRange(0,0),a.setState({renaming:Rt})},a.handleClearSearchingInput=function(){document.getElementById("search_file_names_input").value="",a.setState({searching:""})},a.handleChangeSearchingInput=function(){a.setState({searching:document.getElementById("search_file_names_input").value.trim()})},a.handleDoFileNamesSearch=function(){return Object.fromEntries(Object.entries(a.state.filesList).map((function(e){var t=Object(H.a)(e,2),n=t[0],r=t[1],o=r.name,i=r.views;return[n,{name:o,views:a.state.searching?Object.fromEntries(Object.entries(i).filter((function(e){var t=Object(H.a)(e,2);t[0];return t[1].name.includes(a.state.searching)}))):i}]})).filter((function(e){var t=Object(H.a)(e,2),n=(t[0],t[1]),r=n.name,o=n.views;return!a.state.searching||Object.keys(o).length>0||r.includes(a.state.searching)})))},a.handleCreateNewFile=function(){var e=Object(b.a)(I.a.mark((function e(t){var n,r,o,i,c,s,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.hasOwnProperty(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=t===u.SOURCE,(!(r=m(a.props.currentOpenFileId))||n)&&(r||Tt(d))){e.next=6;break}return e.abrupt("return");case 6:return o=a.props.backendModeSignedInStatus===F.LOCAL_STORAGE?n?a.state.nextNewFileIds.source:a.state.nextNewFileIds.nextNewViewIdsForSourceIds[a.props.currentOpenFileId.sourceId]:null,i=n?Le.doSaveSourceContent(null,o,!0):Le.doSaveViewSpec([],a.props.currentOpenFileId.sourceId,o,t,!0),e.next=10,i;case 10:if(c=e.sent){e.next=14;break}return alert("failed to create new file"),e.abrupt("return");case 14:s=n?c.id:a.state.selectedFileId,l=Object(O.a)(Object(O.a)({},a.state.filesList),{},Object(W.a)({},s,{name:n?c.name:a.state.filesList[s].name,views:Object(O.a)({},n?null:Object(O.a)(Object(O.a)({},a.state.filesList[s].views),{},Object(W.a)({},c.id,{name:c.name,type:c.type})))})),a.setState({filesList:l}),Object(K.defer)((function(){var e={sourceId:s,viewId:n?0:c.id};Tt(e)})),a.props.backendModeSignedInStatus===F.LOCAL_STORAGE&&(n?xe(Ct(l)):je(s,l[s].views),a.setState({nextNewFileIds:{source:n?Te(l,parseInt(s)):a.state.nextNewFileIds.source,nextNewViewIdsForSourceIds:Object(O.a)(Object(O.a)({},a.state.nextNewFileIds.nextNewViewIdsForSourceIds),n?null:Object(W.a)({},s,Te(l[s].views,parseInt(c.id))))}}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleDeleteFile=function(){var e=Object(b.a)(I.a.mark((function e(t){var n,r,o,i,c;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m(t)){e.next=2;break}return e.abrupt("return");case 2:if(t.sourceId!==a.props.currentOpenFileId.sourceId||t.viewId!==a.props.currentOpenFileId.viewId||Tt(d)){e.next=4;break}return e.abrupt("return");case 4:return n=g(t),r=n?Le.doDeleteSource(t.sourceId,Object.keys(a.state.filesList[t.sourceId].views)):Le.doDeleteView(t.sourceId,t.viewId),e.next=8,r;case 8:if(e.sent){e.next=12;break}return alert("failed to delete file"),e.abrupt("return");case 12:o=Object(O.a)({},a.state.filesList),n?delete o[t.sourceId]:(delete(i=Object(O.a)({},o[t.sourceId].views))[t.viewId],o[t.sourceId]={name:o[t.sourceId].name,views:i}),a.setState({filesList:o}),a.props.backendModeSignedInStatus===F.LOCAL_STORAGE&&(n?(xe(Ct(o)),delete(c=Object(O.a)({},a.state.nextNewFileIds.nextNewViewIdsForSourceIds))[t.sourceId],a.setState({nextNewFileIds:{source:a.state.nextNewFileIds.source,nextNewViewIdsForSourceIds:c}})):je(t.sourceId,o[t.sourceId].views));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleRenameFile=function(){var e=Object(b.a)(I.a.mark((function e(t){var n,r,o,i,c,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=document.getElementById("rename_field")){e.next=5;break}return e.abrupt("return");case 5:if((r=n.value.trim())&&r!==a.getFileName(t)){e.next=8;break}return e.abrupt("return");case 8:return o=g(t),i=o?Le.doRenameSource(t.sourceId,r):Le.doRenameView(t.sourceId,t.viewId,r),e.next=12,i;case 12:if(e.sent){e.next=16;break}return alert("failed to rename file"),e.abrupt("return");case 16:c=Object(O.a)({},a.state.filesList),o?c[t.sourceId]={name:r,views:c[t.sourceId].views}:(s=Object(O.a)(Object(O.a)({},c[t.sourceId].views),{},Object(W.a)({},t.viewId,Object(O.a)(Object(O.a)({},c[t.sourceId].views[t.viewId]),{},{name:r}))),c[t.sourceId]={name:c[t.sourceId].name,views:s}),a.setState({filesList:c}),a.props.backendModeSignedInStatus===F.LOCAL_STORAGE&&(o?xe(Ct(c)):je(t.sourceId,c[t.sourceId].views));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.componentDidMount=function(){Le.doGetFilesList().then((function(e){e?a.setState({filesList:e}):alert("failed to retrieve files list"),a.props.backendModeSignedInStatus===F.LOCAL_STORAGE&&a.setState({nextNewFileIds:Ce(a.state.filesList)})}))},a.componentDidUpdate=function(e,t){e.backendModeSignedInStatus!==a.props.backendModeSignedInStatus&&Le.doGetFilesList().then((function(e){return null!==e&&void 0!==e?e:{}})).then((function(e){a.setState(Object(O.a)(Object(O.a)({},Pt),{},{filesList:e,nextNewFileIds:a.props.backendModeSignedInStatus===F.LOCAL_STORAGE?Ce(e):null}))}))},a.renameInput=function(e){var t=e.inputType,n=e.fileId,o=Object(U.a)(e,["inputType","fileId"]),i=Lt[t](n),c=a.getRenameInputValueFunctions[t](n);return r.a.createElement("input",Object.assign({id:i,defaultValue:c,placeholder:c,disabled:m(n)||a.state.renaming.inputType!==t||a.state.renaming.fileId.sourceId!==n.sourceId||a.state.renaming.fileId.viewId!==n.viewId,onBlur:function(){a.handleRenameFile(t,n).then((function(){a.state.renaming.inputType===t&&a.state.renaming.fileId.sourceId===n.sourceId&&a.state.renaming.fileId.viewId===n.viewId&&a.handleCancelRenaming(t,n)}))},onKeyDown:function(e){"Escape"===e.key&&a.handleCancelRenaming(t,n)},onKeyPress:function(e){"Enter"===e.key&&e.target.blur()}},o))},a.fileListItem=function(e){var t=e.fileId,n=e.selected,o=e.open,i=e.handleEditMenuClick,c=e.childViewsExist,s=Object(pt.a)((function(e){return{root:{padding:"2px 4px",display:"flex",alignItems:"center",width:400},viewRoot:{padding:"2px 4px",display:"flex",alignItems:"center",width:200},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:5},divider:{height:28,margin:4}}}))(),l=a.getFileName(t);if(0!==t.viewId){var d=a.state.filesList[t.sourceId].views[t.viewId].type;return r.a.createElement(ct.a,{className:s.viewRoot,style:n?{backgroundColor:"rgba(0, 0, 0, 0.08)"}:{},component:"form",elevation:0},r.a.createElement(lt.a,null,d===u.CARD_VIEW?r.a.createElement(jt.a,null):d===u.TEXT_VIEW?r.a.createElement(kt.a,null):null),r.a.createElement(st.a,{value:l,className:"file_list_input",disabled:!(n&&a.state.renameSelected)}),r.a.createElement(Xe.a,{className:s.divider,orientation:"vertical"}),r.a.createElement(lt.a,{className:s.iconButton,onClick:i},r.a.createElement(mt.a,{fontSize:"small",color:"disabled"})))}return r.a.createElement(ct.a,{className:s.root,style:n?{backgroundColor:"#a3d2f7",border:"solid #3f51b5 thin"}:{},component:"form",elevation:0},r.a.createElement(st.a,{value:l,className:"file_list_input",disabled:!(n&&a.state.renameSelected)}),c?o?r.a.createElement(rt.a,null):r.a.createElement(it.a,null):null,r.a.createElement(Xe.a,{className:s.divider,orientation:"vertical"}),r.a.createElement(lt.a,{className:s.iconButton,onClick:i},r.a.createElement(mt.a,{fontSize:"small",color:"disabled"})))},a.handleFileListClick=function(e){e===a.state.selectedFileId?a.setState({selectedViewId:null,selectedFileOpen:!a.state.selectedFileOpen}):Tt({sourceId:e,viewId:0})&&a.setState({selectedFileId:e,selectedViewId:null,selectedFileOpen:!0})},a.handleViewListClick=function(e){Tt(e),a.setState({selectedViewId:e.viewId})},a.handleEditMenuClick=function(e){a.setState({editMenuAnchorElement:e.currentTarget})},a.handleEditMenuClose=function(){a.setState({editMenuAnchorElement:null})},a.handleDeleteMenuClick=function(){a.handleEditMenuClose();var e={sourceId:a.state.selectedFileId,viewId:null===a.state.selectedViewId?0:a.state.selectedViewId};a.handleDeleteFile(e).then((function(t){0!==e.viewId?a.setState({selectedViewId:null}):a.setState({selectedFileId:null,selectedViewId:null,selectedFileOpen:!1})}))},a.handleRenameMenuClick=function(e){a.setState({renamePopoverElement:a.state.editMenuAnchorElement,editMenuAnchorElement:null})},a.handleRenamePopoverClose=function(){a.setState({renamePopoverElement:null})},a.handleViewMenuOpen=function(e){a.setState({newViewAnchorElement:a.state.editMenuAnchorElement})},a.handleViewMenuClose=function(){a.setState({newViewAnchorElement:null,editMenuAnchorElement:null})},a.render=function(){m(a.props.currentOpenFileId),a.props.currentOpenFileId.sourceId,a.props.currentOpenFileId;var e=Nt(a.state.filesList),t=a.state.searching?a.handleDoFileNamesSearch():a.state.filesList,n=Nt(t);return r.a.createElement("div",{className:"SidePane"},null===a.state.selectedFileId?null:r.a.createElement("div",null,r.a.createElement("div",{id:"current_file_container"},r.a.createElement(A.a,{container:!0,spacing:3,alignItems:"center"},r.a.createElement(A.a,{item:!0,xs:3},r.a.createElement(lt.a,null,r.a.createElement(xt.a,null))),r.a.createElement(A.a,{item:!0,xs:9},r.a.createElement(V.a,{variant:"h6",color:"inherit",id:"current_source_name_input"},a.getFileName({sourceId:a.state.selectedFileId,viewId:0}))))),r.a.createElement(Xe.a,{variant:"middle"})),r.a.createElement("div",{id:"file_list_container"},r.a.createElement(M.a,{variant:"outlined",color:"primary",endIcon:r.a.createElement(Ke.a,null),disableElevation:!0,id:"new_document_button",onClick:function(){a.handleCreateNewFile(u.SOURCE)}},"New Document"),r.a.createElement("div",{className:"InputRow",id:"search_file_names_input_row"},r.a.createElement($e.a,{variant:"outlined",id:"search_file_names_input",startAdornment:r.a.createElement(ze.a,{position:"start"},r.a.createElement(Ye.a,null)),style:{width:"100%"},title:"Search File Names",placeholder:"Search File Names",onChange:Object(K.debounce)(a.handleChangeSearchingInput,150),onKeyPress:function(e){"Enter"===e.key&&e.target.blur()},onKeyDown:function(e){"Escape"===e.key&&e.target.blur()}})),Object.keys(t).length>0?r.a.createElement(Qe.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:r.a.createElement(qe.a,{component:"div",id:"nested-list-subheader"},"Source Files"),id:"file_list",style:{maxWidth:360,width:"100%"}},Object.entries(t).map((function(e){var t=Object(H.a)(e,2),n=t[0],o=t[1].views;return r.a.createElement("div",null,r.a.createElement(Ze.a,{button:!0,key:n,disableGutters:!0,divider:!0,style:{padding:"0px"},onClick:function(){a.handleFileListClick(n)}},r.a.createElement(Bt,Object(W.a)({fileId:{sourceId:n,viewId:0},selected:n===a.state.selectedFileId,open:n===a.state.selectedFileId&&a.state.selectedFileOpen,handleEditMenuClick:a.handleEditMenuClick,childViewsExist:Object.keys(o).length>0,fileName:a.getFileName({sourceId:n,viewId:0}),renameSelected:a.state.renameSelected},"handleEditMenuClick",a.handleEditMenuClick))),Object.keys(o).length>0?r.a.createElement(nt.a,{in:n===a.state.selectedFileId&&a.state.selectedFileOpen,timeout:"auto",unmountOnExit:!0},r.a.createElement(Qe.a,{component:"div",disablePadding:!0,style:{borderStyle:"none solid solid solid",borderColor:"#3f51b5",borderWidth:"thin",borderRadius:"4px"}},Object.keys(o).map((function(e){var t={sourceId:n,viewId:e,viewType:o[e].type};return r.a.createElement(Ze.a,{button:!0,key:h(t),disableGutters:!0,divider:!0,style:{paddingTop:"0px",paddingBottom:"0px",backgroundColor:"transparent"},onClick:function(){a.handleViewListClick(t)}},r.a.createElement(Bt,Object(W.a)({fileId:t,open:e===a.state.selectedViewId,handleEditMenuClick:a.handleEditMenuClick,fileName:a.getFileName(t),viewType:o[e].type,renameSelected:a.state.renameSelected,selected:e===a.state.selectedViewId},"handleEditMenuClick",a.handleEditMenuClick)))})))):null)}))):r.a.createElement("div",{className:"PlaceholderDivWithText",id:"no_files_placeholder"},"No Files"),r.a.createElement(gt.a,{id:"edit_menu",anchorEl:a.state.editMenuAnchorElement,keepMounted:!0,open:Boolean(a.state.editMenuAnchorElement),onClose:function(){return a.handleEditMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"}},null===a.state.selectedViewId?r.a.createElement(vt.a,{onClick:function(){return a.handleViewMenuOpen()}},r.a.createElement(et.a,null,r.a.createElement(Ot.a,{fontSize:"small"})),r.a.createElement(tt.a,{primary:"New View"})):null,r.a.createElement(vt.a,{onClick:function(){return a.handleRenameMenuClick()}},r.a.createElement(et.a,null,r.a.createElement(wt.a,{fontSize:"small"})),r.a.createElement(tt.a,{primary:"Rename"})),r.a.createElement(vt.a,{onClick:function(){return a.handleDeleteMenuClick()}},r.a.createElement(et.a,null,r.a.createElement(dt.a,{fontSize:"small"})),r.a.createElement(tt.a,{primary:"Delete"}))),r.a.createElement(gt.a,{id:"viewMenu",anchorEl:a.state.newViewAnchorElement,keepMounted:!0,open:Boolean(a.state.newViewAnchorElement),onClose:function(){return a.handleViewMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(vt.a,{onClick:function(){a.handleViewMenuClose(),a.handleCreateNewFile(u.TEXT_VIEW)}},r.a.createElement(et.a,null,r.a.createElement(kt.a,{fontSize:"small"})),r.a.createElement(tt.a,{primary:"Text View"})),r.a.createElement(vt.a,{onClick:function(){a.handleViewMenuClose(),a.handleCreateNewFile(u.CARD_VIEW)}},r.a.createElement(et.a,null,r.a.createElement(jt.a,{fontSize:"small"})),r.a.createElement(tt.a,{primary:"Card View"}))),r.a.createElement(It.a,{open:Boolean(a.state.renamePopoverElement),anchorEl:a.state.renamePopoverElement,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},id:"rename_popover"},r.a.createElement($e.a,{id:"rename_field",defaultValue:a.getFileName({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),onKeyPress:function(e){"Enter"===e.key&&(a.handleRenameFile({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),a.handleRenamePopoverClose())},onKeyDown:function(e){"Escape"===e.key&&a.handleRenamePopoverClose()},endAdornment:r.a.createElement(ze.a,{position:"end"},r.a.createElement(lt.a,{onClick:function(){a.handleRenameFile({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),a.handleRenamePopoverClose()}},r.a.createElement(St.a,null))),disableUnderline:!0,fullWidth:!0,style:{height:"50px",paddingLeft:"10px"}})),r.a.createElement("div",{className:"PlaceholderDivWithText",id:"filtered_files_placeholder",hidden:!a.state.searching},e-n+" of "+e+" files hidden by search")),r.a.createElement("div",{id:"user_controls_container"},a.props.backendModeSignedInStatus===F.USER_SIGNED_IN?r.a.createElement(M.a,{variant:"outlined",onClick:function(){a.props.dispatchSetBackendModeSignedInStatusAction(F.USER_SIGNED_OUT)&&y.a.remove("access_token")}},"Sign out"):null,r.a.createElement(M.a,{variant:"outlined",onClick:function(){a.props.backendModeSignedInStatus===F.LOCAL_STORAGE?j().then((function(e){a.handleSwitchBackendModeSignedInStatus(e)})):a.handleSwitchBackendModeSignedInStatus(F.LOCAL_STORAGE)}},"Switch to "+(a.props.backendModeSignedInStatus===F.LOCAL_STORAGE?"cloud":"local")+" storage")))},a}return n}(r.a.Component),Ut=Object(i.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,backendModeSignedInStatus:e.backendModeSignedInStatus}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(_(t))}}}))(Gt),Wt=(n(486),n(196),n(487),n(51)),Ht=n(99),Kt=n(84),$t=n(81),zt=n(213),Jt=n(212),Yt=n.n(Jt),Xt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).render=function(){var e=a.props.content;if(void 0!==e){var t=e.index,n=e.front,o=e.back;return r.a.createElement(Yt.a,{isFlipped:a.state.isFlipped,flipDirection:"vertical"},a.createBootstrapCard(t,n),a.createBootstrapCard(t,o))}return null},console.log(a.props.content),a.state={isFlipped:!1,key:a.props.content.index,front:a.props.content.front,back:a.props.content.back},a.handleClick=a.handleClick.bind(Object($t.a)(a)),a.createBootstrapCard=a.createBootstrapCard.bind(Object($t.a)(a)),a}return Object(ge.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.setState((function(e){return{isFlipped:!e.isFlipped}}))}},{key:"createBootstrapCard",value:function(e,t){return r.a.createElement(zt.a,{key:e,text:"black",className:"BootstrapCard",onClick:this.handleClick},t&&r.a.createElement(he.a,{className:"Card",readOnly:!0,key:"card".concat(e),defaultValue:JSON.stringify(t),jsonStrValue:!0}))}}]),n}(r.a.Component),qt=n(58),Qt=n(27),Zt=n(85);function en(){var e=Object(qt.a)(["\n\t\t\toverflow-x: hidden;\n\t\t\toverflow-y: auto;\n\t\t\theight: 200px;\n\t\t\tpadding-bottom: 30px;\n\t\t"]);return en=function(){return e},e}function tn(){var e=Object(qt.a)(["\n\t\t\tpadding: 8px;\n\t\t"]);return tn=function(){return e},e}function nn(){var e=Object(qt.a)(["\n\t\t\tpadding: 8px;\n\t\t"]);return nn=function(){return e},e}function an(){var e=Object(qt.a)(["\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-top: 10px;\n\t\t\tmargin-bottom: 10px;\n\t\t\ttransition: background-color 0.2s ease;\n\t\t\tbackground-color: ",";\n\t\t"]);return an=function(){return e},e}function rn(){var e=Object(qt.a)([""]);return rn=function(){return e},e}function on(){var e=Object(qt.a)([""]);return on=function(){return e},e}function cn(){var e=Object(qt.a)(["\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-bottom: 8px;\n\t\t\tbackground-color: ",";\n\t\t"]);return cn=function(){return e},e}var sn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).render=function(){var t=Qt.default.div(cn(),(function(e){return e.isDragging?"lightgreen":"white"})),n=Qt.default.h5(on()),a=Qt.default.div(rn());return r.a.createElement(Zt.b,{draggableId:e.props.tagId,index:e.props.index},(function(o,i){return r.a.createElement(t,Object.assign({ref:o.innerRef},o.draggableProps,o.dragHandleProps,{isDragging:i.isDragging}),r.a.createElement(n,null,e.props.tagInfo.tag_name),r.a.createElement(a,null,e.props.tagInfo.preview))}))},e}return n}(r.a.Component),ln=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(ge.a)(n,[{key:"shouldComponentUpdate",value:function(e,t,n){return e.tagData!==this.props.tagData}},{key:"render",value:function(){var e=this;return Object.keys(this.props.tagData).map((function(t,n){return r.a.createElement(sn,{key:t,tagId:t,index:n,tagInfo:e.props.tagData[t]})}))}}]),n}(r.a.Component),un=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).render=function(){var e=Qt.default.div(an(),(function(e){return e.isDraggingOver?"skyblue":"white"})),t=Qt.default.h3(nn()),n=Qt.default.div(tn()),o=Qt.default.div(en());return r.a.createElement(Zt.c,{droppableId:a.props.column.id},(function(i,c){return r.a.createElement(e,{isDraggingOver:c.isDraggingOver},r.a.createElement(t,null,a.props.column.title),r.a.createElement(n,Object.assign({ref:i.innerRef},i.droppableProps),r.a.createElement(o,{ref:a.tagListRef},r.a.createElement(ln,{tagData:a.props.tagData}),i.placeholder)))}))},a.tagListRef=r.a.createRef(),a}return Object(ge.a)(n,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var n=this.tagListRef.current;return n.scrollHeight-n.scrollTop}},{key:"componentDidUpdate",value:function(e,t,n){if(null!==n){var a=this.tagListRef.current;a.scrollTop=a.scrollHeight-n}}}]),n}(r.a.Component),dn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).onDragEnd=function(e){var t=e.destination,n=e.source,r=e.draggableId;if(t&&(t.droppableId!==n.droppableId||t.index!==n.index)){var o={};if(t.droppableId===n.droppableId){var i=a.state.columns[n.droppableId],c=Array.from(i.tagIds);c.splice(n.index,1),c.splice(t.index,0,r);var s=Object(O.a)(Object(O.a)({},i),{},{tagIds:c});o=Object(O.a)(Object(O.a)({},a.state),{},{columns:Object(O.a)(Object(O.a)({},a.state.columns),{},Object(W.a)({},s.id,s))})}else{var l,u=a.state.columns[n.droppableId],d=a.state.columns[t.droppableId],p=Array.from(u.tagIds);p.splice(n.index,1);var f=Object(O.a)(Object(O.a)({},u),{},{tagIds:p}),m=Array.from(d.tagIds);m.splice(t.index,0,r);var g=Object(O.a)(Object(O.a)({},d),{},{tagIds:m});o=Object(O.a)(Object(O.a)({},a.state),{},{columns:Object(O.a)(Object(O.a)({},a.state.columns),{},(l={},Object(W.a)(l,f.id,f),Object(W.a)(l,g.id,g),l))})}a.props.setTagsInView(o.columns.tags_in_view.tagIds),a.setState(o)}},a.render=function(){return r.a.createElement(Zt.a,{onDragEnd:a.onDragEnd},r.a.createElement(Wt.a,null,r.a.createElement(Ht.a,{className:"justify-content-md-center"},a.state.columnOrder.map((function(e){var t,n=a.state.columns[e],o={},i=Object(ke.a)(n.tagIds);try{for(i.s();!(t=i.n()).done;){var c=t.value;o[c]=a.state.tagData[c]}}catch(s){i.e(s)}finally{i.f()}return r.a.createElement(Kt.a,{key:n.id,md:"12",lg:"6"},r.a.createElement(un,{key:n.id,column:n,tagData:o}))})))))};var o=new Set(a.props.tagsInView),i=Object.keys(a.props.allTagsData).filter((function(e){return!o.has(e)}));var s=a.props.allTagsData;return Object.keys(s).forEach((function(e){var t=function e(t){for(var n=0;n<t.content.length;++n){var a=t.content[n];if("text"===a.type)return a.text;if(a){var r=e(a);if(""!==r)return r}}return""}(s[e].content);s[e].preview=t.substring(0,50),t.length>50&&(s[e].preview+=" . . .")})),a.state={tagData:s,columns:{tags_in_view:{id:"tags_in_view",title:"Tags in View",tagIds:a.props.tagsInView},tags_available:{id:"tags_available",title:"Available Tags",tagIds:i}},columnOrder:["tags_in_view","tags_available"]},a}return Object(ge.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){if(e.tagsInView!==this.props.tagsInView){var a=new Set(this.props.tagsInView),r=Object.keys(this.props.allTagsData).filter((function(e){return!a.has(e)})),o=Object.assign({},this.state);o.columns.tags_in_view.tagIds=a,o.columns.tags_available.tagIds=r,this.setState(o)}}}]),n}(r.a.Component),pn=Object(i.c)((function(e){return{tagsInView:e.tagsInView}}),(function(e){return{setTagsInView:function(t){return e(ce(t))}}}))(dn),fn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).keydownHandler=function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode&&(e.preventDefault(),Le.doSaveViewSpec(a.props.tagsInView,a.props.currentOpenFileId.sourceId,a.props.currentOpenFileId.viewId,u.CARD_VIEW,!1).then((function(){return alert("Card view saved")})).catch((function(){return alert("Failed to save card view")})))},a.constructDoc=function(e){return{type:"doc",content:[a.state.allTagsData[e].content]}},a.constructCard=function(e){var t={index:e};return t.front=a.constructDoc(a.props.tagsInView[e]),e+1<a.props.tagsInView.length?t.back=a.constructDoc(a.props.tagsInView[e+1]):t.back=null,r.a.createElement(Xt,{content:t})},a.componentDidMount=function(){document.addEventListener("keydown",a.keydownHandler)},a.componentDidUpdate=function(e){e.tagsInView!==a.props.tagsInView&&a.props.setTagsInView(a.props.tagsInView)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keydownHandler)},a.render=function(){if(a.state.allTagsData&&null!=a.props.tagsInView){for(var e=[],t=0;t<a.props.tagsInView.length;t+=4)e.push(r.a.createElement(Ht.a,{key:"row_".concat(t%4),className:"justify-content-md-center"},r.a.createElement(Kt.a,{lg:"12",xl:"6"},a.constructCard(t)),r.a.createElement(Kt.a,{lg:"12",xl:"6"},t+2<a.props.tagsInView.length&&a.constructCard(t+2))));return r.a.createElement(Wt.a,{className:"viewContainer"},r.a.createElement(pn,{allTagsData:a.state.allTagsData,tagsInView:a.props.tagsInView}),e)}return r.a.createElement(Wt.a,{className:"viewContainer"},r.a.createElement("h5",null,"Loading Card Deck ..."))},a.state={allTagsData:e.data.allTagsData},a.props.setTagsInView(e.data.tagsInView),a}return n}(r.a.Component),mn=Object(i.c)((function(e){return{tagsInView:e.tagsInView,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{setTagsInView:function(t){return e(ce(t))}}}))(fn),gn=(n(488),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).keydownHandler=function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode&&(e.preventDefault(),Le.doSaveViewSpec(a.props.tagsInView,a.props.currentOpenFileId.sourceId,a.props.currentOpenFileId.viewId,u.TEXT_VIEW,!1).then((function(){return alert("Text view saved")})).catch((function(){return alert("Failed to save text view")})))},a.constructTextView=function(){return{type:"doc",content:a.props.tagsInView.map((function(e){return a.state.allTagsData[e].content}))}},a.componentDidMount=function(){document.addEventListener("keydown",a.keydownHandler)},a.componentDidUpdate=function(e){e.tagsInView!==a.props.tagsInView&&a.props.setTagsInView(a.props.tagsInView)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keydownHandler)},a.render=function(){return a.state.allTagsData&&null!=a.props.tagsInView?r.a.createElement(Wt.a,{className:"viewContainer"},r.a.createElement(pn,{allTagsData:a.state.allTagsData,tagsInView:a.props.tagsInView}),a.props.tagsInView.length>0&&r.a.createElement(he.a,{className:"TextViewEditor",readOnly:!0,key:"text_view",defaultValue:JSON.stringify(a.constructTextView()),jsonStrValue:!0})):r.a.createElement(Wt.a,{className:"viewContainer"},r.a.createElement("h5",null,"Loading Text View ..."))},a.state={allTagsData:e.data.allTagsData},a.props.setTagsInView(e.data.tagsInView),a}return n}(r.a.Component)),vn=Object(i.c)((function(e){return{tagsInView:e.tagsInView,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{setTagsInView:function(t){return e(ce(t))}}}))(gn),hn={sourceId:0,viewId:0,data:null,fileType:u.EMPTY},wn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state=hn,e.changeFile=Object(b.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Le.doGetView(e.props.currentOpenFileId).then((function(t){null===t?(alert("failed to retrieve view"),Tt(d)):e.setState({sourceId:e.props.currentOpenFileId.sourceId,viewId:e.props.currentOpenFileId.viewId,data:{tagsInView:t.view.order,allTagsData:t.tags.items},fileType:e.props.currentOpenFileId.viewType})}));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.changeFile().then((function(){return console.log("Mounted view file")}))},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||e.changeFile().then((function(){return console.log("Updated view file")}))},e.render=function(){return e.state.fileType===u.CARD_VIEW?r.a.createElement(mn,{data:e.state.data}):e.state.fileType===u.TEXT_VIEW?r.a.createElement(vn,{data:e.state.data}):null},e}return n}(r.a.Component),In=Object(i.c)((function(e){return{currentOpenFileId:e.currentOpenFileId}}))(wn),bn={fileType:u.EMPTY},Sn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state=bn,e.changeFile=function(){g(e.props.currentOpenFileId)?e.setState({fileType:u.SOURCE}):v(e.props.currentOpenFileId)?e.setState({fileType:u.CARD_VIEW}):e.setState({fileType:u.EMPTY})},e.componentDidMount=function(){e.changeFile()},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||e.changeFile()},e.render=function(){return e.state.fileType===u.EMPTY?r.a.createElement(Wt.a,{className:"viewContainer"},r.a.createElement("h5",null,"Click/create a document!")):e.state.fileType===u.SOURCE?r.a.createElement(We,null):r.a.createElement(In,null)},e}return n}(r.a.Component),yn=Object(i.c)((function(e){return{currentOpenFileId:e.currentOpenFileId}}))(Sn),On=(n(489),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={mounted:!1},e.keydownHandler=function(t){(window.navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&83===t.keyCode&&(t.preventDefault(),e.props.backendModeSignedInStatus!==F.USER_SIGNED_OUT&&g(e.props.currentOpenFileId)&&Re())},e.componentWillUnmount=function(){document.removeEventListener("keydown",e.keydownHandler)},e.componentDidMount=function(){document.addEventListener("keydown",e.keydownHandler),e.props.backendModeSignedInStatus!==F.LOCAL_STORAGE?j().then((function(t){e.props.dispatchSetBackendModeSignedInStatusAction(t),e.setState({mounted:!0})})):e.setState({mounted:!0})},e.render=function(){return r.a.createElement(r.a.Fragment,null,e.state.mounted?e.props.backendModeSignedInStatus!==F.USER_SIGNED_OUT?r.a.createElement("div",{className:"App"},r.a.createElement("div",{style:{position:"absolute",top:"9px",right:"16px",fontSize:".75em"}},r.a.createElement("span",{role:"img","aria-label":"Yet Another Docs App"},"\ud83d\udc07 \xa0 ",r.a.createElement("b",null,"Y"),"et ",r.a.createElement("b",null,"A"),"nother ",r.a.createElement("b",null,"D"),"ocs ",r.a.createElement("b",null,"A"),"pp")),r.a.createElement(Ut,null),r.a.createElement(yn,null)):r.a.createElement(G,null):null)},e}return n}(r.a.Component)),En=Object(i.c)((function(e){return{backendModeSignedInStatus:e.backendModeSignedInStatus,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(_(t))}}}))(On);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(o.render)(r.a.createElement(r.a.StrictMode,null,r.a.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"}),r.a.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}),r.a.createElement("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),r.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Bungee&display=swap",rel:"stylesheet"}),r.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Signika:wght@300&display=swap",rel:"stylesheet"}),r.a.createElement(i.a,{store:se},r.a.createElement(En,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[225,1,2]]]);
//# sourceMappingURL=main.8de2a9fc.chunk.js.map