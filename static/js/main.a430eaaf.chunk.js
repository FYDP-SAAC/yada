(this.webpackJsonpYADA=this.webpackJsonpYADA||[]).push([[0],{136:function(e,t,n){},180:function(e,t,n){e.exports=n.p+"static/media/logo.e9d28ab1.png"},181:function(e,t,n){e.exports=n.p+"static/media/graphic.af8be1b2.png"},287:function(e,t,n){e.exports=n(562)},296:function(e,t,n){},298:function(e,t,n){},317:function(e,t,n){e.exports=n.p+"static/media/darkLogo.eccc7628.png"},318:function(e,t,n){},319:function(e,t,n){},547:function(e,t,n){},548:function(e,t,n){},549:function(e,t,n){},556:function(e,t,n){},561:function(e,t,n){},562:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),i=n(12),s=n(27),c=(n(296),n(22)),l=n(51),u=n(24),d=n(23),p=(n(297),n(298),n(8)),m=n.n(p),f=n(13),g=n(36),v=n.n(g),h=n(10),w=function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,o=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:7500,r=new AbortController,setTimeout((function(){r.abort()}),a),e.next=5,fetch(t,Object(h.a)(Object(h.a)({},n),{},{signal:r.signal})).then((function(e){return e.ok||console.log(e),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y="https://yaas-gca4j5hw3q-uc.a.run.app/",I={USER_SIGNED_IN:"USER_SIGNED_IN",USER_SIGNED_OUT:"USER_SIGNED_OUT",LOCAL_STORAGE:"LOCAL_STORAGE"},b=function(){var e=Object(f.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=v.a.get("access_token"))){e.next=14;break}return e.prev=2,e.next=5,w(y+"auth",{headers:new Headers({"Set-Cookie":"token=".concat(t)})});case 5:if(n=e.sent,!n.ok){e.next=9;break}return e.abrupt("return",I.USER_SIGNED_IN);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:return e.abrupt("return",I.USER_SIGNED_OUT);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),S=function(e){return{type:"backendModeSignedInStatus/set",status:e}},E=n(246),O=n(247),k=n.n(O),F=n(603),T=n(608),x=n(85),N=n(609),j=n(116),C=n.n(j),_=n(630),D=function(e){return{type:"newUser/set",newUser:e}},A="709358329925-gic89ini15sgaenfrta1gshej1ik72jg.apps.googleusercontent.com",V=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleLoginSuccess=function(){var t=Object(f.a)(m.a.mark((function t(n){var a,r,o,i,s,c,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.profileObj,r=a.name,o=a.email,i=n.tokenObj,s=i.id_token,c=i.expiresAt,l=null,t.prev=2,t.next=5,k.a.post(y+"register_user",{method:"POST",body:JSON.stringify({name:r,email:o,token:s}),headers:{"Content-Type":"application/json","Set-Cookie":"token=".concat(s)}},{withCredentials:!0});case 5:l=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:l&&201===l.status&&(e.props.dispatchNewUserAction(l.data.is_new),v.a.set("access_token",s,{expires:new Date(c)}),e.props.dispatchSetBackendModeSignedInStatusAction(I.USER_SIGNED_IN));case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}(),e.render=function(){return o.a.createElement("div",{style:{display:"flex",flexFlow:"column",height:"100vh",overflow:"hidden"}},o.a.createElement(F.a,{position:"static",class:"custom-navbar"},o.a.createElement(T.a,null,o.a.createElement("img",{className:"menuButton",src:n(180),style:{width:"50px",marginRight:"1%"},alt:"MENU"}))),o.a.createElement("div",{style:{backgroundColor:"#F5F0E1",flex:"1 1 auto",display:"flex"}},o.a.createElement(N.a,{container:!0,alignItems:"center"},o.a.createElement(_.a,{smDown:!0},o.a.createElement(N.a,{item:!0,md:1})),o.a.createElement(N.a,{item:!0,sm:12,md:5,alignItems:"center"},o.a.createElement(N.a,{container:!0,spacing:3,alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:3},o.a.createElement("img",{src:n(317),style:{width:"90%",marginLeft:"20%"},alt:"YADA"})),o.a.createElement(N.a,{item:!0,xs:9},o.a.createElement(x.a,{variant:"h1",className:"title",style:{fontFamily:"Bungee",color:"#1E3D59"}},"YADA",o.a.createElement(C.a,{text:"",style:{fontFamily:"Signika"},speed:1e4})),o.a.createElement(x.a,{variant:"h3",className:"title",style:{fontFamily:"Signika",color:"#1E3D59"}},"Yet Another Docs App"))),o.a.createElement("br",null),o.a.createElement("div",{align:"center"},o.a.createElement(E.GoogleLogin,{clientId:A,buttonText:"Sign in with Google",onSuccess:function(t){e.handleLoginSuccess(t)},onFailure:function(e){console.log(e)},cookiePolicy:"single_host_origin",responseType:"code,token",style:{float:"left"}}))),o.a.createElement(_.a,{mdUp:!0},o.a.createElement(N.a,{item:!0,sm:3})),o.a.createElement(_.a,{smDown:!0},o.a.createElement(N.a,{item:!0,md:1})),o.a.createElement(N.a,{item:!0,sm:6,md:4},o.a.createElement("img",{src:n(181),style:{width:"100%"},alt:"Document Graphic"})),o.a.createElement(_.a,{smDown:!0},o.a.createElement(N.a,{item:!0,md:1})),o.a.createElement(_.a,{mdUp:!0},o.a.createElement(N.a,{item:!0,sm:3})))))},e}return a}(o.a.Component),M=Object(s.c)((function(e){return{backendModeSignedInStatus:e.backendModeSignedInStatus}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(S(t))},dispatchNewUserAction:function(t){return e(D(t))}}}))(V),P=n(37),L=n(54),R=(n(318),n(44)),U={SOURCE:"SOURCE",TEXT_VIEW:"TEXT_VIEW",CARD_VIEW:"CARD_VIEW",EMPTY:"NON_EXISTENT"},B={sourceId:0,viewId:0,viewType:U.EMPTY},W=function(e){return e.hasOwnProperty("sourceId")&&e.hasOwnProperty("viewId")},G=function(e){return e.hasOwnProperty("fileId")&&W(e.fileId)},z=function(e){return e.hasOwnProperty("fileName")&&((t=e.fileName).hasOwnProperty("sourceName")&&t.hasOwnProperty("viewName"));var t},H=function(e){return W(e)&&!e.sourceId&&!e.viewId},$=function(e){return W(e)&&e.sourceId&&!e.viewId},K=function(e){return W(e)&&e.sourceId&&e.viewId},Y=function(e){return W(e)?e.sourceId+(e.viewId?"#"+e.viewId:""):""},J=(n(136),function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return JSON.parse(e)},r=t;if(e)try{r=a(e)}catch(o){n&&console.log(n),console.log(o)}return r}),X=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return JSON.parse(e)};if(!e)return t;var r=null;try{r=a(e)}catch(o){n&&console.log(n),console.log(o)}return r},q=J(localStorage.getItem("initialFileId"),{},"invalid initialFileId"),Q=J(localStorage.getItem("initialFileName"),{},"invalid initialFileName"),Z={sourceId:q.hasOwnProperty("sourceId")?q.sourceId:B.sourceId,viewId:q.hasOwnProperty("viewId")?q.viewId:B.viewId,viewType:q.hasOwnProperty("viewType")?q.viewType:B.viewType},ee={sourceName:Q.hasOwnProperty("sourceName")?Q.sourceName:"",viewName:Q.hasOwnProperty("viewName")?Q.viewName:""},te={sourceId:B.sourceId,viewId:B.viewId,viewType:B.viewType},ne={sourceName:"",viewName:""},ae=function(e){return{type:"currentOpenFileId/set",fileId:e}},re=function(e){return{type:"currentOpenFileName/set",fileName:e}},oe=function(e){return{type:"selectNode/set",selectNode:e}},ie=n(5),se=(n(319),n(631)),ce=n(73),le=n.n(ce),ue=n(28),de=n(267),pe=n(34),me=function(e){return{type:"tagsInView/set",tagsInView:e}},fe=function(e){return{type:"toast/set",toast:e}},ge="error",ve="success",he={message:"",severity:"info",open:!1},we=Object(pe.c)({currentOpenFileId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;return"signout"===t.type?(console.log("setting to empty file id"),te):"currentOpenFileId/set"===t.type&&G(t)?t.fileId:e},currentOpenFileName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;return"signout"===t.type?ne:"currentOpenFileName/set"===t.type&&z(t)?t.fileName:e},saveDirtyFlag:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"saveDirtyFlag/set"!==t.type&&"saveDirtyFlag/clear"!==t.type?e:"saveDirtyFlag/set"===t.type},saveInProgress:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"save_in_progress/set"!==t.type&&"save_in_progress/clear"!==t.type?e:"save_in_progress/set"===t.type},fileLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"file_loading/set"!==t.type&&"file_loading/clear"!==t.type?e:"file_loading/set"===t.type},selectNode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"selectNode/set"!==t.type||!t.hasOwnProperty("selectNode")||t.selectNode&&!t.selectNode.hasOwnProperty("pos")?"selectNode/set"===t.type?null:e:t.selectNode},backendModeSignedInStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage.getItem("initialLocalStorageBackendMode")?I.LOCAL_STORAGE:I.USER_SIGNED_OUT,t=arguments.length>1?arguments[1]:void 0;return"backendModeSignedInStatus/set"===t.type&&t.hasOwnProperty("status")&&I.hasOwnProperty(t.status)?(t.status===I.LOCAL_STORAGE?localStorage.setItem("initialLocalStorageBackendMode",!0):localStorage.removeItem("initialLocalStorageBackendMode"),t.status):e},tagsInView:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"tagsInView/set"===t.type&&t.hasOwnProperty("tagsInView")?t.tagsInView:e},toast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;return"toast/set"===t.type&&t.hasOwnProperty("toast")?"clear"===t?he:t.toast:e},tagMenuOpened:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"tagMenuOpened/set"!==t.type?e:t.tagMenuOpened},newUser:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"newUser/set"!==t.type?e:t.newUser},tagEditorOpened:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"tagEditorOpened/set"!==t.type?e:t.tagEditorOpened}}),ye=Object(de.a)({reducer:function(e,t){return"signout"===t.type&&(e=void 0),we(e,t)}}),Ie=new ie.PluginKey("select-node"),be=new ie.Plugin({key:Ie,state:{init:function(){return null},apply:function(e,t,n){var a=e.selection.head,r=null;return e.doc.nodesBetween(a,a,(function(e,t){e.hasOwnProperty("attrs")&&e.attrs.tags&&(r={node:e,pos:t})})),(!n&&r||n&&!r||n&&r&&(r.pos!==n.pos||!r.node.eq(n.node)))&&ye.dispatch(oe(r?{pos:r.pos}:null)),r}},props:{decorations:function(e){var t=[],n=Ie.getState(e);return n&&t.push(ue.Decoration.node(n.pos,n.pos+n.node.nodeSize,{style:"background: #FAFAFA; outline: 1px solid #DCDCDC;"})),ue.DecorationSet.create(e.doc,t)}}}),Se=new ie.PluginKey("tag-filtering"),Ee=function e(t,n,a,r,o,i){var s=!1,c=r.hasOwnProperty("attrs")&&r.attrs.tags,l=Object(h.a)(Object(h.a)({},o),c?r.attrs.tags:null);if(c&&(s=function e(t,n){if(!n)return!0;if(!Array.isArray(n))return t.hasOwnProperty(n);if(2===n.length)return!e(t,n[1]);var a=e(t,n[0]);return 1===n.length||"&"===n[1]!==a?a:e(t,n[2])}(l,n)),!r.isTextblock)for(var u=1,d=0;d<r.childCount;++d){var p=r.child(d),m=e(t,n,a,p,l,i+u);s=s||m,u+=p.nodeSize}return 0===i||s||t.push(ue.Decoration.node(i-1,i-1+r.nodeSize,{style:"display: none;"})),s},Oe=new ie.Plugin({key:Se,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(Se);return void 0===n?t:n}},props:{decorations:function(e){var t=[],n=Se.getState(e),a=Ie.getState(e);return n&&Ee(t,n,a,e.doc,{},0),ue.DecorationSet.create(e.doc,t)}}}),ke=new ie.PluginKey("cancel-line-breaks"),Fe=new ie.Plugin({key:ke,filterTransaction:function(e,t){return $(ye.getState().currentOpenFileId)&&!Se.getState(t)||e.steps.every((function(e){return"replace"!==e.toJSON().stepType||!function(e){return e.slice.content.content.some((function(e){return!e.isLeaf}))}(e)&&!function(e,t){if(e.from===e.to)return!1;var n=t.nodeAt(e.from),a=t.nodeAt(e.to);return a?!n||n&&!n.eq(a):!n||!t.nodeAt(e.to-1).eq(n)}(e,t.doc)}))}}),Te=new(function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"name",get:function(){return"yada-blockTagging"}},{key:"plugins",get:function(){return[Fe,be,Oe]}}]),n}(ce.Extension)),xe=n(636),Ne=n(123),je=n.n(Ne),Ce=n(610),_e=n(239),De=n(103),Ae=n.n(De),Ve=n(612),Me=n(611),Pe=n(569),Le=n(617),Re=n(127),Ue=n.n(Re),Be=n(126),We=n.n(Be),Ge=n(269),ze=n(615),He=n(616),$e=n(628),Ke=n(128),Ye=n.n(Ke),Je=n(618),Xe=n(635),qe=/[^{}]/,Qe=/[{}]/,Ze=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){return o.a.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center"}},o.a.createElement(Xe.a,{label:e.props.tagValue,color:"primary",onDelete:function(t){return e.props.handleEditMenuClick(t,e.props.tagValue)},deleteIcon:o.a.createElement(Ae.a,{color:"secondary"}),style:{width:"100%",justifyContent:"space-between"},variant:"outlined"}))},e}return n}(o.a.Component),et=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={selectNodeAttrs:{},modifying:"",editMenuAnchorElement:null,renamePopoverElement:null,currentTag:""},e.handleAddTag=function(){var t=document.getElementById("add_tag_input").value.trim();if(!t||Qe.test(t)||!e.props.selectNode)return!1;if(e.state.selectNodeAttrs.hasOwnProperty("tags")&&e.state.selectNodeAttrs.tags.hasOwnProperty(t))return e.props.dispatchSetToastAction({message:'Tag value "'.concat(t,'" already exists'),severity:ge,open:!0}),!1;var n=Object(h.a)(Object(h.a)({},e.state.selectNodeAttrs),{},{tags:Object(h.a)({},e.state.selectNodeAttrs.tags)});return n.tags[t]=Object(se.a)(),Te.editor.view.dispatch(Te.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,n)),e.setState({selectNodeAttrs:n}),e.props.dispatchSetSaveDirtyFlagAction(),document.getElementById("add_tag_input").value="",!0},e.handleDeleteTag=function(){if(e.handleEditMenuClose(),!e.props.selectNode||!e.state.selectNodeAttrs.hasOwnProperty("tags")||!e.state.selectNodeAttrs.tags.hasOwnProperty(e.state.currentTag))return!1;var t=Object(h.a)(Object(h.a)({},e.state.selectNodeAttrs),{},{tags:Object(h.a)({},e.state.selectNodeAttrs.tags)});return delete t.tags[e.state.currentTag],Te.editor.view.dispatch(Te.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,t)),e.setState({selectNodeAttrs:t,currentTag:""}),e.props.dispatchSetSaveDirtyFlagAction(),!0},e.handleModifyTagValue=function(){var t=document.getElementById("rename_field").value.trim();if(!t||Qe.test(t)||!e.props.selectNode||!e.state.selectNodeAttrs.hasOwnProperty("tags")||!e.state.selectNodeAttrs.tags.hasOwnProperty(e.state.currentTag))return!1;if(t===e.state.currentTag)return!0;if(e.state.selectNodeAttrs.tags.hasOwnProperty(t))return e.props.dispatchSetToastAction({message:"Tag value ".concat(t," already exists"),severity:ge,open:!0}),!1;var n=Object(h.a)(Object(h.a)({},e.state.selectNodeAttrs),{},{tags:Object(h.a)({},e.state.selectNodeAttrs.tags)});return n.tags[t]=n.tags[e.state.currentTag],delete n.tags[e.state.currentTag],Te.editor.view.dispatch(Te.editor.view.state.tr.setNodeMarkup(e.props.selectNode.pos,null,n)),e.setState({selectNodeAttrs:n}),e.props.dispatchSetSaveDirtyFlagAction(),!0},e.componentDidMount=function(){e.props.dispatchSetTagMenuOpenedAction(!0)},e.componentDidUpdate=function(t){(t.currentOpenFileId.sourceId!==e.props.currentOpenFileId.sourceId||t.currentOpenFileId.viewId!==e.props.currentOpenFileId.viewId||!t.selectNode&&e.props.selectNode||t.selectNode&&!e.props.selectNode||t.selectNode&&e.props.selectNode&&t.selectNode.pos!==e.props.selectNode.pos)&&(document.getElementById("add_tag_input").value="",Object(R.defer)((function(){if(e.props.selectNode){var t=Te.editor.view.state.doc.nodeAt(e.props.selectNode.pos);e.setState({selectNodeAttrs:Object(h.a)({},t&&t.hasOwnProperty("attrs")?t.attrs:null)})}else e.setState({selectNodeAttrs:{}})})))},e.handleEditMenuClick=function(t,n){e.setState({editMenuAnchorElement:t.currentTarget,currentTag:n})},e.handleEditMenuClose=function(){e.setState({editMenuAnchorElement:null})},e.handleRenameMenuClick=function(t){e.setState({renamePopoverElement:e.state.editMenuAnchorElement,editMenuAnchorElement:null})},e.handleRenamePopoverClose=function(){e.setState({renamePopoverElement:null})},e.render=function(){return o.a.createElement("div",{className:"MarginPane"},o.a.createElement("div",{id:"tag_menu_wrapper"},o.a.createElement("div",{className:"InputRow",id:"add_tag_input_row"},o.a.createElement(xe.a,{id:"add_tag_input",title:"New Tag",placeholder:"New Tag",color:"primary",disabled:!e.props.selectNode,onKeyPress:function(t){"Enter"===t.key&&e.handleAddTag()&&(t.target.value=""),qe.test(t.key)||t.preventDefault()},onKeyDown:function(e){"Escape"===e.key&&(e.target.value="",Te.editor.view.focus())},endAdornment:o.a.createElement(Ce.a,{position:"end"},o.a.createElement(_e.a,{"aria-label":"Add",title:"add",disabled:!e.props.selectNode,onClick:e.handleAddTag,edge:"end"},o.a.createElement(je.a,{color:"primary"}))),margin:"dense"})),o.a.createElement("div",{id:"tag_menu_list_container"},e.props.selectNode&&e.state.selectNodeAttrs.hasOwnProperty("tags")&&Object.keys(e.state.selectNodeAttrs.tags).length>0?o.a.createElement(Me.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:o.a.createElement(Ve.a,{component:"div",id:"nested-list-subheader"},"Tags"),style:{maxWidth:360,width:"100%"}},Object.keys(e.state.selectNodeAttrs.tags).map((function(t){return o.a.createElement(Pe.a,{dense:!0},o.a.createElement(Ze,{tagValue:t,handleEditMenuClick:e.handleEditMenuClick}))}))):o.a.createElement("div",{className:"PlaceholderDivWithText",id:"no_tags_placeholder"},"No "+(e.props.selectNode?"Block Tags":"Selected Block")),o.a.createElement(Ge.a,{id:"edit_menu",anchorEl:e.state.editMenuAnchorElement,keepMounted:!0,open:Boolean(e.state.editMenuAnchorElement),onClose:function(){return e.handleEditMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"}},o.a.createElement(ze.a,{onClick:function(){return e.handleRenameMenuClick()}},o.a.createElement(He.a,null,o.a.createElement(We.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"Rename",color:"primary"})),o.a.createElement(ze.a,{onClick:function(){return e.handleDeleteTag()}},o.a.createElement(He.a,null,o.a.createElement(Ue.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"Delete",color:"primary"}))),o.a.createElement($e.a,{open:Boolean(e.state.renamePopoverElement),anchorEl:e.state.renamePopoverElement,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},id:"rename_popover"},o.a.createElement(Je.a,{id:"rename_field",autoFocus:!0,defaultValue:e.state.currentTag,onBlur:function(t){e.handleModifyTagValue(),e.handleRenamePopoverClose()},onKeyDown:function(t){"Escape"===t.key&&(t.target.value=e.state.currentTag)},onKeyPress:function(e){"Enter"===e.key&&e.target.blur(),qe.test(e.key)||e.preventDefault()},endAdornment:o.a.createElement(Ce.a,{position:"end"},o.a.createElement(_e.a,{onClick:function(){e.handleModifyTagValue(),e.handleRenamePopoverClose()}},o.a.createElement(Ye.a,null))),disableUnderline:!0,fullWidth:!0,style:{height:"50px",paddingLeft:"10px"}})))))},e}return n}(o.a.Component),tt=Object(s.c)((function(e){return{selectNode:e.selectNode,saveDirtyFlag:e.saveDirtyFlag,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{dispatchSetSaveDirtyFlagAction:function(){return e({type:"saveDirtyFlag/set"})},dispatchSetToastAction:function(t){return e(fe(t))},dispatchSetTagMenuOpenedAction:function(t){return e(function(e){return{type:"tagMenuOpened/set",tagMenuOpened:e}}(t))}}}))(et),nt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){var t=H(e.props.currentOpenFileId);return o.a.createElement("div",{className:"MainPane"},o.a.createElement("div",{className:"editor",hidden:t},o.a.createElement(le.a,{extensions:[Te],key:e.props.fileIdKeyStr,defaultValue:e.props.fileContent,jsonStrValue:!!e.props.fileContent,onKeyDown:function(e){"Escape"===e.key&&(Te.editor.view.dispatch(Te.editor.view.state.tr.setSelection(ie.TextSelection.create(Te.editor.view.state.doc,0,0))),e.target.blur())},onChange:function(){e.props.saveDirtyFlag||e.props.dispatchSetSaveDirtyFlagAction()}})),o.a.createElement("div",{className:"placeholder_editor",hidden:!t},o.a.createElement("h5",null,"Click or create a new document from the left pane")),o.a.createElement(tt,null))},e}return n}(o.a.Component),at=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,currentOpenFileName:e.currentOpenFileName,saveDirtyFlag:e.saveDirtyFlag}}),(function(e){return{dispatchSetSaveDirtyFlagAction:function(){return e({type:"saveDirtyFlag/set"})}}}))(nt),rt=n(619),ot=n(129),it=n(268),st=function(e,t){return localStorage.setItem("sourceViews_"+e,JSON.stringify(t))},ct=function(e){return X(localStorage.getItem("sourceViews_"+e),{},"invalid sourceViews")},lt=function(e){return localStorage.setItem("sourceIdNames",JSON.stringify(e))},ut=function(e,t){for(;!t||e.hasOwnProperty(t.toString());)t+=1;return t.toString()},dt=function(e){return{source:ut(e,0),nextNewViewIdsForSourceIds:Object.fromEntries(Object.entries(e).map((function(e){var t=Object(L.a)(e,2),n=t[0],a=t[1].views;return[n,ut(a,0)]})))}},pt={doGetFilesList:function(){var e=Object(f.a)(m.a.mark((function e(){var t,n,a,r,o,i,s,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=X(localStorage.getItem("sourceIdNames"),{},"invalid sourceIdNames")){e.next=3;break}return e.abrupt("return",null);case 3:n={},a=0,r=Object.entries(t);case 5:if(!(a<r.length)){e.next=14;break}if(o=Object(L.a)(r[a],2),i=o[0],s=o[1],c=ct(i)){e.next=10;break}return e.abrupt("return",null);case 10:n[i]={name:s,views:c};case 11:a++,e.next=5;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),doSaveViewSpec:function(){var e=Object(f.a)(m.a.mark((function e(t,n,a,r,o){var i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="viewSpec_"+Y(n),t.length>0?localStorage.setItem(i,JSON.stringify(t)):localStorage.removeItem(i),e.abrupt("return",Object(h.a)({id:a,sourceId:n},o?{name:"Unnamed View",type:r}:null));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),doGetView:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(localStorage.getItem("viewSpec_"+Y(t.sourceId,t.viewId)),[],"invalid viewSpec"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doGetSourceTaggedBlocks:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,r,o,i,s,c,l,u,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("sourceContent_"+t)){e.next=3;break}return e.abrupt("return",{});case 3:if(a=J(n,null,"invalid sourceContent")){e.next=6;break}return e.abrupt("return",null);case 6:if(r={},a)for(o=[a];o.length>0;)if((i=o.shift()).hasOwnProperty("attrs")&&i.attrs.hasOwnProperty("tags"))for(s=0,c=Object.entries(i.attrs.tags);s<c.length;s++)l=Object(L.a)(c[s],2),u=l[0],d=l[1],r[d]={tag:u,node:i};else i.hasOwnProperty("content")&&o.push.apply(o,Object(it.a)(i.content));return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doSaveSourceContent:function(){var e=Object(f.a)(m.a.mark((function e(t,n,a){var r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=X(t,"","invalid sourceContent value",(function(e){return JSON.parse(e),e})))){e.next=3;break}return e.abrupt("return",null);case 3:return o="sourceContent_"+n,r?localStorage.setItem(o,r):localStorage.removeItem(o),e.abrupt("return",Object(h.a)({id:n},a?{name:"Unnamed Source"}:null));case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),doGetSourceContent:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(localStorage.getItem("sourceContent_"+t),"","invalid sourceContent",(function(e){return JSON.parse(e),e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doSetSourceSavedTagFilters:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="sourceSavedTagFilters_"+t,Object.keys(n).length>0?localStorage.setItem(a,JSON.stringify(n)):localStorage.removeItem(a),e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doGetSourceSavedTagFilters:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(localStorage.getItem("sourceSavedTagFilters_"+t),{},"invalid sourceSavedTagFilters"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),doDeleteView:function(){var e=Object(f.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("viewSpec_"+Y(t)),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doDeleteSource:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("sourceSavedTagFilters_"+t),localStorage.removeItem("sourceContent_"+t),a=Object(ot.a)(n);try{for(a.s();!(r=a.n()).done;)r.value,localStorage.removeItem("viewSpec_"+Y(t))}catch(o){a.e(o)}finally{a.f()}return localStorage.removeItem("sourceViews_"+t),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),doRenameView:function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),doRenameSource:function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},mt={type:"doc",content:[{type:"paragraph",attrs:{tags:{}}}]},ft={doGetFilesList:function(){var e=Object(f.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"documents",{headers:new Headers({"Set-Cookie":"token=".concat(t)})});case 4:if(!(n=e.sent).ok){e.next=9;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),doSaveViewSpec:function(){var e=Object(f.a)(m.a.mark((function e(t,n,a,r,o){var i,s,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=v.a.get("access_token"),e.next=3,w(y+"view?docID=".concat(n,"&viewType=").concat(r)+(o?"":"&viewID=".concat(a)),{method:"PUT",body:JSON.stringify({tags:t}),headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(i)})});case 3:if(!(s=e.sent).ok){e.next=10;break}return e.next=7,s.json();case 7:return c=e.sent,l=c.viewID,e.abrupt("return",Object(h.a)({id:l,sourceId:n},o?{name:"Untitled",type:r}:null));case 10:throw new Error("Failed to save view");case 11:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),doGetView:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,r,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"view?docID=".concat(t.sourceId,"&viewID=").concat(t.viewId),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:return a=e.sent,e.next=7,w(y+"tags?docID=".concat(t.sourceId),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 7:if(r=e.sent,a.ok&&r.ok){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,a.json();case 12:return o=e.sent,e.next=15,r.json();case 15:return i=e.sent,e.abrupt("return",{view:o,tags:i,type:t.viewType});case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0);case 22:return e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),doGetSourceTaggedBlocks:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"tags?docID=".concat(t),{method:"GET",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),doSaveSourceContent:function(){var e=Object(f.a)(m.a.mark((function e(t,n,a){var r,o,i,s,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=X(t,JSON.stringify(mt),"invalid sourceContent value",(function(e){return JSON.parse(e),e}))){e.next=3;break}return e.abrupt("return",null);case 3:return o=v.a.get("access_token"),e.prev=4,e.next=7,w(y+"document"+(a?"":"?docID=".concat(n)),{method:"PUT",body:r,headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(o)})});case 7:if(!(i=e.sent).ok){e.next=15;break}return e.next=11,i.json();case 11:return s=e.sent,c=s.id,l=s.name,e.abrupt("return",Object(h.a)({id:c},a?{name:l}:null));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.log(e.t0);case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(t,n,a){return e.apply(this,arguments)}}(),doGetSourceContent:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"document?docID=".concat(t),{headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.text();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),doSetSourceSavedTagFilters:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.a.get("access_token"),r=Object.keys(n),e.prev=2,e.next=5,w(y+"filters?docID=",{method:"POST",body:JSON.stringify({body:{docID:t,filters:r}}),headers:new Headers({"Content-Type":"application/json","Set-Cookie":"token=".concat(a)})});case 5:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",!0);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}(),doGetSourceSavedTagFilters:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"filters?docID=".concat(t),{headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),doDeleteSource:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"document?docID=".concat(t),{method:"DELETE",headers:new Headers({"Set-Cookie":"token=".concat(n)})});case 4:return a=e.sent,r=a.ok,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),doDeleteView:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"view?docID=".concat(t,"&viewID=").concat(n),{method:"DELETE",headers:new Headers({"Set-Cookie":"token=".concat(a)})});case 4:return r=e.sent,o=r.ok,e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),doRenameSource:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"document?docID=".concat(t,"&name=").concat(n),{method:"PATCH",headers:new Headers({"Set-Cookie":"token=".concat(a)})});case 4:return r=e.sent,o=r.ok,e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),doRenameView:function(){var e=Object(f.a)(m.a.mark((function e(t,n,a){var r,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=v.a.get("access_token"),e.prev=1,e.next=4,w(y+"view?docID=".concat(t,"&viewID=").concat(n,"&name=").concat(a),{method:"PATCH",headers:new Headers({"Set-Cookie":"token=".concat(r)})});case 4:return o=e.sent,i=o.ok,e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,a){return e.apply(this,arguments)}}()},gt=function(){return ye.getState().backendModeSignedInStatus===I.LOCAL_STORAGE?pt:ft},vt={doGetFilesList:function(){throw new Error("not implemented")},doSaveViewSpec:function(){throw new Error("not implemented")},doGetView:function(){throw new Error("not implemented")},doGetSourceTaggedBlocks:function(){throw new Error("not implemented")},doSaveSourceContent:function(){throw new Error("not implemented")},doGetSourceContent:function(){throw new Error("not implemented")},doSetSourceSavedTagFilters:function(){throw new Error("not implemented")},doGetSourceSavedTagFilters:function(){throw new Error("not implemented")},doDeleteView:function(){throw new Error("not implemented")},doDeleteSource:function(){throw new Error("not implemented")},doRenameView:function(){throw new Error("not implemented")},doRenameSource:function(){throw new Error("not implemented")}},ht=Object.keys(vt).reduce((function(e,t){return e[t]=Object(f.a)(m.a.mark((function e(){var n,a=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=gt()).hasOwnProperty(t)){e.next=12;break}if(ye.getState().backendModeSignedInStatus===I.USER_SIGNED_OUT){e.next=8;break}return e.next=5,n[t].apply(n,a);case 5:e.t1=e.sent,e.next=9;break;case 8:e.t1=null;case 9:e.t0=e.t1,e.next=13;break;case 12:e.t0=vt[t]();case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e)}))),e}),{}),wt={fileIdKeyStr:Y(B),fileContent:""},yt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state=wt,e.keydownHandler=function(t){(window.navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&83===t.keyCode&&(t.preventDefault(),e.props.backendModeSignedInStatus!==I.USER_SIGNED_OUT&&e.props.saveDirtyFlag&&$(e.props.currentOpenFileId)&&(ye.dispatch({type:"save_in_progress/set"}),ye.dispatch({type:"saveDirtyFlag/clear"}),ht.doSaveSourceContent(Te.editor.value(!0),e.props.currentOpenFileId.sourceId).then((function(t){ye.dispatch({type:"save_in_progress/clear"}),t?e.props.dispatchSetToastAction({message:"Saved source file",severity:ve,open:!0}):(ye.dispatch({type:"saveDirtyFlag/set"}),e.props.dispatchSetToastAction({message:"Failed to save source file",severity:ge,open:!0}))}))))},e.changeFile=Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H(e.props.currentOpenFileId)||Object(R.defer)((function(){Te.editor.focusAtStart()})),n=Y(e.props.currentOpenFileId),$(e.props.currentOpenFileId)?(e.props.dispatchSetFileLoading(),ht.doGetSourceContent(e.props.currentOpenFileId.sourceId).then((function(t){e.props.dispatchClearFileLoading(),null===t?(e.props.dispatchSetToastAction({message:"Failed to retrieve source content",severity:ge,open:!0}),Pt(B)):e.setState({fileIdKeyStr:n,fileContent:null!==t&&void 0!==t?t:""})}))):e.setState({fileIdKeyStr:n,fileContent:""});case 3:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){document.addEventListener("keydown",e.keydownHandler),e.changeFile()},e.componentWillUnmount=function(){document.removeEventListener("keydown",e.keydownHandler)},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||e.changeFile()},e.render=function(){return e.props.fileLoading?o.a.createElement(rt.a,{color:"primary",style:{position:"absolute",top:"40%",left:"45%",height:"100px",width:"100px"}}):o.a.createElement(at,{fileIdKeyStr:e.state.fileIdKeyStr,fileContent:e.state.fileContent})},e}return n}(o.a.Component),It=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,currentOpenFileName:e.currentOpenFileName,fileLoading:e.fileLoading,saveDirtyFlag:e.saveDirtyFlag}}),(function(e){return{dispatchSetToastAction:function(t){return e(fe(t))},dispatchSetFileLoading:function(){return e({type:"file_loading/set"})},dispatchClearFileLoading:function(){return e({type:"file_loading/clear"})}}}))(yt),bt=n(621),St=n(130),Et=n.n(St),Ot=n(620),kt=n(622),Ft=n(254),Tt=n.n(Ft),xt=n(255),Nt=n.n(xt),jt=n(570),Ct=n(256),_t=n.n(Ct),Dt=n(105),At=n.n(Dt),Vt=n(104),Mt=n.n(Vt),Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sourceName:"",viewName:""};if(!W(e))return!1;var n=ye.getState().currentOpenFileId;return e.sourceId===n.sourceId&&e.viewId===n.viewId||!(ye.getState().saveDirtyFlag&&!window.confirm("confirm discard unsaved changes"))&&(Object(s.b)((function(){ye.dispatch(ae(e)),ye.dispatch(re(t)),ye.dispatch({type:"saveDirtyFlag/clear"}),ye.dispatch(oe(null))})),localStorage.setItem("initialFileId",JSON.stringify(e)),localStorage.setItem("initialFileName",JSON.stringify(t)),localStorage.removeItem("initialTagFilters"),!0)},Lt=function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(L.a)(e,2);return[t[0],t[1].name]})))},Rt=function(e){return Object.entries(e).reduce((function(e,t){var n=Object(L.a)(t,2),a=(n[0],n[1].views);return e+1+Object.keys(a).length}),0)},Ut="CURRENT_SOURCE",Bt="CURRENT_VIEW",Wt="SOURCE_LIST_ITEM",Gt="VIEW_LIST_ITEM",zt=(a={},Object(P.a)(a,Ut,(function(){return"current_source_name_input"})),Object(P.a)(a,Bt,(function(){return"current_view_name_input"})),Object(P.a)(a,Wt,(function(e){return"rename_source_list_item_input_"+e.sourceId})),Object(P.a)(a,Gt,(function(e){return"rename_view_list_item_input_"+Y(e)})),a),Ht={inputType:null,fileId:B},$t={searching:"",renaming:Ht,filesList:{},nextNewFileIds:null,selectedFileId:null,selectedViewId:null,selectedFileOpen:!1,editMenuAnchorElement:null,newViewAnchorElement:null,renamePopoverElement:null},Kt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){if(0!==e.props.fileId.viewId){var t=e.props.viewType;return o.a.createElement("div",{className:"fileList-viewRoot",style:e.props.selected?{backgroundColor:"rgba(30, 61, 89, 0.3)",width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}:{width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}},o.a.createElement(_e.a,null,t===U.CARD_VIEW?o.a.createElement(Mt.a,{color:"primary"}):t===U.TEXT_VIEW?o.a.createElement(At.a,{color:"primary"}):null),o.a.createElement(jt.a,{value:e.props.fileName,className:"file_list_input",disabled:!0,style:{color:"#1E3D59"}}),o.a.createElement(Ot.a,{className:"fileList-divider",orientation:"vertical"}),o.a.createElement(_e.a,{className:"fileList-iconButton",onClick:e.props.handleEditMenuClick},o.a.createElement(Ae.a,{fontSize:"small",color:"primary"})))}return o.a.createElement("div",{className:"fileList-viewRoot",style:e.props.selected?{backgroundColor:"rgba(30, 61, 89, 0.3)",border:"solid #3f51b5 thin",width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}:{width:"100%",display:"flex",padding:"2px 4px",alignItems:"center"}},o.a.createElement(jt.a,{value:e.props.fileName,className:"file_list_input",disabled:!0,style:{color:"#1E3D59"}}),e.props.childViewsExist?e.props.open?o.a.createElement(Tt.a,null):o.a.createElement(Nt.a,null):null,o.a.createElement(Ot.a,{className:"fileList-divider",orientation:"vertical"}),o.a.createElement(_e.a,{className:"fileList-iconButton",onClick:e.props.handleEditMenuClick},o.a.createElement(Ae.a,{fontSize:"small",color:"primary"})))},e}return n}(o.a.Component),Yt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e,a;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(a=t.call.apply(t,[this].concat(i))).state=$t,a.renameField=o.a.createRef(),a.resetState=function(){a.setState($t)},a.getSourceName=function(e){return W(e)&&a.state.filesList.hasOwnProperty(e.sourceId)?a.state.filesList[e.sourceId].name:""},a.getViewName=function(e){return K(e)&&a.state.filesList.hasOwnProperty(e.sourceId)&&a.state.filesList[e.sourceId].views.hasOwnProperty(e.viewId)?a.state.filesList[e.sourceId].views[e.viewId].name:""},a.getFileName=function(e){return K(e)?a.getViewName(e):a.getSourceName(e)},a.getRenameInputValueFunctions=(e={},Object(P.a)(e,Ut,a.getSourceName),Object(P.a)(e,Bt,a.getViewName),Object(P.a)(e,Wt,a.getFileName),Object(P.a)(e,Gt,a.getFileName),e),a.handleSwitchBackendModeSignedInStatus=function(e){return e===a.props.backendModeSignedInStatus||!!Pt(B)&&(a.resetState(),a.props.dispatchSetBackendModeSignedInStatusAction(e),!0)},a.handleCancelRenaming=function(e,t){var n=document.getElementById(zt[e](t));n.value=a.getRenameInputValueFunctions[e](t),n.setSelectionRange(0,0),a.setState({renaming:Ht})},a.handleClearSearchingInput=function(){document.getElementById("search_file_names_input").value="",a.setState({searching:""})},a.handleChangeSearchingInput=function(){a.setState({searching:document.getElementById("search_file_names_input").value.trim()})},a.handleDoFileNamesSearch=function(){return Object.fromEntries(Object.entries(a.state.filesList).map((function(e){var t=Object(L.a)(e,2),n=t[0],r=t[1],o=r.name,i=r.views;return[n,{name:o,views:a.state.searching?Object.fromEntries(Object.entries(i).filter((function(e){var t=Object(L.a)(e,2);t[0];return t[1].name.includes(a.state.searching)}))):i}]})).filter((function(e){var t=Object(L.a)(e,2),n=(t[0],t[1]),r=n.name,o=n.views;return!a.state.searching||Object.keys(o).length>0||r.includes(a.state.searching)})))},a.handleCreateNewFile=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,o,i,s,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U.hasOwnProperty(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=t===U.SOURCE,(!(r=H(a.props.currentOpenFileId))||n)&&(r||Pt(B))){e.next=6;break}return e.abrupt("return");case 6:return o=a.props.backendModeSignedInStatus===I.LOCAL_STORAGE?n?a.state.nextNewFileIds.source:a.state.nextNewFileIds.nextNewViewIdsForSourceIds[a.props.currentOpenFileId.sourceId]:null,i=n?ht.doSaveSourceContent(null,o,!0):ht.doSaveViewSpec([],a.props.currentOpenFileId.sourceId,o,t,!0),e.prev=8,e.next=11,i;case 11:s=e.sent,c=n?s.id:a.state.selectedFileId,l=Object(h.a)(Object(h.a)({},a.state.filesList),{},Object(P.a)({},c,{name:n?s.name:a.state.filesList[c].name,views:Object(h.a)({},n?null:Object(h.a)(Object(h.a)({},a.state.filesList[c].views),{},Object(P.a)({},s.id,{name:s.name,type:s.type})))})),a.setState({filesList:l,selectedFileId:c,selectedFileOpen:!n,selectedViewId:n?0:s.id}),Object(R.defer)((function(){var e={sourceId:c,viewId:n?0:s.id,viewType:n?U.EMPTY:s.type},t={sourceName:a.getSourceName(e),viewName:a.getViewName(e)};Pt(e,t)})),a.setState({renamePopoverElement:document.getElementById(Y({sourceId:c,viewId:n?0:s.id,viewType:n?U.EMPTY:s.type}))}),a.props.backendModeSignedInStatus===I.LOCAL_STORAGE&&(n?lt(Lt(l)):st(c,l[c].views),a.setState({nextNewFileIds:{source:n?ut(l,parseInt(c)):a.state.nextNewFileIds.source,nextNewViewIdsForSourceIds:Object(h.a)(Object(h.a)({},a.state.nextNewFileIds.nextNewViewIdsForSourceIds),n?null:Object(P.a)({},c,ut(l[c].views,parseInt(s.id))))}})),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),a.props.dispatchSetToastAction({message:"Failed to create new file",severity:ge,open:!0});case 23:case"end":return e.stop()}}),e,null,[[8,20]])})));return function(t){return e.apply(this,arguments)}}(),a.handleDeleteFile=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,o,i,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H(t)){e.next=2;break}return e.abrupt("return");case 2:if(t.sourceId!==a.props.currentOpenFileId.sourceId||t.viewId!==a.props.currentOpenFileId.viewId||Pt(B)){e.next=4;break}return e.abrupt("return");case 4:return n=$(t),r=n?ht.doDeleteSource(t.sourceId,Object.keys(a.state.filesList[t.sourceId].views)):ht.doDeleteView(t.sourceId,t.viewId),e.next=8,r;case 8:if(e.sent){e.next=12;break}return a.props.dispatchSetToastAction({message:"Failed to delete file",severity:ge,open:!0}),e.abrupt("return");case 12:o=Object(h.a)({},a.state.filesList),n?delete o[t.sourceId]:(delete(i=Object(h.a)({},o[t.sourceId].views))[t.viewId],o[t.sourceId]={name:o[t.sourceId].name,views:i}),a.setState({filesList:o}),a.props.backendModeSignedInStatus===I.LOCAL_STORAGE&&(n?(lt(Lt(o)),delete(s=Object(h.a)({},a.state.nextNewFileIds.nextNewViewIdsForSourceIds))[t.sourceId],a.setState({nextNewFileIds:{source:a.state.nextNewFileIds.source,nextNewViewIdsForSourceIds:s}})):st(t.sourceId,o[t.sourceId].views));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleRenameFile=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,o,i,s,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=document.getElementById("rename_field")){e.next=5;break}return e.abrupt("return");case 5:if((r=n.value.trim())&&r!==a.getFileName(t)){e.next=8;break}return e.abrupt("return");case 8:return o=$(t),i=o?ht.doRenameSource(t.sourceId,r):ht.doRenameView(t.sourceId,t.viewId,r),e.next=12,i;case 12:if(e.sent){e.next=16;break}return a.props.dispatchSetToastAction({message:"Failed to rename file",severity:ge,open:!0}),e.abrupt("return");case 16:ye.dispatch(re({sourceName:o?r:a.getSourceName(t),viewName:o?"":r})),s=Object(h.a)({},a.state.filesList),o?s[t.sourceId]={name:r,views:s[t.sourceId].views}:(c=Object(h.a)(Object(h.a)({},s[t.sourceId].views),{},Object(P.a)({},t.viewId,Object(h.a)(Object(h.a)({},s[t.sourceId].views[t.viewId]),{},{name:r}))),s[t.sourceId]={name:s[t.sourceId].name,views:c}),a.setState({filesList:s}),a.props.backendModeSignedInStatus===I.LOCAL_STORAGE&&(o?lt(Lt(s)):st(t.sourceId,s[t.sourceId].views));case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.componentDidMount=function(){a.setState({selectedFileId:a.props.currentOpenFileId.sourceId,selectedViewId:a.props.currentOpenFileId.viewId,selectedFileOpen:0!==a.props.currentOpenFileId.viewId}),ht.doGetFilesList().then((function(e){e?a.setState({filesList:e}):a.props.dispatchSetToastAction({message:"Failed to retrieve file list",severity:ge,open:!0}),a.props.backendModeSignedInStatus===I.LOCAL_STORAGE&&a.setState({nextNewFileIds:dt(a.state.filesList)})}))},a.componentDidUpdate=function(e,t){e.backendModeSignedInStatus!==a.props.backendModeSignedInStatus&&ht.doGetFilesList().then((function(e){return null!==e&&void 0!==e?e:{}})).then((function(e){a.setState(Object(h.a)(Object(h.a)({},$t),{},{filesList:e,nextNewFileIds:a.props.backendModeSignedInStatus===I.LOCAL_STORAGE?dt(e):null}))})),null!=document.getElementById("rename_field")&&null!=a.state.renamePopoverElement&&(console.log("Setting focus field"),document.getElementById("rename_field").focus())},a.handleFileListClick=function(e){e===a.state.selectedFileId?(Pt({sourceId:e,viewId:0,viewType:U.EMPTY},{sourceName:a.state.filesList[e].name,viewName:""}),a.setState({selectedViewId:null,selectedFileOpen:!a.state.selectedFileOpen})):Pt({sourceId:e,viewId:0,viewType:U.EMPTY},{sourceName:a.state.filesList[e].name,viewName:""})&&a.setState({selectedFileId:e,selectedViewId:null,selectedFileOpen:!0})},a.handleViewListClick=function(e){var t={sourceName:a.getSourceName(e),viewName:a.getViewName(e)};Pt(e,t)&&a.setState({selectedViewId:e.viewId})},a.handleEditMenuClick=function(e){a.setState({editMenuAnchorElement:e.currentTarget})},a.handleEditMenuClose=function(){a.setState({editMenuAnchorElement:null})},a.handleDeleteMenuClick=function(){a.handleEditMenuClose();var e={sourceId:a.state.selectedFileId,viewId:null===a.state.selectedViewId?0:a.state.selectedViewId};a.handleDeleteFile(e).then((function(t){0!==e.viewId?a.setState({selectedViewId:null}):a.setState({selectedFileId:null,selectedViewId:null,selectedFileOpen:!1})}))},a.handleRenameMenuClick=function(e){a.setState({renamePopoverElement:a.state.editMenuAnchorElement,editMenuAnchorElement:null})},a.handleRenamePopoverClose=function(){a.setState({renamePopoverElement:null})},a.handleViewMenuOpen=function(e){a.setState({newViewAnchorElement:a.state.editMenuAnchorElement})},a.handleViewMenuClose=function(){a.setState({newViewAnchorElement:null,editMenuAnchorElement:null})},a.render=function(){var e=Rt(a.state.filesList),t=a.state.searching?a.handleDoFileNamesSearch():a.state.filesList,n=Rt(t);return o.a.createElement("div",{className:"SidePane"},o.a.createElement("div",{id:"file_list_container"},o.a.createElement(bt.a,{variant:"outlined",color:"primary",endIcon:o.a.createElement(je.a,null),disableElevation:!0,id:"new_document_button",onClick:function(){a.handleCreateNewFile(U.SOURCE)}},"New Document"),o.a.createElement("div",{className:"InputRow",id:"search_file_names_input_row"},o.a.createElement(Je.a,{variant:"outlined",id:"search_file_names_input",startAdornment:o.a.createElement(Ce.a,{position:"start"},o.a.createElement(Et.a,null)),style:{width:"100%"},title:"Search File Names",placeholder:"Search File Names",onChange:Object(R.debounce)(a.handleChangeSearchingInput,150),onKeyPress:function(e){"Enter"===e.key&&e.target.blur()},onKeyDown:function(e){"Escape"===e.key&&e.target.blur()}})),Object.keys(t).length>0?o.a.createElement(Me.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:o.a.createElement(Ve.a,{component:"div",id:"nested-list-subheader",style:{backgroundColor:"#F5F0E1"}},"Source Files"),id:"file_list",style:{maxWidth:360,width:"100%"}},Object.entries(t).map((function(e){var t=Object(L.a)(e,2),n=t[0],r=t[1].views;return o.a.createElement("div",null,o.a.createElement(Pe.a,{button:!0,key:n,id:Y({sourceId:n,viewId:0}),disableGutters:!0,divider:!0,style:{padding:"0px"},onClick:function(){a.handleFileListClick(n)}},o.a.createElement(Kt,{fileId:{sourceId:n,viewId:0},selected:n===a.state.selectedFileId,open:n===a.state.selectedFileId&&a.state.selectedFileOpen,handleEditMenuClick:a.handleEditMenuClick,childViewsExist:Object.keys(r).length>0,fileName:a.getFileName({sourceId:n,viewId:0})})),Object.keys(r).length>0?o.a.createElement(kt.a,{in:n===a.state.selectedFileId&&a.state.selectedFileOpen,timeout:"auto",unmountOnExit:!0},o.a.createElement(Me.a,{component:"div",disablePadding:!0,style:{borderStyle:"none solid solid solid",borderColor:"#3f51b5",borderWidth:"thin",borderRadius:"4px"}},Object.keys(r).map((function(e){var t={sourceId:n,viewId:e,viewType:r[e].type};return o.a.createElement(Pe.a,{button:!0,key:Y(t),id:Y(t),disableGutters:!0,divider:!0,style:{paddingTop:"0px",paddingBottom:"0px",backgroundColor:"transparent"},onClick:function(){a.handleViewListClick(t)}},o.a.createElement(Kt,{fileId:t,open:e===a.state.selectedViewId,handleEditMenuClick:a.handleEditMenuClick,fileName:a.getFileName(t),viewType:r[e].type,selected:e===a.state.selectedViewId}))})))):null)}))):o.a.createElement("div",{className:"PlaceholderDivWithText",id:"no_files_placeholder"},"No Files"),o.a.createElement(Ge.a,{id:"edit_menu",anchorEl:a.state.editMenuAnchorElement,keepMounted:!0,open:Boolean(a.state.editMenuAnchorElement),onClose:function(){return a.handleEditMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"}},null===a.state.selectedViewId?o.a.createElement(ze.a,{onClick:function(){return a.handleViewMenuOpen()}},o.a.createElement(He.a,null,o.a.createElement(_t.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"New View",color:"primary"})):null,o.a.createElement(ze.a,{onClick:function(){return a.handleRenameMenuClick()}},o.a.createElement(He.a,null,o.a.createElement(We.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"Rename",color:"primary"})),o.a.createElement(ze.a,{onClick:function(){return a.handleDeleteMenuClick()}},o.a.createElement(He.a,null,o.a.createElement(Ue.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"Delete",color:"primary"}))),o.a.createElement(Ge.a,{id:"viewMenu",anchorEl:a.state.newViewAnchorElement,keepMounted:!0,open:Boolean(a.state.newViewAnchorElement),onClose:function(){return a.handleViewMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"left"}},o.a.createElement(ze.a,{onClick:function(){a.handleViewMenuClose(),a.handleCreateNewFile(U.TEXT_VIEW)}},o.a.createElement(He.a,null,o.a.createElement(At.a,{fontSize:"small"})),o.a.createElement(Le.a,{primary:"Text View"})),o.a.createElement(ze.a,{onClick:function(){a.handleViewMenuClose(),a.handleCreateNewFile(U.CARD_VIEW)}},o.a.createElement(He.a,null,o.a.createElement(Mt.a,{fontSize:"small"})),o.a.createElement(Le.a,{primary:"Card View"}))),o.a.createElement($e.a,{open:Boolean(a.state.renamePopoverElement),onClose:a.handleRenamePopoverClose,anchorEl:a.state.renamePopoverElement,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},id:"rename_popover"},o.a.createElement(Je.a,{ref:a.renameField,id:"rename_field",autoFocus:!0,defaultValue:a.getFileName({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),onKeyPress:function(e){"Enter"===e.key&&(a.handleRenameFile({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),a.handleRenamePopoverClose())},onKeyDown:function(e){"Escape"===e.key&&a.handleRenamePopoverClose()},endAdornment:o.a.createElement(Ce.a,{position:"end"},o.a.createElement(_e.a,{onClick:function(){a.handleRenameFile({sourceId:a.state.selectedFileId,viewId:null==a.state.selectedViewId?0:a.state.selectedViewId}),a.handleRenamePopoverClose()}},o.a.createElement(Ye.a,null))),disableUnderline:!0,fullWidth:!0,style:{height:"50px",paddingLeft:"10px"}})),o.a.createElement("div",{className:"PlaceholderDivWithText",id:"filtered_files_placeholder",hidden:!a.state.searching},e-n+" of "+e+" files hidden by search")))},a}return n}(o.a.Component),Jt=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,backendModeSignedInStatus:e.backendModeSignedInStatus}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(S(t))},dispatchSetToastAction:function(t){return e(fe(t))}}}))(Yt),Xt=n(634),qt=n(257),Qt=n.n(qt),Zt=n(623),en=n(155),tn=n.n(en),nn=n(261),an=n.n(nn),rn=n(260),on=n.n(rn),sn=n(154),cn=n.n(sn);function ln(e){return e[0]}var un={Lexer:void 0,ParserRules:[{name:"Main",symbols:["Expression"],postprocess:ln},{name:"Expression",symbols:["Expression_"],postprocess:ln},{name:"Expression",symbols:["Factor"],postprocess:ln},{name:"Expression_",symbols:["Factor","_",{literal:"|",pos:30},"_","Expression"],postprocess:function(e){return[e[0],e[2],e[4]]}},{name:"Factor",symbols:["Factor_"],postprocess:ln},{name:"Factor",symbols:["Term"],postprocess:ln},{name:"Factor_",symbols:["Term","_",{literal:"&",pos:60},"_","Factor"],postprocess:function(e){return[e[0],e[2],e[4]]}},{name:"Term",symbols:["Not"],postprocess:ln},{name:"Term",symbols:["Nested"],postprocess:ln},{name:"Term",symbols:["Tag"],postprocess:ln},{name:"Not$subexpression$1",symbols:["Nested"],postprocess:ln},{name:"Not$subexpression$1",symbols:["Tag"],postprocess:ln},{name:"Not",symbols:[{literal:"!",pos:92},"Not$subexpression$1"]},{name:"Nested",symbols:[{literal:"(",pos:110},"_","Expression","_",{literal:")",pos:118}],postprocess:function(e){return e[2]}},{name:"Tag$string$1",symbols:[{literal:"#"},{literal:"{"}],postprocess:function(e){return e.join("")}},{name:"Tag$ebnf$1",symbols:[/[^{}]/]},{name:"Tag$ebnf$1",symbols:[/[^{}]/,"Tag$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"Tag",symbols:["Tag$string$1","Tag$ebnf$1",{literal:"}",pos:131}],postprocess:function(e){return e[1].join("").trim()}},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:[{literal:" ",pos:139},"_$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(e){return null}}],ParserStart:"Main"},dn=n(259),pn=n.n(dn),mn=n(632),fn=n(626),gn=(n(547),n(262)),vn=n.n(gn),hn=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).handleResize=function(e){console.log(window.innerWidth),r.setState({windowWidth:window.innerWidth})},r.handleBugReport=function(e){var t="%0D%0A",n="Enter information about your bug report here."+(t+t+"Device Info:"+t+[window.navigator.userAgent,window.navigator.platform].join(t));window.open("mailto:yada.bugs@gmail.com?subject=[BUG]%20User%20Report&body="+n,"_blank")},r.handleSave=function(){ye.dispatch({type:"save_in_progress/set"}),ye.dispatch({type:"saveDirtyFlag/clear"}),$(r.props.currentOpenFileId)?ht.doSaveSourceContent(Te.editor.value(!0),r.props.currentOpenFileId.sourceId).then((function(e){ye.dispatch({type:"save_in_progress/clear"}),e?r.props.dispatchSetToastAction({message:"Saved source file",severity:ve,open:!0}):(r.props.dispatchSetToastAction({message:"Failed to save source file",severity:ge,open:!0}),ye.dispatch({type:"saveDirtyFlag/set"}))})):K(r.props.currentOpenFileId)&&r.props.currentOpenFileId.viewType!==B.viewType&&ht.doSaveViewSpec(r.props.tagsInView,r.props.currentOpenFileId.sourceId,r.props.currentOpenFileId.viewId,r.props.currentOpenFileId.viewType,!1).then((function(){r.props.dispatchSetToastAction({message:"View saved",severity:ve,open:!0}),ye.dispatch({type:"save_in_progress/clear"}),ye.dispatch({type:"saveDirtyFlag/clear"})})).catch((function(){r.props.dispatchSetToastAction({message:"Failed to save view",severity:ge,open:!0}),ye.dispatch({type:"save_in_progress/clear"}),ye.dispatch({type:"saveDirtyFlag/set"})}))},r.handleCancelModifyingTagFilters=function(){document.getElementById("tag_filters_input").value=r.state.currentTagFiltersStr,r.setState({modifyingTagFilters:!1})},r.handleStartModifyingTagFilters=function(){r.setState({modifyingTagFilters:!0}),Object(R.defer)((function(){var e=document.getElementById("tag_filters_input");e.focus(),e.setSelectionRange(e.value.length,e.value.length)}))},r.handleUnpersistCurrentTagFilters=function(){if(!r.state.currentTagFiltersStr||!r.state.sourceSavedTagFilters.hasOwnProperty(r.state.currentTagFiltersStr))return!1;var e=Object(h.a)({},r.state.sourceSavedTagFilters);delete e[r.state.currentTagFiltersStr],ht.doSetSourceSavedTagFilters(r.props.currentOpenFileId.sourceId,e).then((function(t){t?r.setState({sourceSavedTagFilters:e}):r.props.dispatchSetToastAction({message:"Failed to set source saved tag filters",severity:ge,open:!0})}))},r.handlePersistNewSavedTagFilters=function(){if(!r.state.currentTagFiltersStr||r.state.sourceSavedTagFilters.hasOwnProperty(r.state.currentTagFiltersStr))return!1;var e=Object(h.a)({},r.state.sourceSavedTagFilters);e[r.state.currentTagFiltersStr]=r.state.currentParsedTagFiltersStr,ht.doSetSourceSavedTagFilters(r.props.currentOpenFileId.sourceId,e).then((function(t){t?r.setState({sourceSavedTagFilters:e}):r.props.dispatchSetToastAction({message:"Failed to set source saved tag filters",severity:ge,open:!0})}))},r.handleApplyTagFilters=function(){var e=null,t=document.getElementById("tag_filters_input").value.trim();if(t&&!(e=function(e){var t=null;if(e){var n=new cn.a.Parser(cn.a.Grammar.fromCompiled(un));try{n.feed(e.trim()),n.results.length>0&&(t=n.results)}catch(a){}}return t}(t)))return r.props.dispatchSetToastAction({message:"Invalid tag filters",severity:ge,open:!0}),!1;document.getElementById("tag_filters_input").value=t;var n=JSON.stringify(e),a=r.state.currentParsedTagFiltersStr;return r.setState({currentTagFiltersStr:t,currentParsedTagFiltersStr:n}),n===a||void 0!==Te.editor&&(Te.editor.view.dispatch(Te.editor.view.state.tr.setMeta(Se,e).setSelection(e?ie.TextSelection.create(Te.editor.view.state.doc,0,0):ie.Selection.atStart(Te.editor.view.state.doc)).scrollIntoView()),Object(R.defer)((function(){e?Te.editor.view.dom.blur():Te.editor.view.focus()}))),!0},r.changeFile=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$(r.props.currentOpenFileId)&&ht.doGetSourceSavedTagFilters(r.props.currentOpenFileId.sourceId).then((function(e){if(e){var t={};e.forEach((function(e){t[e]=e})),r.setState({sourceSavedTagFilters:t})}else r.props.dispatchSetToastAction({message:"Failed to retrieve source saved tag filters",severity:ge,open:!0})}));case 1:case"end":return e.stop()}}),e)}))),r.componentDidMount=function(){r.changeFile(),window.addEventListener("resize",r.handleResize)},r.componentDidUpdate=function(e){""===r.props.currentOpenFileName.viewName&&e.currentOpenFileId.sourceId!==r.props.currentOpenFileId.sourceId&&(document.getElementById("tag_filters_input").value="",r.handleApplyTagFilters(),r.setState({sourceSavedTagFilters:{}}),r.changeFile())},r.handleUserMenuOpen=function(e){r.setState({userIconElement:e.currentTarget})},r.handleUserMenuClose=function(){r.setState({userIconElement:null})},r.render=function(){var e=H(r.props.currentOpenFileId),t=r.state.sourceSavedTagFilters.hasOwnProperty(r.state.currentTagFiltersStr);return o.a.createElement("div",{className:"sticky-navbar scrolled"},o.a.createElement(F.a,{class:"custom-navbar"},o.a.createElement(T.a,{style:{justifyContent:"space-between"}},o.a.createElement("div",{style:{width:"275px"}},o.a.createElement(N.a,{container:!0},o.a.createElement(N.a,{item:!0,xs:2},o.a.createElement("img",{className:"menuButton",src:n(180),style:{width:"40px",marginRight:"10px"},alt:"MENU"})),o.a.createElement(N.a,{item:!0,xs:10},o.a.createElement(x.a,{variant:"h5",style:{fontFamily:"Bungee",color:"#F5F0E1",marginTop:"5px"}},"YADA")))),o.a.createElement(N.a,{container:!0,style:{width:"80vw"}},o.a.createElement(N.a,{item:!0,xs:""===r.props.currentOpenFileName.viewName?3:5},o.a.createElement(N.a,{container:!0,spacing:0},o.a.createElement(N.a,{item:!0,xs:6,s:6,xl:4},""===r.props.currentOpenFileName.sourceName?null:o.a.createElement(Xt.a,{"aria-label":"breadcrumb",color:"secondary",style:{marginRight:"10px",border:"1px solid #F5F0E1",borderRadius:"10px",padding:"8px"}},o.a.createElement(Zt.a,{underline:"none",color:"inherit",style:{color:"#F5F0E1",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block",maxWidth:"100%"}},o.a.createElement(Qt.a,{color:"secondary"}),r.state.windowWidth<1e3?"":r.props.currentOpenFileName.sourceName),""===r.props.currentOpenFileName.viewName?null:o.a.createElement(Zt.a,{underline:"none",color:"inherit",style:{color:"#F5F0E1",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block",maxWidth:"100%"}},r.props.currentOpenFileId.viewType===U.CARD_VIEW?o.a.createElement(Mt.a,{color:"secondary"}):r.props.currentOpenFileId.viewType===U.TEXT_VIEW?o.a.createElement(At.a,{color:"secondary"}):null,r.state.windowWidth<1e3?"":r.props.currentOpenFileName.viewName))),o.a.createElement(N.a,{item:!0,xs:5},o.a.createElement(bt.a,{variant:"outlined",color:"secondary",title:"save",disabled:e||!r.props.saveDirtyFlag,onClick:r.handleSave,startIcon:o.a.createElement(tn.a,null),style:{borderRadius:"10px",paddingTop:"8px",paddingBottom:"8px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"inline-block",maxWidth:"45px",minWidth:"45px",zIndex:0}},o.a.createElement(rt.a,{hidden:!r.props.saveInProgress,color:"secondary",style:{position:"absolute",top:"0%",left:"0%",height:"40px",width:"40px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"4px",paddingRight:"4px",zIndex:1}}))))),o.a.createElement(N.a,{item:!0,xs:""===r.props.currentOpenFileName.viewName?6:1},""===r.props.currentOpenFileName.viewName?o.a.createElement("div",{id:"searchBar",style:{backgroundColor:"rgba(245, 240, 225, 0.8)",width:"100%",borderRadius:"10px",padding:"5px",justifyContent:"spaceBetween",display:"flex"}},o.a.createElement("div",{style:{marginTop:"3px",width:"20px",marginRight:"5px"}},o.a.createElement(Et.a,{color:"primary"})),o.a.createElement(mn.a,{value:r.state.currentTagFiltersStr,id:"tag_filters_input",freeSolo:!0,options:Object.entries(r.state.sourceSavedTagFilters).map((function(e){var t=Object(L.a)(e,2),n=t[0];t[1];return n})),renderInput:function(e){return o.a.createElement(fn.a,Object.assign({},e,{placeholder:"Search with Tags: ( #{tag1} | !( #{tag2} ) ) & #{tag3}",style:{margin:"0%"},margin:"normal",variant:"standard"}))},style:{width:"90%"},onChange:function(e,t,n){r.setState({currentTagFiltersStr:t}),r.handleStartModifyingTagFilters(),"clear"===n&&(document.getElementById("tag_filters_input").value="",r.handleApplyTagFilters())},onBlur:function(e){if(r.handleApplyTagFilters())r.setState({modifyingTagFilters:!1});else{var t=e.target;Object(R.defer)((function(){t.focus()}))}},onKeyDown:function(e){"Escape"===e.key&&r.handleCancelModifyingTagFilters()},onKeyPress:function(e){"Enter"===e.key&&e.target.blur()}}),o.a.createElement("div",{style:{float:"right"}},r.state.modifyingTagFilters||""===r.state.currentTagFiltersStr?null:t?o.a.createElement(_e.a,{title:"Unpersist Filter",style:{padding:"0px",paddingRight:"10px",paddingTop:"5px"}},o.a.createElement(pn.a,{color:"primary",onClick:function(){document.getElementById("tag_filters_input").value="",r.handleUnpersistCurrentTagFilters(),r.handleApplyTagFilters()}})):o.a.createElement(_e.a,{title:"Persist Filter",style:{padding:"0px",paddingRight:"10px",paddingTop:"5px"}},o.a.createElement(tn.a,{color:"primary",onClick:function(){r.handlePersistNewSavedTagFilters()}})))):null)),o.a.createElement(_e.a,{title:"Report a Bug",edge:"end","aria-label":"bug report","aria-haspopup":"true",color:"inherit",style:{float:"right"},onClick:r.handleBugReport},o.a.createElement(on.a,{color:"secondary"})),o.a.createElement(_e.a,{edge:"end","aria-label":"account of current user","aria-haspopup":"true",color:"inherit",style:{float:"right"},onClick:r.handleUserMenuOpen},o.a.createElement(an.a,{color:"secondary"})),r.props.backendModeSignedInStatus===I.USER_SIGNED_IN?o.a.createElement(Ge.a,{id:"userMenu",anchorEl:r.state.userIconElement,keepMounted:!0,open:Boolean(r.state.userIconElement),onClose:function(){return r.handleUserMenuClose()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},o.a.createElement(ze.a,{onClick:function(){r.props.dispatchSetBackendModeSignedInStatusAction(I.USER_SIGNED_OUT)&&(v.a.remove("access_token"),r.props.dispatchNewUserAction(!1),localStorage.clear(),r.props.dispatchSignOutAction())}},o.a.createElement(He.a,null,o.a.createElement(vn.a,{fontSize:"small",color:"primary"})),o.a.createElement(Le.a,{primary:"Sign Out",color:"primary"}))):null)))},r.state={modifyingTagFilters:!1,currentTagFiltersStr:"",currentParsedTagFiltersStr:"",sourceSavedTagFilters:{},windowWidth:window.innerWidth,userIconElement:null},r}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){window.addEventListener("resize",this.handleResize)}}]),a}(o.a.Component),wn=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,currentOpenFileName:e.currentOpenFileName,backendModeSignedInStatus:e.backendModeSignedInStatus,tagsInView:e.tagsInView,saveDirtyFlag:e.saveDirtyFlag,saveInProgress:e.saveInProgress}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(S(t))},dispatchSetToastAction:function(t){return e(fe(t))},dispatchNewUserAction:function(t){return e(D(t))},dispatchSignOutAction:function(){return e({type:"signout"})}}}))(hn),yn=(n(548),n(240),n(549),n(76)),In=n(132),bn=n(106),Sn=n(100),En=n(266),On=n(263),kn=n.n(On),Fn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).render=function(){var e=a.props.content;if(void 0!==e){var t=e.index,n=e.front,r=e.back;return o.a.createElement(kn.a,{isFlipped:a.state.isFlipped,flipDirection:"vertical"},a.createBootstrapCard(t,n),a.createBootstrapCard(t,r))}return null},a.state={isFlipped:!1,key:a.props.content.index,front:a.props.content.front,back:a.props.content.back},a.handleClick=a.handleClick.bind(Object(Sn.a)(a)),a.createBootstrapCard=a.createBootstrapCard.bind(Object(Sn.a)(a)),a}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.setState((function(e){return{isFlipped:!e.isFlipped}}))}},{key:"createBootstrapCard",value:function(e,t){return o.a.createElement(En.a,{key:e,text:"black",className:"BootstrapCard",onClick:this.handleClick},t&&o.a.createElement(le.a,{className:"Card",readOnly:!0,key:"card".concat(e),defaultValue:JSON.stringify(t),jsonStrValue:!0}))}}]),n}(o.a.Component),Tn=n(264),xn=n.n(Tn),Nn=n(265),jn=n.n(Nn),Cn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={currentNumber:0,startIndex:0,cards:e.props.cards},e.shuffleCards=function(){for(var t=e.state.cards,n=t.length-1;n>0;){var a=Math.floor(Math.random()*n),r=t[n];t[n]=t[a],t[a]=r,n--}e.setState({cards:t,startIndex:3})},e.render=function(){return o.a.createElement("div",null,o.a.createElement(xn.a,{navButtonsAlwaysVisible:!0,indicators:!1,animation:"slide",autoPlay:!1,interval:1e4,index:e.state.startIndex,next:function(){e.setState({currentNumber:(e.state.currentNumber+1)%e.state.cards.length})},prev:function(){e.setState({currentNumber:(e.state.currentNumber-1)%e.state.cards.length})}},e.state.cards.map((function(e,t){return o.a.createElement("div",null,e)}))),o.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}},o.a.createElement("div",null),o.a.createElement(x.a,{variant:"h6",style:{color:"#1E3D59"}},e.state.currentNumber+1,"/",e.state.cards.length),o.a.createElement(Xe.a,{label:"Shuffle",clickable:!0,color:"primary",onDelete:e.shuffleCards,onClick:e.shuffleCards,deleteIcon:o.a.createElement(jn.a,null),variant:"outlined"})))},e}return n}(o.a.Component),_n=n(77),Dn=n(29),An=n(108);function Vn(){var e=Object(_n.a)(["\n      overflow-x: hidden;\n      overflow-y: auto;\n      height: 200px;\n      padding-bottom: 30px;\n    "]);return Vn=function(){return e},e}function Mn(){var e=Object(_n.a)(["\n      padding: 8px;\n    "]);return Mn=function(){return e},e}function Pn(){var e=Object(_n.a)(["\n      padding: 8px;\n    "]);return Pn=function(){return e},e}function Ln(){var e=Object(_n.a)(["\n      border: 1px solid lightgrey;\n      border-radius: 10px;\n      padding: 8px;\n      margin-top: 10px;\n      margin-bottom: 10px;\n      transition: background-color 0.2s ease;\n      background-color: ",";\n    "]);return Ln=function(){return e},e}function Rn(){var e=Object(_n.a)([""]);return Rn=function(){return e},e}function Un(){var e=Object(_n.a)([""]);return Un=function(){return e},e}function Bn(){var e=Object(_n.a)(["\n      border: 1px solid lightgrey;\n      border-radius: 10px;\n      padding: 8px;\n      margin-bottom: 8px;\n      background-color: ",";\n    "]);return Bn=function(){return e},e}var Wn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){var t=Dn.default.div(Bn(),(function(e){return e.isDragging?pa.palette.secondary.dark:pa.palette.secondary.light})),n=Dn.default.h5(Un()),a=Dn.default.div(Rn());return o.a.createElement(An.b,{draggableId:e.props.tagId,index:e.props.index},(function(r,i){return o.a.createElement(t,Object.assign({ref:r.innerRef},r.draggableProps,r.dragHandleProps,{isDragging:i.isDragging}),o.a.createElement(n,null,e.props.tagInfo.tag_name),o.a.createElement(a,null,e.props.tagInfo.preview))}))},e}return n}(o.a.Component),Gn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e,t,n){return e.tagData!==this.props.tagData}},{key:"render",value:function(){console.log(this.props);for(var e=[],t=Object.keys(this.props.tagData),n=0;n<t.length;++n){var a=t[n];e.push(o.a.createElement(Wn,{key:a,tagId:a,index:n,tagInfo:this.props.tagData[a]})),this.props.viewType===U.CARD_VIEW&&this.props.columnId===Hn.IN_VIEW&&n%2===1&&n!==t.length-1&&e.push(o.a.createElement("hr",{style:{color:pa.palette.primary.main,backgroundColor:pa.palette.primary.main,height:1}}))}return e}}]),n}(o.a.Component),zn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).render=function(){var e=Dn.default.div(Ln(),(function(e){return e.isDraggingOver?pa.palette.grey[300]:pa.palette.grey[100]})),t=Dn.default.h3(Pn()),n=Dn.default.div(Mn()),r=Dn.default.div(Vn());return o.a.createElement(An.c,{droppableId:a.props.column.id},(function(i,s){return o.a.createElement(e,{isDraggingOver:s.isDraggingOver},o.a.createElement(t,null,a.props.column.title),o.a.createElement(n,Object.assign({ref:i.innerRef},i.droppableProps),o.a.createElement(r,{ref:a.tagListRef},o.a.createElement(Gn,{viewType:a.props.viewType,columnId:a.props.column.id,tagData:a.props.tagData}),i.placeholder)))}))},a.tagListRef=o.a.createRef(),a}return Object(l.a)(n,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var n=this.tagListRef.current;return n.scrollHeight-n.scrollTop}},{key:"componentDidUpdate",value:function(e,t,n){if(null!==n){var a=this.tagListRef.current;a.scrollTop=a.scrollHeight-n}}}]),n}(o.a.Component),Hn={AVAILABLE:"tags_available",IN_VIEW:"tags_in_view"},$n=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).onDragEnd=function(e){var t=e.destination,n=e.source,r=e.draggableId;if(t&&(t.droppableId!==n.droppableId||t.index!==n.index)){var o={};if(t.droppableId===n.droppableId){var i=a.state.columns[n.droppableId],s=Array.from(i.tagIds);s.splice(n.index,1),s.splice(t.index,0,r);var c=Object(h.a)(Object(h.a)({},i),{},{tagIds:s});o=Object(h.a)(Object(h.a)({},a.state),{},{columns:Object(h.a)(Object(h.a)({},a.state.columns),{},Object(P.a)({},c.id,c))})}else{var l,u=a.state.columns[n.droppableId],d=a.state.columns[t.droppableId],p=Array.from(u.tagIds);p.splice(n.index,1);var m=Object(h.a)(Object(h.a)({},u),{},{tagIds:p}),f=Array.from(d.tagIds);f.splice(t.index,0,r);var g=Object(h.a)(Object(h.a)({},d),{},{tagIds:f});o=Object(h.a)(Object(h.a)({},a.state),{},{columns:Object(h.a)(Object(h.a)({},a.state.columns),{},(l={},Object(P.a)(l,m.id,m),Object(P.a)(l,g.id,g),l))})}a.props.setTagsInView(o.columns.tags_in_view.tagIds),a.setState(o)}},a.render=function(){return o.a.createElement(An.a,{onDragEnd:a.onDragEnd},o.a.createElement(yn.a,null,o.a.createElement(In.a,{className:"justify-content-md-center dragDrop"},a.state.columnOrder.map((function(e){var t,n=a.state.columns[e],r={},i=Object(ot.a)(n.tagIds);try{for(i.s();!(t=i.n()).done;){var s=t.value;r[s]=a.state.tagData[s]}}catch(c){i.e(c)}finally{i.f()}return o.a.createElement(bn.a,{key:n.id,md:"12",lg:"6"},o.a.createElement(zn,{viewType:a.props.viewType,key:n.id,column:n,tagData:r}))})))))};var r=new Set(a.props.tagsInView),i=Object.keys(a.props.allTagsData).filter((function(e){return!r.has(e)}));var s=a.props.allTagsData;return Object.keys(s).forEach((function(e){var t=function e(t){for(var n=0;n<t.content.length;++n){var a=t.content[n];if("text"===a.type)return a.text;if(a){var r=e(a);if(""!==r)return r}}return""}(s[e].content);s[e].preview=t.substring(0,50),t.length>50&&(s[e].preview+=" . . .")})),a.state={tagData:s,columns:{tags_in_view:{id:Hn.IN_VIEW,title:"Tags in View",tagIds:a.props.tagsInView},tags_available:{id:Hn.AVAILABLE,title:"Available Tags",tagIds:i}},columnOrder:["tags_in_view","tags_available"]},a}return Object(l.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){if(e.tagsInView!==this.props.tagsInView){this.props.saveDirtyFlag||this.props.dispatchSetSaveDirtyFlagAction();var a=new Set(this.props.tagsInView),r=Object.keys(this.props.allTagsData).filter((function(e){return!a.has(e)})),o=Object.assign({},this.state);o.columns.tags_in_view.tagIds=a,o.columns.tags_available.tagIds=r,this.setState(o)}}},{key:"componentDidMount",value:function(){this.props.dispatchSetTagEditorOpenedAction(!0)}}]),n}(o.a.Component),Kn=Object(s.c)((function(e){return{tagsInView:e.tagsInView,saveDirtyFlag:e.saveDirtyFlag}}),(function(e){return{setTagsInView:function(t){return e(me(t))},dispatchSetSaveDirtyFlagAction:function(){return e({type:"saveDirtyFlag/set"})},dispatchSetTagEditorOpenedAction:function(t){return e({type:"tagEditorOpened/set",tagEditorOpened:t})}}}))($n),Yn=n(625),Jn=n(637),Xn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).keydownHandler=function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode&&(e.preventDefault(),ht.doSaveViewSpec(a.props.tagsInView,a.props.currentOpenFileId.sourceId,a.props.currentOpenFileId.viewId,U.CARD_VIEW,!1).then((function(){a.props.dispatchSetToastAction({message:"Saved view",severity:ve,open:!0}),ye.dispatch({type:"saveDirtyFlag/clear"})})).catch((function(){return a.props.dispatchSetToastAction({message:"Failed to save view",severity:ge,open:!0})})))},a.constructDoc=function(e){return{type:"doc",content:[a.state.allTagsData[e].content]}},a.constructCard=function(e){var t={index:e};return t.front=a.constructDoc(a.props.tagsInView[e]),e+1<a.props.tagsInView.length?t.back=a.constructDoc(a.props.tagsInView[e+1]):t.back=null,o.a.createElement(Fn,{content:t})},a.componentDidMount=function(){document.addEventListener("keydown",a.keydownHandler),console.log("Cards Mounted")},a.componentDidUpdate=function(e){e.tagsInView!==a.props.tagsInView&&a.props.setTagsInView(a.props.tagsInView)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keydownHandler)},a.render=function(){if(a.state.allTagsData&&null!=a.props.tagsInView){var e=[];if(a.state.displaySwitch)for(var t=0;t<a.props.tagsInView.length;t+=2)e.push(a.constructCard(t));else for(var n=0;n<a.props.tagsInView.length;n+=4)e.push(o.a.createElement(In.a,{key:"row_".concat(n%4),className:"justify-content-md-center"},o.a.createElement(bn.a,{lg:"12",xl:"6"},a.constructCard(n)),o.a.createElement(bn.a,{lg:"12",xl:"6"},n+2<a.props.tagsInView.length&&a.constructCard(n+2))));return o.a.createElement(yn.a,{className:"viewContainer"},o.a.createElement(Yn.a,{control:o.a.createElement(Jn.a,{checked:a.state.displaySwitch,onChange:function(){a.setState({displaySwitch:!a.state.displaySwitch})},name:"checkedB",color:"primary",className:"displayModeSwitch"}),label:"Display Mode"}),a.state.displaySwitch?o.a.createElement(Cn,{cards:e}):o.a.createElement("div",null,o.a.createElement(Kn,{viewType:U.CARD_VIEW,allTagsData:a.state.allTagsData,tagsInView:a.props.tagsInView}),o.a.createElement("div",{className:"viewContent"},e)))}return o.a.createElement(yn.a,{className:"viewContainer"},o.a.createElement("h5",null,"Loading Card Deck ..."))},a.state={allTagsData:e.data.allTagsData,displaySwitch:!1},a.props.setTagsInView(e.data.tagsInView),a}return n}(o.a.Component),qn=Object(s.c)((function(e){return{tagsInView:e.tagsInView,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{setTagsInView:function(t){return e(me(t))},dispatchSetToastAction:function(t){return e(fe(t))}}}))(Xn),Qn=(n(556),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).keydownHandler=function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode&&(e.preventDefault(),ht.doSaveViewSpec(a.props.tagsInView,a.props.currentOpenFileId.sourceId,a.props.currentOpenFileId.viewId,U.TEXT_VIEW,!1).then((function(){a.props.dispatchSetToastAction({message:"Saved view",severity:ve,open:!0}),ye.dispatch({type:"saveDirtyFlag/clear"})})).catch((function(){return a.props.dispatchSetToastAction({message:"Failed to save view",severity:ge,open:!0})})))},a.constructTextView=function(){return{type:"doc",content:a.props.tagsInView.map((function(e){return a.state.allTagsData[e].content}))}},a.componentDidMount=function(){document.addEventListener("keydown",a.keydownHandler)},a.componentDidUpdate=function(e){e.tagsInView!==a.props.tagsInView&&a.props.setTagsInView(a.props.tagsInView)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keydownHandler)},a.render=function(){return a.state.allTagsData&&null!=a.props.tagsInView?o.a.createElement(yn.a,{className:"viewContainer"},o.a.createElement(Yn.a,{control:o.a.createElement(Jn.a,{checked:a.state.displaySwitch,onChange:function(){a.setState({displaySwitch:!a.state.displaySwitch})},name:"checkedB",color:"primary",className:"displayModeSwitch"}),label:"Display Mode"}),!a.state.displaySwitch&&o.a.createElement(Kn,{viewType:U.TEXT_VIEW,allTagsData:a.state.allTagsData,tagsInView:a.props.tagsInView}),a.props.tagsInView.length>0&&o.a.createElement(le.a,{className:"TextViewEditor viewContent",readOnly:!0,key:"text_view",defaultValue:JSON.stringify(a.constructTextView()),jsonStrValue:!0})):o.a.createElement(yn.a,{className:"viewContainer"},o.a.createElement("h5",null,"Loading Text View ..."))},a.state={allTagsData:e.data.allTagsData,displaySwitch:!1},a.props.setTagsInView(e.data.tagsInView),a}return n}(o.a.Component)),Zn=Object(s.c)((function(e){return{tagsInView:e.tagsInView,currentOpenFileId:e.currentOpenFileId}}),(function(e){return{setTagsInView:function(t){return e(me(t))},dispatchSetToastAction:function(t){return e(fe(t))}}}))(Qn),ea=n(107),ta=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sourceId:0,viewId:0,data:null,fileType:U.EMPTY,steps:[{title:"Welcome to Views!",intro:"Here you can make all kinds of views on top of your source document"},{title:"View Editor \u2328\ufe0f",element:".dragDrop",intro:"This is a drag and drop interface. Simply Drag a tag from the Available Tags to your Tags in View to include it!"},{title:"View Preview \ud83d\udc40",element:".viewContent",intro:"Here you can see the content of the view based on the tags you have selected above"},{title:"Display Mode \ud83d\udda5",element:".displayModeSwitch",intro:"Use this switch to toggle the Display Mode!"}],cardTourStart:e.props.newUser},e.changeFile=Object(f.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.dispatchSetFileLoading(),ht.doGetView(e.props.currentOpenFileId).then((function(t){e.props.dispatchClearFileLoading(),null===t?(e.props.dispatchSetToastAction({message:"Failed to retrieve view",severity:ge,open:!0}),Pt(B)):(e.props.setTagsInView([]),e.setState({sourceId:e.props.currentOpenFileId.sourceId,viewId:e.props.currentOpenFileId.viewId,data:{tagsInView:t.view.order,allTagsData:t.tags.items},fileType:e.props.currentOpenFileId.viewType}))}));case 2:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.changeFile().then((function(){return console.log("Mounted view file")}))},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||e.changeFile().then((function(){return console.log("Updated view file")})),t.newUser!==e.props.newUser&&e.setState({cardTourStart:e.props.newUser})},e.onStepsExit=function(){e.setState((function(){return{cardTourStart:!1}})),e.props.dispatchNewUserAction(!1)},e.render=function(){return o.a.createElement("div",null,o.a.createElement(ea.Steps,{enabled:e.state.cardTourStart&&e.props.tagEditorOpened,steps:e.state.steps,initialStep:0,onExit:e.onStepsExit,options:{disableInteraction:!0,exitOnOverlayClick:!1,exitOnEsc:!1}}),e.props.fileLoading?o.a.createElement(rt.a,{color:"primary",style:{position:"absolute",top:"40%",left:"45%",height:"100px",width:"100px"}}):e.state.fileType===U.CARD_VIEW?o.a.createElement(qn,{data:e.state.data}):e.state.fileType===U.TEXT_VIEW?o.a.createElement(Zn,{data:e.state.data}):null)},e}return n}(o.a.Component),na=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,newUser:e.newUser,tagEditorOpened:e.tagEditorOpened,fileLoading:e.fileLoading}}),(function(e){return{setTagsInView:function(t){return e(me(t))},dispatchSetToastAction:function(t){return e(fe(t))},dispatchNewUserAction:function(t){return e(D(t))},dispatchSetFileLoading:function(){return e({type:"file_loading/set"})},dispatchClearFileLoading:function(){return e({type:"file_loading/clear"})}}}))(ta),aa={fileType:U.EMPTY},ra=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state=aa,e.changeFile=function(){$(e.props.currentOpenFileId)?e.setState({fileType:U.SOURCE}):K(e.props.currentOpenFileId)?e.setState({fileType:U.CARD_VIEW}):e.setState({fileType:U.EMPTY})},e.componentDidMount=function(){e.changeFile()},e.componentDidUpdate=function(t){t.currentOpenFileId.sourceId===e.props.currentOpenFileId.sourceId&&t.currentOpenFileId.viewId===e.props.currentOpenFileId.viewId||e.changeFile()},e.render=function(){return o.a.createElement("div",{className:"MainContainer"},o.a.createElement("div",{className:"editor_container"},e.state.fileType===U.EMPTY?o.a.createElement("div",{className:"placeholder_editor"},o.a.createElement("h5",null,"Click or create a new document from the left pane")):e.state.fileType===U.SOURCE?o.a.createElement(It,null):o.a.createElement(na,null)))},e}return n}(o.a.Component),oa=Object(s.c)((function(e){return{currentOpenFileId:e.currentOpenFileId,currentOpenFileName:e.currentOpenFileName}}))(ra),ia=(n(561),n(90)),sa=n(624),ca=n(633),la=n(627),ua=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).render=function(){return o.a.createElement("div",{style:{display:"flex",flexFlow:"column",height:"100vh",overflow:"hidden"}},o.a.createElement("div",{style:{backgroundColor:"#F5F0E1",flex:"1 1 auto",display:"flex"}},o.a.createElement(N.a,{container:!0,alignItems:"center"},o.a.createElement(N.a,{container:!0,alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:1}),o.a.createElement(N.a,{item:!0,xs:10},o.a.createElement(x.a,{variant:"h1",align:"center",className:"title",style:{fontFamily:"Bungee",color:"#1E3D59"}},"YADA",o.a.createElement(C.a,{text:"",style:{fontFamily:"Signika"},speed:1e4})),o.a.createElement(x.a,{variant:"h4",align:"center",className:"title",style:{fontFamily:"Signika",color:"#1E3D59"}},"Yet Another Docs App")),o.a.createElement(N.a,{item:!0,xs:1})),o.a.createElement(N.a,{container:!0,alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:1}),o.a.createElement(N.a,{item:!0,xs:10},o.a.createElement(x.a,{variant:"h5",align:"center",style:{fontFamily:"Signika",color:"#1E3D59"}},"Oops! ",o.a.createElement("br",null),"Seems like we cannot display content for this screen width."," ",o.a.createElement("br",null),"YADA works best on desktops!")),o.a.createElement(N.a,{item:!0,xs:1})),o.a.createElement(N.a,{container:!0,alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:2}),o.a.createElement(N.a,{item:!0,xs:8,alignItems:"center"},o.a.createElement("img",{src:n(181),style:{width:"100%"},alt:"Document Graphic"})),o.a.createElement(N.a,{item:!0,xs:2})))))},e}return a}(o.a.Component),da=n(156),pa=Object(ia.a)({palette:{primary:{main:"#1E3D59"},secondary:{main:"#F5F0E1"}}}),ma=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={mounted:!1,width:window.innerWidth,initialTourSteps:[{title:"Welcome to Yada!",intro:"Hello \ud83d\udc4b"},{title:"Definitions \ud83d\udcda",intro:"Before we start here are some useful definitions <br><b>Document</b>: A source of truth document in our app <br><b>View</b>: Card View or Text View you can create from a document <br><b>Block</b>: A piece of content in the document seperated by a space which you can add a tag to"},{title:"Navigator",element:".SidePane",intro:'This is the navigator. Here you can create, update, rename and delete new views and documents. <br><b>Click on the "Welcome to Yada! " document to get started!</b>'}],documentTourSteps:[{title:"Editor \ud83d\udcdd",element:".editor",intro:"This is the main editor where you can use Markdown Syntax"},{title:"Views",element:".fileList-iconButton",intro:"Use this menu to create new views, rename and delete documents"},{title:"Tag Menu \ud83c\udff7",element:"#tag_menu_wrapper",intro:"This is the tag menu. After selecting a block from the editor you can add tags from here."},{title:"Search Menu \ud83d\udd0d",element:"#searchBar",intro:"In this search menu you can filter your document by tags. It can understand complex grammmar \ud83e\udde0. Try (#{tag1} | !#{tag2}) & #{tag3}"},{title:"Finally \u270c",intro:"Follow the steps in the welcome doc, to make your own blocks, tags, views and much more. You can refer to the Example documents to further see how to use Yada!"}],initialTourStart:e.props.newUser,documentStepsStart:!1},e.handleCloseToast=function(){e.props.dispatchSetToastAction("clear")},e.handleWindowSizeChange=function(){e.setState({width:window.innerWidth})},e.componentDidMount=function(){da.a.initialize("UA-166709979-1"),da.a.pageview(window.location.pathname+window.location.search),e.props.backendModeSignedInStatus!==I.LOCAL_STORAGE?b().then((function(t){e.props.dispatchSetBackendModeSignedInStatusAction(t),e.setState({mounted:!0})})):e.setState({mounted:!0})},e.componentDidUpdate=function(t){t.newUser!==e.props.newUser&&e.setState({initialTourStart:e.props.newUser})},e.onInitialStepsExit=function(){e.state.initialTourStart&&e.setState((function(){return{initialTourStart:!1,documentStepsStart:!0}}))},e.onDocumentStepsExit=function(){e.setState((function(){return{documentStepsStart:!1}}))},e.render=function(){return o.a.createElement(sa.a,{theme:pa},o.a.createElement(o.a.Fragment,null,e.state.width<=500?o.a.createElement(ua,null):e.state.mounted?e.props.backendModeSignedInStatus!==I.USER_SIGNED_OUT?o.a.createElement("div",{className:"App"},o.a.createElement(ea.Steps,{enabled:e.state.initialTourStart,steps:e.state.initialTourSteps,initialStep:0,onExit:e.onInitialStepsExit,options:{disableInteraction:!0,exitOnOverlayClick:!1,exitOnEsc:!1}}),o.a.createElement(ea.Steps,{enabled:e.state.documentStepsStart&&e.props.tagMenuOpened,steps:e.state.documentTourSteps,initialStep:0,onExit:e.onDocumentStepsExit,options:{disableInteraction:!0}}),o.a.createElement(wn,null),o.a.createElement("div",{style:{marginTop:64}},o.a.createElement(Jt,null),o.a.createElement(oa,null)),o.a.createElement(ca.a,{open:e.props.toast.open,autoHideDuration:5e3,onClose:e.handleCloseToast},o.a.createElement(la.a,{onClose:e.handleCloseToast,elevation:6,severity:e.props.toast.severity},e.props.toast.message))):o.a.createElement(M,null):null))},e}return Object(l.a)(n,[{key:"componentWillMount",value:function(){window.addEventListener("resize",this.handleWindowSizeChange)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowSizeChange)}}]),n}(o.a.Component),fa=Object(s.c)((function(e){return{backendModeSignedInStatus:e.backendModeSignedInStatus,currentOpenFileId:e.currentOpenFileId,currentOpenFileName:e.currentOpenFileName,toast:e.toast,tagMenuOpened:e.tagMenuOpened,stepsNavigator:e.stepsNavigator,newUser:e.newUser}}),(function(e){return{dispatchSetBackendModeSignedInStatusAction:function(t){return e(S(t))},dispatchSetToastAction:function(t){return e(fe(t))},dispatchNewUserAction:function(t){return e(D(t))}}}))(ma);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(i.render)(o.a.createElement(o.a.StrictMode,null,o.a.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"}),o.a.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}),o.a.createElement("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),o.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Bungee&display=swap",rel:"stylesheet"}),o.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Signika:wght@300&display=swap",rel:"stylesheet"}),o.a.createElement(s.a,{store:ye},o.a.createElement(fa,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[287,1,2]]]);